<?xml version='1.0' encoding='UTF-8' ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"    
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"  
      
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <body>

        <ui:composition template="./../../WEB-INF/facelets/templates/templateGrupos.xhtml">
	    <h:panelGroup  rendered="#{empty sesion.usuario}" styleClass="altura">
		<ui:include src="./../../login.xhtml"/>
	    </h:panelGroup>
            <ui:define name="contenido">
		<div id="Page">
		    <div class="row">
			<ui:include src="./menuRecursos.xhtml" rendered="#{not empty sesion.usuario}" />
		    </div>
		    <div class="row"> 
			<h:form rendered="#{not empty usuarioBean.usuarioVO}">
			    <div class="col-lg-12">
				<div class="col-lg-4"></div>
				<div class="col-lg-6">
				    <h2 class="page-header">#{msgs['sia.titulo.finaliza.baja']}</h2>
				</div>
			    </div> 
			    <center><h:messages errorClass="errorMessage" infoClass="infoMessage" styleClass="textoMensajeError"/></center>

			    <div class="col-lg-12 col-xs-12">
				<p:dataTable value="#{usuarioBean.traerUsuarioProcesoBaja}" var="dtFin" 
					       styleClass="table table-bordered table-striped">
				    <p:column>
					<f:facet name="header">Empleado</f:facet>
					<h:outputText value="#{dtFin.nombre}"/>
				    </p:column>
				    <p:column>
					<f:facet name="header">Inicio</f:facet>
					<h:outputText value="#{dtFin.fechaBaja}">
					    <f:convertDateTime pattern="dd/MM/yyyy"/>
					</h:outputText>
				    </p:column>
				    <p:column >
					<f:facet name="header"></f:facet>
					<p:commandLink value="Terminar baja" actionListener="#{usuarioBean.finalizarBaja(event)}" 
							  rendered="#{dtFin.terminarBaja eq true}" style="color: blue; text-decoration: underline;">
					    <f:param name="usSelec" value="#{dtFin.idUsuario}"/>
					</p:commandLink>
					<p:confirmDialog id="pnConf" 
							       message="La operación va terminar el proceso de baja del empleado #{dtFin.nombre}, ¿está seguro?"/>
				    </p:column>
				    <p:column>
                                        <c:forEach items="#{dtFin.gerenciaUsuario}" var="gu">
					    <h:panelGroup style="float: left; margin: 0px; padding: 0px;">
						<h:panelGrid style="text-align: center; height: 45px; margin-left: 0px; padding-left: 0px;" 
							     width="100px" cellpadding="0" cellspacing="0">
						    <h:outputText value="#{gu.gerencia}"/>
						    <h:outputLabel value="#{gu.liberado eq 'False' ? 'Con adeudo': 'Sin adeudo'}" 
								   style="font-weight: bold; #{gu.liberado eq 'False' ? 'color: red;' : 'color: blue;'}"/>
						</h:panelGrid>
					    </h:panelGroup>
					</c:forEach>
				    </p:column>

				</p:dataTable>
			    </div>
			</h:form>
		    </div>
		</div>
            </ui:define>
        </ui:composition>
    </body>
</html>
