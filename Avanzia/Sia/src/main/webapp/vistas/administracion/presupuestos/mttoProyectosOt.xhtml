<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"       
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      >
    <body>
        <ui:composition template="./../../../WEB-INF/facelets/templates/templateGrupos.xhtml">
            <h:panelGroup  rendered="#{empty sesion.usuario}" styleClass="altura">
                <ui:include src="./../../../login.xhtml"/>
            </h:panelGroup>
            <ui:define name="contenido">
                <div id="page">
                    <div class="row">
                        <ui:include src="../menuAdministracion.xhtml" rendered="#{not empty sesion.usuario}" />
                    </div>
                    <div class="row"> 
                        <div class="col-lg-12">
                            <div class="col-lg-4"></div>
                            <div class="col-lg-6">
                                <h2 class="page-header">Proyecto OTs</h2>
                            </div>
                        </div>
                        <div class="row"> 
                            <div class="col-lg-12">
                                <h:message  for="" style="display: block;" infoClass="alert alert-success" warnClass="alert alert-warning"
                                            errorClass="alert alert-danger" fatalClass="alert alert-danger"  />
                            </div>
                        </div>
                        <div class="row">
                            <div id="divAutoriza" class="btn-group" style="text-align: left;">
                                <h:form>
                                    <h:commandLink value="Nuevo" actionListener="#{proyectoOTsBean.nuevoProy(actionEvent)}"                                           
                                                   styleClass="btn btn-default"/>                                

                                </h:form>
                            </div>
                            <div id="divOperacion" class="btn-group" style="text-align: left; display: none;">

                            </div>
                        </div>

                        <div id="divTabla" class="row"> 
                            <h:form>                     
                                <div class="table table-responsive">
                                    <p:dataTable id="ProyDts" rows="15"
                                                   value="#{proyectoOTsBean.lstProyectos}" var="data"
                                                   paginator="true"  
                                                   paginatorPosition="bottom" 
                                                   style="font-size: 1em; width: 100%"  >                                
                                        <p:column headerText="Cuenta contable"  style="width: 20%"
                                                    filterBy="#{data['cuentaContable']}" filterMatchMode="contains">
                                            <h:outputText  value="#{data['cuentaContable']}"/>
                                        </p:column>
                                        <p:column headerText="Nombre"  style="width: 20%"
                                                    filterBy="#{data['nombre']}" filterMatchMode="contains">
                                            <h:outputText  value="#{data['nombre']}"/>
                                        </p:column>
                                        <p:column headerText="Subcampo"  style="width: 20%"
                                                    filterBy="#{data['subcampoNombre']}" filterMatchMode="contains">
                                            <h:outputText  value="#{data['subcampoNombre']}"/>
                                        </p:column>
                                        <p:column headerText="Yacimiento"  style="width: 20%"
                                                    filterBy="#{data['yacimientoNombre']}" filterMatchMode="contains">
                                            <h:outputText  value="#{data['yacimientoNombre']}"/>
                                        </p:column>
                                        <p:column style="width: 5%">
                                            <p:commandLink actionListener="#{proyectoOTsBean.editarProy(actionEvent)}"                                                      
                                                             title="Clic aquí para editar el proyecto OT..."                                                             
                                                             >
                                                <i class="glyphicon glyphicon-edit"></i>
                                                <f:param name="idProy" value="#{data['id']}"/>                                                
                                            </p:commandLink>                                            
                                        </p:column>
                                        <p:column style="width: 5%">                                            
                                            <p:commandLink actionListener="#{proyectoOTsBean.cerrarProy(actionEvent)}"                                                      
                                                             title="Clic aquí para cerrar el proyecto OT..."    
                                                             rendered="#{data['abierto']}"
                                                             onclick="return confirmar('La operación cerrara el proyecto ot y no podrá ser utilizado. ¿Está seguro?');"
                                                             >
                                                <i class="glyphicon glyphicon-eye-close"></i>
                                                <f:param name="idProy" value="#{data['id']}"/>                                                
                                            </p:commandLink>
                                        </p:column>
                                        <p:column style="width: 5%">                                            
                                            <p:commandLink actionListener="#{proyectoOTsBean.abrirProy(actionEvent)}"                                                      
                                                             title="Clic aquí para abrir el proyecto OT..."                                                             
                                                             rendered="#{!data['abierto']}"
                                                             onclick="return confirmar('La operación abrira el proyecto para poder ser utilizado. ¿Está seguro?');"
                                                             >
                                                <i class="glyphicon glyphicon-eye-open"></i>
                                                <f:param name="idProy" value="#{data['id']}"/>                                                
                                            </p:commandLink>
                                        </p:column>
                                        <p:column style="width: 5%">                                            
                                            <p:commandLink actionListener="#{proyectoOTsBean.borrarProy(actionEvent)}"                                                      
                                                             title="Clic aquí para eliminar el proyecto OT..."                                                             
                                                             onclick="return confirmar('La operación inactivara el proyecto y no podrá ser utilizado. ¿Está seguro?');"
                                                             >
                                                <i class="glyphicon glyphicon-trash"></i>
                                                <f:param name="idProy" value="#{data['id']}"/>                                                
                                            </p:commandLink>
                                        </p:column>                                                                                
                                    </p:dataTable>
                                </div>
                            </h:form>
                        </div>                    


                    </div>
                </div>
                <ui:include src="popUpProyectoOT.xhtml"/>
            </ui:define>

        </ui:composition>
    </body>
</html>
