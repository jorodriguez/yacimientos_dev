<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      >
    <body>
        <ui:composition template="./../templates/template.xhtml">
            <ui:define name="tituloPagina">
                Solicitar Proveedor
            </ui:define>
            <ui:define name="contenido">
                <h:form>
                    <div class="card panel-primary">
                        <div class="card-heading">
                            <h1 class="card-title">Datos generales proveedor / Prestador de Servicio / Contratista</h1>
                        </div>
                        <div class="card-body">
                            <div  class="card card-body">                                
                                <div class="col-lg-1"></div>
                                <div class="col-lg-2">
                                    <p:commandLink  action="#{solicitarProveedorBean.agregarProveedor(event)}"                                                               
                                                      styleClass="btn btn-info">
                                        <i class="glyphicon glyphicon-plus"><b> Agregar</b></i>
                                    </p:commandLink>   
                                </div>
                                <div class="col-lg-2">
                                    <h:outputText value="Legalización/Ejidatario:" rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}"/>
                                    <h:selectOneRadio value="#{solicitarProveedorBean.proveedorVo.tipoProveedor}"
                                                      style="margin-left: 20%;"                                                      
                                                      rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}">
                                        <f:selectItem itemLabel="Si" itemValue="1"/>
                                        <f:selectItem itemLabel="No" itemValue="0"/>
                                    </h:selectOneRadio>
                                </div>
                                <div class="col-lg-3">
                                    <h:outputText value="Término de pago:" rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}"/>
                                    <h:selectOneMenu value="#{solicitarProveedorBean.proveedorVo.idPago}" styleClass="form-control"
                                                     rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}">
                                        <f:selectItem itemLabel="Seleccione . . . " itemValue="0"/>
                                        <f:selectItems value="#{solicitarProveedorBean.listaTerminoPago}"/>
                                    </h:selectOneMenu>
                                </div>
                                <div class="col-lg-2">
                                    <h:outputText value="Carta Contenido Nacional:" rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}"/>
                                    <h:selectBooleanCheckbox value="#{solicitarProveedorBean.proveedorVo.carta}" styleClass="form-control"
                                                             rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}"/>
                                </div>    
                                <div class="col-lg-2">                                    
                                    <p:commandLink styleClass="btn btn-info"  rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}"
                                                     action="#{solicitarProveedorBean.procesarProveedor(event)}">
                                        <i class="glyphicon glyphicon-send"><b> Enviar</b></i>
                                    </p:commandLink>
                                </div>
                            </div>
                            <div class="col-lg-12 col-xs-12">
                                <div class="input-group col-lg-12 col-xs-12">
                                    <div class="row form-group ">                           
                                        <h:outputText class="col-lg-2 solicitarProveedorBeanol-label" value="Nombre: "/>
                                        <div class="col-lg-10">
                                            <h:outputLabel value="#{solicitarProveedorBean.proveedorVo.nombre}"/>
                                        </div>
                                    </div>                        
                                    <div class="row form-group">            
                                        <h:outputText class="col-lg-2 solicitarProveedorBeanol-label" value="Extranjera/Nacional: "/>
                                        <div class="col-lg-4">
                                            <h:outputLabel value="#{solicitarProveedorBean.proveedorVo.nacional}"/>
                                        </div>                                        			                            
                                    </div>
                                    <div class="row form-group">
                                        <h:outputText class="col-lg-1 solicitarProveedorBeanol-label" value="RFC: "/>
                                        <div class="col-lg-3">
                                            <h:outputLabel value="#{solicitarProveedorBean.proveedorVo.rfc}"/>
                                        </div>                  
                                    </div>
                                    <div class="row form-group">                  
                                        <h:outputText class="col-lg-1 solicitarProveedorBeanol-label" value="idCIF: "/>
                                        <div class="col-lg-3" >
                                            <h:outputLabel value="#{solicitarProveedorBean.proveedorVo.idCIF}"/>                                        
                                        </div>

                                    </div>
                                    <div class="row form-group">                           
                                        <h:outputText class="col-lg-1 solicitarProveedorBeanol-label" value="Giro: "/>
                                        <div class="col-lg-11">
                                            <h:outputLabel value="#{solicitarProveedorBean.proveedorVo.giro}"/>
                                        </div>
                                    </div>                        
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card panel-primary" id="datosContacto">
                        <div class="card-heading">                        
                            <h4 class="card-title">
                                <a data-toggle="collapse"  href="#collapseDatosContacto">
                                    Datos de Contacto
                                </a>
                            </h4>
                        </div>
                        <div id="collapseDatosContacto">
                            <div class="card-body">
                                <div class="col-lg-12 col-xs-12">
                                    <div class="input-group col-lg-12 col-xs-12">                                
                                        <div class="table table-responsive" style="margin-bottom: 0px;">
                                            <p:dataTable size="small" stripedRows="true" showGridlines="true" id="tblDatosContacto" rows="10" 
                                                           value="#{solicitarProveedorBean.proveedorVo.contactos}" 
                                                           var="data" styleClass="table table-striped"
                                                           style="font-size:12px; color: black;">                                                                                  
                                                <p:column headerText="Nombre">
                                                    <h:outputText value="#{data.nombre}"/>
                                                </p:column>
                                                <p:column headerText="Correo">
                                                    <h:outputText value="#{data.correo}"/>
                                                </p:column>
                                                <p:column headerText="Teléfono">
                                                    <h:outputText value="#{data.telefono}"/>
                                                </p:column>            
                                            </p:dataTable>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card panel-primary" id="pnlDocto">
                        <div class="card-heading">
                            <h4 class="card-title">
                                Documentación
                            </h4>
                        </div>
                        <div id="collapseDoctos">
                            <div class="card-body">
                                <ui:fragment rendered="#{solicitarProveedorBean.proveedorVo.status eq 910}">
                                    <div style="text-align: right;" class="col-lg-12">
                                        <p:commandLink  action="#{solicitarProveedorBean.nuevoDocumento(event)}"                                                               
                                                          styleClass="btn btn-primary">
                                            <f:param name="idProv" value="#{solicitarProveedorBean.proveedorVo.idProveedor}"/>                                
                                            <i class="glyphicon glyphicon-plus"/>
                                        </p:commandLink>   
                                    </div>
                                </ui:fragment>
                                <div class="table table-responsive">
                                    <p:dataTable size="small" stripedRows="true" showGridlines="true" id="dtDoctos" value="#{solicitarProveedorBean.proveedorVo.lstDocsProveedor}"
                                                   var="data" style="width: 100%; font-size: 1.0em;"
                                                   styleClass="table  table-striped"
                                                   paginator="true"  
                                                   paginatorPosition="bottom" 
                                                   rows="5">
                                        <p:column headerText="Documento">
                                            <h:outputText value="#{data.documento}" />
                                        </p:column>
                                        <p:column headerText="Recibida">
                                            <h:outputText value="#{data.fechaEntrega}">
                                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column>
                                            <h:outputLink target="_blank"  
                                                            value="/Compras/AbrirArchivo?ZWZ2W=#{data.adjuntoVO.id}&amp;ZWZ3W=#{data.adjuntoVO.uuid}"
                                                            rendered="#{data.adjuntoVO.id gt 0}">
                                                <span class="text-info" style="font-weight: bold;"> #{data.adjuntoVO.nombre}</span>
                                            </h:outputLink>
                                            <p:commandLink action="#{solicitarProveedorBean.quitarSoloArchivoDocumento()}"
                                                             rendered="#{data.adjuntoVO.id gt 0}">
                                                <i class="glyphicon glyphicon-remove text-danger btn btn-md"/>
                                                <f:setPropertyActionListener value="#{data}" target="#{solicitarProveedorBean.proveedorDocumentoVO}"/>
                                            </p:commandLink>
                                        </p:column>
                                        <p:column>
                                            <p:commandLink action="#{solicitarProveedorBean.agregarArchivoDocto()}"
                                                             rendered="#{data.adjuntoVO.id lt 1}">
                                                <i class="glyphicon glyphicon-edit text-success btn btn-md"/>
                                                <f:setPropertyActionListener value="#{data}" target="#{solicitarProveedorBean.proveedorDocumentoVO}"/>
                                            </p:commandLink>
                                        </p:column>
                                        <p:column >
                                            <p:commandLink action="#{solicitarProveedorBean.eliminarProveedorDocumento()}">
                                                <i class="glyphicon glyphicon-remove text-danger btn btn-md"/>
                                                <f:setPropertyActionListener value="#{data}" target="#{solicitarProveedorBean.proveedorDocumentoVO}"/>
                                            </p:commandLink>
                                        </p:column>                                
                                    </p:dataTable>
                                </div>
                            </div>
                        </div>
                    </div> 
                </h:form>
                <div class="modal fade" id="dialogoAgregarDoctoProv" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Agregar documentación</h4>
                            </div>
                            <h:form id="frmDoctosProv">
                                <div class="modal-body card-body">
                                    <div class="input-group">
                                        <div class="form-group col-lg-12">                           
                                            <p:dataTable size="small" stripedRows="true" showGridlines="true" value="#{solicitarProveedorBean.listaDocto}" var="data"
                                                           style="width: 100%;">
                                                <p:column>
                                                    <h:selectBooleanCheckbox value="#{data.selected}"/>
                                                </p:column>
                                                <p:column headerText="Docuemento" style="text-align: left;">
                                                    <h:outputText value="#{data.nombre}"/>
                                                </p:column>
                                            </p:dataTable>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <h:commandButton id="btnCerrar" value="Cancelar" class="btn btn-default"
                                                     onclick="$(dialogoAgregarDoctoProv).modal('hide');"/>
                                    <h:commandButton id="btnGuardar" value="Guardar" action="#{solicitarProveedorBean.agregarDocumentos(event)}" 
                                                     class="btn btn-info">
                                    </h:commandButton>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
                <!-- Modal Panel Popup agergar archivos -->
                <div class="modal fade" id="adjuntarArchivo" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Agregar documentos</h4>
                            </div>
                            <h:form id="frmArchivo">
                                <div class="modal-body card-body">
                                    <div class="input-group">
                                        <div class="form-group col-lg-12">
                                            <p:fileUpload  styleClass="form-control"
                                                            label="Archivo "
                                                            listener="#{solicitarProveedorBean.subirArchivo}"
                                                            immediate="false"/> 
                                        </div>
                                    </div>  
                                </div>
                                <div class="modal-footer">
                                    <h:commandButton id="btnCerrar" value="Cancelar" class="btn btn-default"
                                                     onclick="$(adjuntarArchivo).modal('hide');"/>
                                    <h:commandButton value="Guardar" 
                                                     styleClass="col-lg-3 col-xs-12 btn btn-info"
                                                     onclick="$(adjuntarArchivo).modal('hide');"/>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
            </ui:define>
        </ui:composition>
    </body>
</html>
