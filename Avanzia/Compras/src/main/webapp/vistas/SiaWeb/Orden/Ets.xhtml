<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <body>
        <ui:composition template="./../templates/template.xhtml">
            <ui:define name="tituloPagina">
                Especificación Técnica de Suministros
            </ui:define>
            <ui:define name="contenido"> 
                <h:form id="frmETSORDEN">
                    <div class="row">
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 5px;">   
                            <!-- p:commandLink value="Regresar" action="#{menuBarBean.regresarPagina()}"
                                             styleClass="link" onclick="regresar('divDatos', 'divOperacion', 'divAuto', 'divTabla');"/ -->
                            <p:commandLink value="Regresar"
                                             action="#{menuBarBean.regresarPagina()}"
                                             title="Click aqui para regresar..."
                                             styleClass="btn btn-default"
                                             />            
                        </div>
                        <!-- div class="col-lg-12 col-xs-12">                                                    
                            <p class="msgArchivo" style="color:  red; font-size: 12px; font-weight: bold;"/>
                        </div -->
                        <div class="col-lg-12 col-xs-12" style="font-size: 1em; margin-top: 10px;">
                            <h:selectOneRadio value="#{ordenCompraBean.opcionSeleccionada}" >
                                <f:selectItem itemLabel="Traer de requisición" itemValue="EtsRequisicion"/>
                                <f:selectItem itemLabel="Sistema de Archivo" itemValue="ETSLocal"/>    
                            </h:selectOneRadio>
                        </div>                   
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">  
                            <!--selectedPanel="{cargaEtsBean.opcionSeleccionada}"-->
                            <p:panel  style="width: 100%;">
                                <h:panelGroup id="EtsRequisicion">
                                    <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">                                                    
                                        <div class="table table-responsive">
                                            <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{cargaEtsBean.listaEts}" var="data"
                                                           styleClass="table table-striped">
                                                <f:facet name="header">
                                                    <h:outputLabel value="Requisición #{ordenBean.ordenActual.requisicion.consecutivo}"/>
                                                </f:facet>
                                                <p:column>
                                                    <h:selectBooleanCheckbox value="#{cargaEtsBean.filasSeleccionadas[data['id']]}"/>                                 
                                                </p:column>   
                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputLabel value="Nombre"/>
                                                    </f:facet>
                                                    <h:outputText value="#{data['siAdjunto'].nombreSinUUID}"/>
                                                </p:column>
                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputLabel value="Tamaño"/>
                                                    </f:facet>
                                                    <h:outputText  value="#{data['siAdjunto'].peso}"/>
                                                </p:column>
                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputLabel value="Descripción"/>
                                                    </f:facet>
                                                    <h:outputText value="#{data['siAdjunto'].descripcion}"/>
                                                </p:column>
                                                <p:column>
                                                    <h:outputLink   styleClass="link"
                                                                    target="_blank"  
                                                                    id="abrirReq"
                                                                    title="Click aqui para abrir el archivo..." 
                                                                    value="/Compras/AbrirArchivo?ZWZ2W=#{data['siAdjunto'].id}&amp;ZWZ3W=#{data['siAdjunto'].uuid}">
                                                        <h:outputText value=" Abrir"/>
                                                    </h:outputLink>
                                                </p:column>
                                            </p:dataTable> 
                                        </div>
                                    </div>
                                    <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">                                                    
                                        <h:outputText value="Destino del documento :"/>
                                        <h:selectOneMenu value="#{cargaEtsBean.idCategoriaSelccionada}">
                                            <f:selectItems value="#{cargaEtsBean.traerOcCategoriasItems}" />
                                        </h:selectOneMenu>                        
                                        <p:commandButton value="Adjuntar lo seleccionado" action="Ets"
                                                           action="#{cargaEtsBean.guardarSeleccionEts(event)}"                                                           
                                                           styleClass="btn btn-default"
                                                           />
                                        <p:commandButton 
                                            value="Adjuntar todo" 
                                            action="Ets" 
                                            action="#{cargaEtsBean.guardarTodoEts(event)}" 
                                            styleClass="btn btn-default"/>
                                    </div>
                                </h:panelGroup>
                                <h:panelGroup id="ETSLocal">
                                    <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">                                                    
                                        <h:outputText value="Destino :"/>
                                        <h:selectOneMenu value="#{cargaEtsBean.idCategoriaSelccionada}" >
                                            <f:selectItems value="#{cargaEtsBean.traerOcCategoriasItems}" />
                                        </h:selectOneMenu>                       
                                    </div>
                                    <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">   
                                        <h:outputText value="No se permiten los siguientes caracteres en el nombre del Archivo:" 
                                                        style=" font-size: 12px; font-weight: bold;" 
                                                        rendered="#{cargaEtsBean.idCategoriaSelccionada != -1}"/>
                                        <h:outputText value="&acute; ! ¡ &ldquo; &rdquo; # $ % &amp;  / \ = ¿ ? ' &lsquo; &rsquo;  &gt; &lt; { } [ ]" 
                                                        style="color: red; font-size: 12px; font-weight: bold; alignment-adjust: central;" 
                                                        rendered="#{cargaEtsBean.idCategoriaSelccionada != -1}"/>
                                    </div>
                                    <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">                                                                                            
                                        <h:outputText value="Clasificación:"/>
                                        <p:fileUpload id="fileEntryComp" 
                                                       styleClass="btn btn-default"
                                                       label="Archivo"
                                                       listener="#{cargaEtsBean.uploadFile}"/>
                                        <h:commandButton  styleClass="btn btn-default" id="uploadFile" value="Subir"/>
                                    </div>
                                </h:panelGroup>
                            </p:panel>
                        </div>
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">   
                            <div class="col-lg-12 col-xs-12">
                                <div class="table table-responsive">
                                    <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{cargaEtsBean.listaOcOrdenEts}" var="ets"
                                                   styleClass="table table-striped">
                                        <p:column >
                                            <f:facet name="header"><h:outputLabel value="Categoría"/></f:facet>
                                            <h:outputText value="#{ets.categoria}"/>
                                        </p:column>         
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Nombre"/>
                                            </f:facet>
                                            <h:outputText value="#{ets.nombreSinUUID}"/>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Tamaño"/>
                                            </f:facet>
                                            <h:outputText  value="#{ets.peso}"/>
                                        </p:column>
                                        <p:column>                                        
                                            <h:outputLink styleClass="link"
                                                          id="abrir"
                                                          target="_blank" 
                                                          title="Click aqui para abrir el archivo..." 
                                                          value="/Compras/AbrirArchivo?ZWZ2W=#{ets.id}&amp;ZWZ3W=#{ets.uuid}">
                                                <h:outputText value=" Abrir"/>
                                            </h:outputLink>                                        
                                        </p:column>
                                        <p:column>                                                                                    
                                            <p:commandLink id="eliminar" value="Eliminar"
                                                             styleClass="link"                                                     
                                                             action="#{cargaEtsBean.eliminarEtsOrden(actionEvent)}" 
                                                             title="Click aqui para eliminar el archivo..." 
                                                             onclick="if (!confirm('Está seguro de eliminar el archivo #{ets.nombreSinUUID} ...? '))
                                                                         return false;">
                                                <f:param name="idRelacionEliminar" value="#{ets['idEtsOrden']}" />
                                            </p:commandLink>                                        
                                        </p:column>
                                    </p:dataTable> 
                                </div>
                            </div>
                        </div>
                    </div>
                </h:form>
            </ui:define>
        </ui:composition> 
    </body>
</html>
