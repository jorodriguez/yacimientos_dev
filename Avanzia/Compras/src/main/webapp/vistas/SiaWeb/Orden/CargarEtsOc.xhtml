<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <body>
        <ui:composition template="./../templates/template.xhtml">
            <ui:define name="tituloPagina">
                Cargar ETS
            </ui:define>
            <ui:define name="contenido">
                <h:form>
                    <p:dialog style="z-index:1001;"
                                    visible="#{popupGeneralBean.modalRendered}"
                                    draggable="false" modal="true"
                                    styleClass="corePopup" >
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="Actualizar descripción"/>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody" style="font-size:12px">
                                <p:panel  >
                                    <h:outputLabel value="Nombre:"/>
                                    <h:outputText value="#{cargaEtsBean.etsActualAdjunto.nombre}"/>
                                    <h:outputLabel value="Tamaño:"/>
                                    <h:outputText value="#{cargaEtsBean.etsActualAdjunto.peso}"/>
                                    <h:outputLabel value="Descripción:"/>
                                    <h:inputTextarea cols="80"  value="#{cargaEtsBean.etsActualAdjunto.descripcion}"/>
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton value="Actualizar" action="#{cargaEtsBean.completarActualizacionEts(actionEvent)}"/>
                                        <p:commandButton value="Cancelar"
                                                           action="#{popupGeneralBean.toggleModal(event)}"
                                                           title="Cerrar ventana..."/>
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog>
                </h:form> <!-- Termina popup -->
                <h:form id="frmOrcETS">
                    <p:panel  style="border: 1px solid #b5b5b5; box-shadow: 0px 0px 5px rgba(0,0,0,0.10);border-radius: 6px;padding: 0px 10px 25px 0px; word-spacing: 2px;margin: 0px auto 0px auto;">
                        <p:commandLink value="Regresar a la orden" 
                                         action="#{menuBarBean.regresarPagina()}" styleClass="link"/>
                        <h:outputText style="color: #666666;" value="Por favor selccione un destino " />
                        <center>
                            <p:panel >
                                <h:outputText value="Destino :"/>
                                <h:selectOneMenu value="#{cargaEtsBean.idCategoriaSelccionada}" >
                                    <f:selectItems value="#{cargaEtsBean.traerOcCategoriasItems}" />
                                </h:selectOneMenu>                       
                            </p:panel>
                            <h:outputText  value="Busca un archivo en tu sistema, luego presiona el boton Subir para enviar los datos al servidor." rendered="#{cargaEtsBean.idCategoriaSelccionada != -1}"/>

                            <p:panel >
                                <p:panel  rendered="#{cargaEtsBean.idCategoriaSelccionada != -1}">
                                    <h:outputText value="Clasificación:"/>                                                                  
                                    <p:fileUpload id="fileEntryComp" 
                                                   label="Archivo"
                                                   listener="#{cargaEtsBean.uploadFile}"/>
                                    <p:commandButton id="uploadFile" value="Subir" styleClass="cancelar"/>
                                    <h:panelGroup>
                                        <p class="msgArchivo" style="color:  blue; font-size: 12px; font-weight: bold;"/>
                                    </h:panelGroup>
                                </p:panel>
                            </p:panel>
			    <h:outputLabel style="font-size:14px; font-weight: bold;" value="Archivos Cargados"/>
                            <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{cargaEtsBean.listaOcOrdenEts}" var="ets">
				<p:column>
				    <f:facet name="header">
					<h:outputLabel value="Nombre"/>
				    </f:facet>
				    <h:outputText value="#{ets['siAdjunto'].nombreSinUUID}"/>
				</p:column>
				<p:column>
				    <f:facet name="header">
					<h:outputLabel value="Tamaño"/>
				    </f:facet>
				    <h:outputText  value="#{ets['siAdjunto'].peso}"/>
				</p:column>
				<p:column>
				    <f:facet name="header">
					<h:outputLabel value="Descripción"/>
				    </f:facet>
				    <h:outputText value="#{ets['siAdjunto'].descripcion}"/>
				</p:column>
				<p:column>
				    <p:panel style="margin: 0px auto 0px auto;">
					<p:commandLink id="actualizar" 
							 title="Modificar descripción"
							 action="#{cargaEtsBean.actualizarEtsDesdeEtsCategoria(actionEvent)}">
					    <p:graphicImage style="border-width:0px;" url="./resources/Imagenes/editar.gif"/>
					    <f:param name="idRelacionActualizar" value="#{ets['id']}" />
					</p:commandLink>
				    </p:panel>
				</p:column>
				<p:column>
				    <p:panel style="margin: 0px auto 0px auto;">
					<h:outputLink target="_blank"  value="/Compras/AbrirArchivo?ZWZ2W=#{ets['siAdjunto'].id}&amp;ZWZ3W=#{ets['siAdjunto'].uuid}" styleClass="link" > 
					    <h:outputText value=" Abrir"/>
					</h:outputLink>
				    </p:panel>
				</p:column>
				<p:column>
					<p:commandLink id="eliminarOC" value="eliminar" styleClass="link"
							 action="#{cargaEtsBean.eliminarEtsOrden(actionEvent)}"
							 onclick="if (!confirm('Está seguro de eliminar el archivo...? '))
									 return false;">
					    <f:param name="idRelacionEliminar" value="#{ets['idEtsOrden']}" />
					</p:commandLink>
				</p:column>
			    </p:dataTable>
                        </center>
                    </p:panel>
                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>
