<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <body>
        
        <ui:composition template="./../templates/template.xhtml">
             <ui:define name="tituloPagina">
                #{menuBarBean.paginaActual}
            </ui:define>
            <ui:define name="contenido">
                <!-- Forma para los paneles emergentes -->
                <h:form id="formPopup">
                    <!-- Modal Panel Popup Cancelar -->
                    <p:dialog id="modalPnlPop"
                                    visible="#{popupBean.modalRenderedCancelar}"
                                    
                                    draggable="false" modal="true" styleClass="corePopup">
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="Cancelar Requisición"/>
                                    <p:panel  >
                                        <p:commandButton id="modalPnlCloseBtn"
                                                           type="button"
                                                           action="#{popupBean.toggleModalCancelar(event)}"
                                                           alt="Close"
                                                           
                                                           title="Cerrar ventana"
                                                           styleClass="popupHeaderImage"/>
                                    </p:panel>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody">
                                <p:panel  >
                                    <h:outputText value="Requisición:"/>
                                    <h:inputText disabled="true" value="#{popupBean.requisicion.consecutivo}"/>
                                    <h:outputText value="Solicito:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.solicita.nombre}"/>
                                    <h:outputText value="Compañia:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.compania.nombre}"/>
                                    <h:outputText value="Gerencia:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.gerencia.nombre}"/>
                                    <h:outputText value="ProyectoOT:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.proyectoOt.nombre}"/>
                                    <h:outputText value="Tipo de Obra:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.tipoObra.nombre}"/>
                                </p:panel>
                                <p:panel>
                                    <h:outputText value="Introduzca el motivo por el cual se cancela la requisición:"/>
                                    <h:inputTextarea id="motivoCancelo" cols="100" rows="3" value="#{popupBean.requisicion.motivoCancelo}"/>
                                    <h:message for="motivoCancelo" errorClass="errorMessage" fatalClass="fatalMessage" infoClass="infoMessage"
                                                 style="color: rgb(204, 0, 0);width: 214px" warnClass="warnMessage"/>
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton id="buttonAceptar"
                                                           value="Aceptar"
                                                           action="#{requisicionBean.cancelarRequisicion(actionEvent)}"
                                                           onclick="if (!confirm('Está seguro de cancelar la requisición...? ')) return false;"/>
                                        <p:commandButton id="buttonCancelar"
                                                           value="Cancelar"
                                                           action="#{popupBean.toggleModalCancelar(event)}"
                                                           title="Cerrar ventana sin cancelar la requisición..." />
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog>
                    <!-- Termina Popup Cancelar-->
                    <!-- Modal Panel Popup Rechazo -->
                    <p:dialog  visible="#{popupBean.modalRenderedDevolver}"
                                     
                                     draggable="false" modal="true" styleClass="corePopup">
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="Devolver Requisición"/>
                                    <p:panel  >
                                        <p:commandButton type="button"
                                                           action="#{popupBean.toggleModalDevolver(event)}"
                                                           alt="Close"
                                                           
                                                           title="Cerrar ventana"
                                                           styleClass="popupHeaderImage"/>
                                    </p:panel>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody">
                                <p:panel  >
                                    <h:outputText value="Requisición:"/>
                                    <h:inputText disabled="true" value="#{popupBean.requisicion.consecutivo}"/>
                                    <h:outputText value="Solicito:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.solicita.nombre}"/>
                                    <h:outputText value="Compañia:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.compania.nombre}"/>
                                    <h:outputText value="Gerencia:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.gerencia.nombre}"/>
                                    <h:outputText value="ProyectoOT:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.proyectoOt.nombre}"/>
                                    <h:outputText value="Tipo de Obra:"/>
                                    <h:inputText disabled="true" size="70" value="#{popupBean.requisicion.tipoObra.nombre}"/>
                                </p:panel>
                                <p:panel>
                                    <h:outputText value="Introduzca el motivo por el cual devolverá la requisición:"/>
                                    <h:inputTextarea id="motivoRechazo" cols="100" rows="3" value="#{popupBean.rechazo.motivo}" validator="#{popupBean.validarMotivoRechazo}"/>
                                    <h:message id="msjRechazo" for="motivoRechazo" errorClass="errorMessage" fatalClass="fatalMessage" infoClass="infoMessage"
                                                 style="color: rgb(204, 0, 0);width: 214px" warnClass="warnMessage"/>
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton value="Aceptar"
                                                           action="#{requisicionBean.rechazarRequisicion(actionEvent)}"
                                                           onclick="if (!confirm('Está seguro de devolver la requisición...? ')) return false;"/>
                                        <p:commandButton value="Cancelar"
                                                           action="#{popupBean.toggleModalDevolver(event)}"
                                                           title="Cerrar ventana..." />
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog> <!-- Termina Popup Rechazo-->

                    <!-- Inicia Popup Modificar Ítem para autorización -->
                    <p:dialog id="modalPnlPop2"
                                    visible="#{popupBean.modalRenderedModificar}"
                                    
                                    draggable="false" modal="true"
                                    styleClass="corePopup" >
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="#{requisicionBean.operacionItem} Ítem"/>
                                    <p:panel  >
                                        <p:commandButton id="modalPnlCloseBtn2"
                                                           action="#{popupBean.toggleModalModificar(event)}"
                                                           title="Cerrar ventana" type="button" alt="Close"
                                                           
                                                           styleClass="popupHeaderImage"/>
                                    </p:panel>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody">
                                <p:panel  >
                                    <h:outputText value="Núm. de parte:"/>
                                    <h:inputText disabled="true" size="50" value="#{popupBean.item.numeroParte}"/>
                                    <h:outputText value="Unidad:"/>
                                    <h:inputText disabled="true" size="50" value="#{popupBean.item.unidad}"/>
                                    <h:outputText value="Descripcion:"/>
                                    <h:inputTextarea cols="70" disabled="true" rows="3" value="#{popupBean.item.descripcionSolicitante}"/>
                                    <h:outputText value="Precio Unitario:"/>
                                    <h:inputText disabled="true"  value="#{popupBean.item.precioUnitario}"/>
                                    <h:outputText value="Moneda:"/>
                                    <h:inputText disabled="true"  value="#{popupBean.item.moneda.nombre}"/>
                                    <h:outputText value="Cantidad Solicitada:"/>
                                    <h:inputText disabled="true"  value="#{popupBean.item.cantidadSolicitada}"/>
                                    <h:outputText value="Cantidad Autorizada:"/>
                                    <h:inputText  value="#{popupBean.item.cantidadAutorizada}"/>
                                    <h:outputText value="Observaciones:"/>
                                    <h:inputTextarea cols="70" rows="3" value="#{popupBean.item.observaciones}"/>
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton id="buttonAceptar2" 
                                                           value="#{requisicionBean.operacionItem}"
                                                           action="#{requisicionBean.completarActualizacionItem(actionEvent)}"/>
                                        <p:commandButton id="buttonCancelar2" 
                                                           value="Cancelar"
                                                           action="#{popupBean.toggleModalModificar(event)}"
                                                           title="Cerrar ventana sin modificar el Ítem..."/>
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog>
                    <!-- Termina popup modificar Ítem Autorizaciones -->
                </h:form>
                <h:form>
                    <!-- Modal Panel Popup Crear Nota -->
                    <p:dialog  draggable="false" modal="true" style="z-index:1001; width: 500px;"
                                    styleClass="corePopup"
                                    visible="#{popupCrearNotaBean.modalRendered}">
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="#{notaRequisicionBean.operacion} Nota"/>
                                    <p:panel  >
                                        <p:commandButton action="#{popupCrearNotaBean.toggleModal(event)}" alt="Close"
                                                            styleClass="popupHeaderImage" title="Cerrar ventana" type="button"/>
                                    </p:panel>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody" >
                                <p:panel >
                                    <h:outputText value="Requisición:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.requisicion.consecutivo}"/>
                                    <h:outputText value=""/>
                                    <h:outputText value="Solicito:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.requisicion.solicita.nombre}"/>
                                    <h:outputText value=""/>
                                    <h:outputText value="Compañia:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.requisicion.compania.nombre}"/>
                                    <h:outputText value=""/>
                                    <h:outputText value="Gerencia:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.requisicion.gerencia.nombre}"/>
                                    <h:outputText value=""/>
                                    <h:outputText value="ProyectoOT:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.requisicion.proyectoOt.nombre}"/>
                                    <h:outputText value=""/>
                                    <h:outputText value="Tipo de Obra:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.requisicion.tipoObra.nombre}"/>
                                    <h:outputText value=""/>
                                    <h:outputText style="color: rgb(0, 0, 51); font-family: Arial,Helvetica,sans-serif; font-size: 18px; font-weight: bold" value="Titulo Nota:"/>
                                    <h:inputText id="titulo" required="true" size="70" value="#{notaRequisicionBean.notaActual.titulo}"/>
                                    <h:message errorClass="errorMessage" fatalClass="fatalMessage" for="titulo" id="msjTitulo" infoClass="infoMessage"
                                                 style="color: rgb(204, 0, 0);width: 214px" warnClass="warnMessage"/>
                                    <h:outputText style="color: rgb(0, 0, 51); font-family: Arial,Helvetica,sans-serif; font-size: 18px; font-weight: bold" value="Nota:"/>
                                    <h:inputTextarea cols="70" id="nota" required="true" rows="5" value="#{notaRequisicionBean.notaActual.mensaje}"/>
                                    <h:message errorClass="errorMessage" fatalClass="fatalMessage" for="nota" id="msjNota" infoClass="infoMessage"
                                                 style="color: rgb(204, 0, 0);width: 214px" warnClass="warnMessage"/>
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton action="#{notaRequisicionBean.completarCreacionNota(actionEvent)}" value="Aceptar"/>
                                        <p:commandButton action="#{popupCrearNotaBean.toggleModal(event)}" title="Cerrar ventana..." value="Cancelar"/>
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog>
                </h:form>
                <!-- Termina Popup Nota-->
                <h:form>
                    <!-- Modal Panel Popup Crear Respuesta -->
                    <p:dialog  draggable="false" modal="true"
                                    styleClass="corePopup"
                                    visible="#{popupRespuestaNotaBean.modalRendered}">
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="Crear Respuesta"/>
                                    <p:panel  >
                                        <p:commandButton action="#{popupRespuestaNotaBean.toggleModal(event)}" alt="Close"
                                                            styleClass="popupHeaderImage" title="Cerrar ventana" type="button"/>
                                    </p:panel>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody" >
                                <p:panel >
                                    <h:outputText value="Titulo:"/>
                                    <h:inputText disabled="true" size="70" value="#{notaRequisicionBean.notaActual.titulo}"/>
                                    <h:outputText value=""/>
                                    <h:outputText value="Nota:"/>
                                    <h:inputTextarea disabled="true" cols="58" rows="5" value="#{notaRequisicionBean.notaActual.mensaje}"/>
                                    <h:outputText value=""/>
                                    <h:outputText style="color: rgb(0, 0, 51); font-family: Arial,Helvetica,sans-serif; font-size: 18px; font-weight: bold" value="Titulo Respuesta:"/>
                                    <h:inputText id="tituloResp" required="true" size="70" value="#{notaRequisicionBean.respuestaActual.titulo}"/>
                                    <h:message errorClass="errorMessage" fatalClass="fatalMessage" for="tituloResp" id="msjTituloResp" infoClass="infoMessage"
                                                 style="color: rgb(204, 0, 0);width: 214px" warnClass="warnMessage"/>
                                    <h:outputText style="color: rgb(0, 0, 51); font-family: Arial,Helvetica,sans-serif; font-size: 18px; font-weight: bold" value="Respuesta:"/>
                                    <h:inputTextarea cols="70" id="respuesta" required="true" rows="5" value="#{notaRequisicionBean.respuestaActual.mensaje}"/>
                                    <h:message errorClass="errorMessage" fatalClass="fatalMessage" for="respuesta" id="msjRespuesta" infoClass="infoMessage"
                                                 style="color: rgb(204, 0, 0);width: 214px" warnClass="warnMessage"/>
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton action="#{notaRequisicionBean.completarCreacionRespuesta(actionEvent)}" value="Aceptar"/>
                                        <p:commandButton action="#{popupRespuestaNotaBean.toggleModal(event)}" title="Cerrar ventana..." value="Cancelar"/>
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog>
                    <!-- Termina Popup Crear respuesta-->
                </h:form>
                <h:form id="form1">
                    <h:panelGroup id="panelGroup1" style=" position: relative;">
                        <!--   Ponga todo su codigo aqui... -->
                        <p:panel id="panelPrincipal" >
                            <p:panel id="panelTablaPrincipal" >
                                <h:outputText id="outputText0" value="Selecione una requisición de la lista para ver y modificar sus Items por favor..."/>
                                <p:dataTable size="small" stripedRows="true" showGridlines="true"  id="dataTable1" value="#{requisicionBean.requisicionesSinVistoBueno}" var="currentRow" >
                                    <p:column rendered="false">
                                        <h:outputText value="#{currentRow['id']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Id"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText style="width: 80px" value="#{currentRow['consecutivo']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Código"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['fechaSolicito']}">
                                            <f:convertDateTime dateStyle="default"
                                                               type="date"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Solicitada"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['fechaRequerida']}">
                                            <f:convertDateTime dateStyle="default"
                                                               type="date"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Requerida"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['prioridad'].nombre}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Prioridad"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText style="width: 280px" value="#{currentRow['compania'].nombre}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Compañia"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['montoMn']}">
                                            <f:convertNumber currencySymbol="$"
                                                             groupingUsed="true"
                                                             maxFractionDigits="2"
                                                             type="currency"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Monto Pesos"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['montoUsd']}">
                                            <f:convertNumber currencySymbol="$"
                                                             groupingUsed="true"
                                                             maxFractionDigits="2"
                                                             type="currency"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Monto Dolares"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['montototalUsd']}">
                                            <f:convertNumber currencySymbol="$"
                                                             groupingUsed="true"
                                                             maxFractionDigits="2"
                                                             type="currency"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Monto Total Dolares"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <!-- si pongo un boton no toma los 2 parametros -->
                                        <p:commandLink id="commandLinkVistoBuenoRequisicion"
                                                       value="Dar Visto Bueno"
                                                       action="#{requisicionBean.vistoBuenoRequisicion(currentRow.id)}"
                                                       onclick="if (!confirm('Está a punto de dar el visto bueno a una requisición, por lo tanto el sistema almacenara sus datos para soportar su aprobación y aclaraciones posteriores.')) return false;"
                                                       title="Click aqui para dar visto bueno a la requisición..." >
                                            <!-- este parametro es para tomar la requisición solo asi lo puedo ver cuando uso botones -->
                                        </p:commandLink>
                                    </p:column>
                                    <p:column>
                                        <!-- si pongo un boton no toma los 2 parametros -->
                                        <p:commandLink value="Devolver" action="#{requisicionBean.seleccionarMalRequisicion(currentRow.id)}"
                                                       title="Click aqui para devolver la requisición...">
                                            <!-- este parametro es para saber a que pagina ir -->
                                            <f:param name="myParam" value="popupDevolverRequisicion"/>
                                            <!-- este parametro es para tomar la requisición solo asi lo puedo ver cuando uso botones -->
                                        </p:commandLink>
                                    </p:column> 
                                    <p:column>
                                        <!-- si pongo un boton no toma los 2 parametros -->
                                        <p:commandLink id="commandLinkCancelarRequisicion"
                                                       value="Cancelar"    
                                                       action="#{requisicionBean.seleccionarMalRequisicion(currentRow.id)}"
                                                       title="Click aqui para cancelar la requisición..." >
                                            <!-- este parametro es para saber a que pagina ir -->
                                            <f:param name="myParam" value="popupCancelarRequisicion"/>
                                            <!-- este parametro es para tomar la requisición solo asi lo puedo ver cuando uso botones -->
                                        </p:commandLink>
                                    </p:column>
                                    <p:column>
                                        <p:commandLink action="#{requisicionBean.crearNota(currentRow.id)}"
                                                       title="Clic aqui para generar una Nota sobre la requisición..." value="Generar Nota">
                                            <f:facet name="ParametroAdicional">
                                            </f:facet>
                                        </p:commandLink>
                                    </p:column>

                                    <p:column>
                                        <p:commandLink id="buttonSeleccionar"
                                                       value="Seleccionar"
                                                       action="#{requisicionBean.seleccionarMalRequisicion(currentRow.id)}"
                                                       title="Click aqui para ver y modificar los items de la requisición...">
                                        </p:commandLink>
                                    </p:column>
                                </p:dataTable>
                                <!-- aqui va el panel oculto de mas informacion de la requisición -->
                                <p:accordionPanel id="panelCollapsible1" >
                                    <f:facet name="header">
                                        <h:panelGroup>
                                            <h:outputText value="Mas información de la requisición: #{requisicionBean.requisicionActual.consecutivo}"/>
                                        </h:panelGroup>
                                    </f:facet>
                                    <!-- cuerpo del panel oculto -->
                                    <p:panel >
                                        <!-- PanelTapset que contiene las pestañas de mas informacion y Estatus -->
                                        <p:tabView activeIndex="0" style="font-size:12px">
                                            <!-- Tap mas información -->
                                            <p:tab title="Mas información">
                                                <!-- Panel layout que contiene todo lo del tap mas información -->
                                                    <p:panel>
                                                        <p:panel >
                                                            <h:outputText value="Gerencia:"/>
                                                            <h:inputText disabled="true" size="70" value="#{requisicionBean.requisicionActual.gerencia.nombre}"/>
                                                            <h:outputText value="ProyectoOT:"/>
                                                            <h:inputText disabled="true" size="70" value="#{requisicionBean.requisicionActual.proyectoOt.nombre}"/>
                                                            <h:outputText value="Tipo de Obra:"/>
                                                            <h:inputText disabled="true" size="70" value="#{requisicionBean.requisicionActual.tipoObra.nombre}"/>
                                                            <h:outputText value="Lugar de entrega:"/>
                                                            <h:inputText disabled="true" size="70" value="#{requisicionBean.requisicionActual.lugarEntrega}"/>
                                                            <h:outputText value="Proveedor:"/>
                                                            <h:inputText disabled="true" size="70" value="#{requisicionBean.requisicionActual.proveedor}"/>
                                                            <h:outputText value="Observaciones:"/>
                                                            <h:inputTextarea cols="100" readonly="true" rows="3" value="#{requisicionBean.requisicionActual.observaciones}"/>
                                                        </p:panel>
                                                    </p:panel>
                                            </p:tab>
                                            <!-- aqui va tap ETS -->
                                            <p:tab title="Especificación Técnica de Suministro.">
                                                <!-- Panel layout que contiene todo lo del tap tap -->
                                                    <p:panel >
                                                        <h:outputLabel style="font-size:14px; font-weight: bold;" value="Especificación Técnica de Suministro"/>
                                                        <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{cargaEtsBean.etsPorRequisicion}" var="ets">
                                                            <p:column>
                                                                <f:facet name="header">
                                                                    <h:outputLabel value="Nombre"/>
                                                                </f:facet>
                                                                <h:outputText value="#{ets['nombre']}"/>
                                                            </p:column>
                                                            <p:column>
                                                                <f:facet name="header">
                                                                    <h:outputLabel value="Tamaño"/>
                                                                </f:facet>
                                                                <h:outputText  value="#{ets['peso']}"/>
                                                            </p:column>
                                                            <p:column>
                                                                <f:facet name="header">
                                                                    <h:outputLabel value="Tipo de contenido"/>
                                                                </f:facet>
                                                                <h:outputText value="#{ets['tipoArchivo']}"/>
                                                            </p:column>
                                                            <p:column>
                                                                <f:facet name="header">
                                                                    <h:outputLabel value="Fecha"/>
                                                                </f:facet>
                                                                <h:outputText value="#{ets['fechaGenero']}">
                                                                    <f:convertDateTime dateStyle="default" type="date"/>
                                                                </h:outputText>
                                                            </p:column>
                                                            <p:column>
                                                                <f:facet name="header">
                                                                    <h:outputLabel value="Descripción"/>
                                                                </f:facet>
                                                                <h:inputTextarea cols="50" readonly="true" value="#{ets['descripcion']}"/>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputLink target="_blank"  value="/Compras/AbrirArchivo?ZWZ2W=#{ets['id']}&amp;ZWZ3W=#{ets['uuid']}">
                                                                    <h:outputText value=" Abrir"/>
                                                                </h:outputLink>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </p:panel>
                                            </p:tab> <!-- termina Tap ETS -->
                                            <!-- aqui va tap estatus -->
                                            <p:tab title="Estatus">
                                                <!-- Panel layout que contiene todo lo del tap tap -->
                                                    <p:panel>
                                                        <p:panel >
                                                            <h:outputText value="Requisición:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.consecutivo}"/>
                                                            <h:outputText value="Estatus Actual:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.estatus.nombre}"/>
                                                        </p:panel>
                                                        <p:panel >
                                                            <!-- aqui va la informacion del resto del estatus de la requisición -->
                                                            <h:outputText value="Solicitada el:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.fechaSolicito}">
                                                                <f:convertDateTime dateStyle="default" type="date"/>
                                                            </h:inputText>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.horaSolicito}">
                                                                <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                            </h:inputText>
                                                            <h:outputText value="Por:"/>
                                                            <h:inputText disabled="true" size="50" value="#{requisicionBean.requisicionActual.solicita.nombre}"/>
                                                            <h:outputText value="Revisada el:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.fechaReviso}">
                                                                <f:convertDateTime dateStyle="default" type="date"/>
                                                            </h:inputText>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.horaReviso}">
                                                                <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                            </h:inputText>
                                                            <h:outputText value="Por:"/>
                                                            <h:inputText disabled="true" size="50" value="#{requisicionBean.requisicionActual.revisa.nombre}"/>
                                                            <h:outputText value="Aprobada el:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.fechaAprobo}">
                                                                <f:convertDateTime dateStyle="default" type="date"/>
                                                            </h:inputText>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.horaAprobo}">
                                                                <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                            </h:inputText>
                                                            <h:outputText value="Por:"/>
                                                            <h:inputText disabled="true" size="50" value="#{requisicionBean.requisicionActual.aprueba.nombre}"/>
                                                            <h:outputText value="Autorizada el:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.fechaAutorizo}">
                                                                <f:convertDateTime dateStyle="default" type="date"/>
                                                            </h:inputText>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.horaAutorizo}">
                                                                <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                            </h:inputText>
                                                            <h:outputText value="Por:"/>
                                                            <h:inputText disabled="true" size="50" value="#{requisicionBean.requisicionActual.autoriza.nombre}"/>
                                                            <h:outputText value="Visto Bueno el:"/>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.fechaVistoBueno}">
                                                                <f:convertDateTime dateStyle="default" type="date"/>
                                                            </h:inputText>
                                                            <h:inputText disabled="true" value="#{requisicionBean.requisicionActual.horaVistoBueno}">
                                                                <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                            </h:inputText>
                                                            <h:outputText value="Por:"/>
                                                            <h:inputText disabled="true" size="50" value="#{requisicionBean.requisicionActual.vistoBueno.nombre}"/>
                                                        </p:panel>
                                                    </p:panel>
                                            </p:tab> <!-- termina Tap del Estatus -->
                                            <!-- aqui va tap Notas -->
                                            <p:tab  title="Muestra las notas de la requisición seleccionada.">
                                                    <p:panel >
                                                        <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{requisicionBean.notasPorRequisicion}" var="currentRow" >
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['id']}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Núm."/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['fecha']}">
                                                                    <f:convertDateTime dateStyle="default" type="date"/>
                                                                </h:outputText>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Fecha"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['hora']}">
                                                                    <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                                </h:outputText>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Hora"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['autor'].nombre}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Autor"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['titulo']}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Titulo"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:inputTextarea cols="80"  readonly="true" rows="2" value="#{currentRow['mensaje']}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Nota"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['respuestas']}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Respuestas"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['ultRespuesta']}">
                                                                    <f:convertDateTime dateStyle="default" type="date"/>
                                                                </h:outputText>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Ult. Respuesta"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <p:commandLink value="Responder" action="#{notaRequisicionBean.crearRespuesta(actionEvent)}" title="Clic aqui para Crear una Respuesta..."/>
                                                            </p:column>
                                                            <p:column>
                                                                <p:commandLink value="Seleccionar" action="#{notaRequisicionBean.seleccionarNota(actionEvent)}" title="Clic aqui para ver Respuestas..."/>
                                                            </p:column>
                                                        </p:dataTable>
                                                        <h:outputText value="Respuestas de la Nota: #{notaRequisicionBean.notaActual.id}" style="color: red; font-weight: bold"/>
                                                        <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{notaRequisicionBean.respuestas}" var="currentRow" >
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['fecha']}">
                                                                    <f:convertDateTime dateStyle="default" type="date"/>
                                                                </h:outputText>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Fecha"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['hora']}">
                                                                    <f:convertDateTime pattern="hh:mm" timeStyle="default" type="time"/>
                                                                </h:outputText>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Hora"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['autor'].nombre}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Autor"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:outputText value="#{currentRow['titulo']}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Titulo"/>
                                                                </f:facet>
                                                            </p:column>
                                                            <p:column>
                                                                <h:inputTextarea cols="120"  readonly="true" rows="2" value="#{currentRow['mensaje']}"/>
                                                                <f:facet name="header">
                                                                    <h:outputText value="Respuesta"/>
                                                                </f:facet>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </p:panel>
                                            </p:tab>  <!-- termina Tap Notas -->
                                        </p:tabView>
                                    </p:panel>
                                </p:accordionPanel>
                                <!-- fin panel oculto mas informacion -->
                            </p:panel>
                            <!-- fin Panel Tabla principal -->
                            <!-- Panel tabla detalle -->
                            <p:panel id="panelTablaDetalle" style="height: 47px" >
                                <h:outputText value="Items de la requisición: #{requisicionBean.requisicionActual.consecutivo}"/>
                                <p:dataTable size="small" stripedRows="true" showGridlines="true"  id="dataTable2" value="#{requisicionBean.items}" var="currentRow" >
                                    <p:column rendered="false">
                                        <h:outputText value="#{currentRow['id']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="id"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['numeroParte']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Número parte"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText style="width: 30px" value="#{currentRow['cantidadSolicitada']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Cantidad Solicitada"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['cantidadAutorizada']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Cantidad Autorizada"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['unidad']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Unidad"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:inputTextarea cols="65" readonly="true" rows="3" value="#{currentRow['descripcionSolicitante']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Descripción"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['precioUnitario']}">
                                            <f:convertNumber currencySymbol="$" 
                                                             groupingUsed="true" 
                                                             maxFractionDigits="2" 
                                                             type="currency"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Precio Unitario"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['importe']}">
                                            <f:convertNumber currencySymbol="$"
                                                             groupingUsed="true"
                                                             maxFractionDigits="2"
                                                             type="currency"/>
                                        </h:outputText>
                                        <f:facet name="header">
                                            <h:outputText value="Importe"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['moneda'].nombre}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Moneda"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <h:outputText value="#{currentRow['autorizado']}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Autorizado"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column>
                                        <p:commandLink id="buttonModificarItem"
                                                       value="Modificar"
                                                       action="#{requisicionBean.seleccionarItem(currentRow.id)}"
                                                       title="Click aqui para modificar el item..." >
                                            <f:param name="myParam" value="popupModificarItem"/>
                                        </p:commandLink>
                                    </p:column>
                                    <p:column>
                                        <p:commandLink id="buttonCancelarItem"
                                                       value="Cancelar"
                                                       action="#{requisicionBean.cancelarItem(currentRow.id)}" 
                                                       title="Click aqui para cancelar el item...">
                                            <f:facet name="ParametroAdicional">
                                                <f:param name="commandButtonParam" value="#{currentRow['id']}"/>
                                            </f:facet>
                                        </p:commandLink>
                                    </p:column>
                                    <p:column>
                                        <p:commandLink id="buttonAutorizarItem"
                                                       value="Autorizar"
                                                       action="#{requisicionBean.autorizarItem(currentRow.id)}"
                                                       title="Click aqui para autorizar el item...">
                                            <f:facet name="ParametroAdicional">
                                            </f:facet>
                                        </p:commandLink>
                                    </p:column>
                                </p:dataTable>
                            </p:panel>
                            <!-- Termina Panel tabla detalle -->
                        </p:panel>
                        <!-- Termina panel Principal -->
                    </h:panelGroup>
                </h:form>
            </ui:define>

        </ui:composition>

    </body>
</html>
