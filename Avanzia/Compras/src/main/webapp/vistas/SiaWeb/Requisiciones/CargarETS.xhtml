<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <body>

        <ui:composition template="./../templates/template.xhtml">
            <ui:define name="tituloPagina">
                Carga ETS
            </ui:define>
            <ui:define name="content">
                <h:form> <!-- Inicia popup  -->
                    <p:dialog style="z-index:1001;"
                                    visible="#{popupGeneralBean.modalRendered}"
                                    
                                    draggable="false" modal="true"
                                    styleClass="corePopup" >
                        <f:facet name="header">
                            <h:panelGroup styleClass="popupHeaderWrapper">
                                <p:panel  >
                                    <h:outputText styleClass="popupHeaderText" value="Actualizar descripción"/>
                                </p:panel>
                            </h:panelGroup>
                        </f:facet>
                        <f:facet name="body">
                            <h:panelGroup styleClass="popupBody" style="font-size:12px">
                                <p:panel  >
                                    <h:outputLabel value="Nombre:"/>
                                    <h:outputText value="#{cargaEtsBean.etsActualAdjunto.nombreSinUUID}"/> 
                                    <h:outputLabel value="Tamaño:"/>
                                    <h:outputText value="#{cargaEtsBean.etsActualAdjunto.peso}"/>
                                    <h:outputLabel value="Descripción:"/>
                                    <h:inputTextarea cols="80"  value="#{cargaEtsBean.etsActualAdjunto.descripcion}"/> 
                                </p:panel>
                                <center>
                                    <p:panel >
                                        <p:commandButton value="Actualizar" action="#{cargaEtsBean.completarActualizacionEts(actionEvent)}"/>
                                        <p:commandButton value="Cancelar"
                                                           action="#{popupGeneralBean.toggleModal(event)}"
                                                           title="Cerrar ventana..."/>
                                    </p:panel>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </p:dialog>
                </h:form> <!-- Termina popup -->
                <h:form id="frmSubirArchivo">
                    <div class="row">
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 5px;">   
                            <!-- p:commandLink value="Regresar a la requisición #{requisicionBean.requisicionActual.id}"
                                                 action="#{menuBarBean.regresarPagina()}" styleClass="link"
                                                 / -->                        
                            <p:commandLink value="Regresar a la requisición #{requisicionBean.requisicionActual.id}"                                             
                                           action="#{menuBarBean.regresarPagina()}"                                               
                                           title="Click aqui para regresar a la requisición..."                                               
                                           styleClass="btn btn-default"
                                           />            
                        </div>
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">                                                    
                            <h:outputText styleClass="col-lg-12 col-xs-12 control-label" value="Busca un archivo en tu computadora, luego presiona el boton Subir para enviar los datos al servidor."/>
                            <h:outputText styleClass="col-lg-6 col-xs-12 control-label" value="No se permiten los siguientes caracteres en el nombre del Archivo:" style=" font-size: 12px; font-weight: bold;" />
                            <h:outputText styleClass="col-lg-6 col-xs-12 control-label" value="&acute; ! ¡ &ldquo; &rdquo; # $ % &amp;  / \ = ¿ ? ' &lsquo; &rsquo;  &gt; &lt; { } [ ]" style="color: red; font-size: 12px; font-weight: bold; text-align: left;" />
                        </div>
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; margin-top: 10px;">                                                    
                            <p:fileUpload id="fileEntryComp" 
                                           label="Archivo "
                                           listener="#{cargaEtsBean.uploadFile}"
                                           styleClass="col-lg-11 col-xs-12 btn btn-default"/>
                            <h:commandButton id="uploadFile" 
                                             value="Subir" 
                                             styleClass="col-lg-1 col-xs-12 btn btn-default"
                                             onclick="#{cargaEtsBean.setRequi(true)}"/>
                        </div>
                        <div class="col-lg-12 col-xs-12" style="font-size:12px; padding-top: 1%;">                                                                                
                            <h:outputLabel styleClass="col-lg-12 col-xs-12 control-label" style=" text-align: center; font-size:14px; font-weight: bold;" value="Archivos Cargados"/>
                            <div class="col-lg-12 col-xs-12">
                                <div class="table table-responsive">
                                    <!--   Ponga todo su codigo aqui... -->                                    
                                    <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{cargaEtsBean.etsPorRequisicion}" var="ets"  styleClass="table table-striped">
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Nombre"/>
                                            </f:facet>
                                            <h:outputText value="#{ets['siAdjunto'].nombreSinUUID}"/>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Tamaño"/>
                                            </f:facet>
                                            <h:outputText  value="#{ets['siAdjunto'].peso}"/>
                                        </p:column>
                                        <!-- p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Tipo de contenido"/>
                                            </f:facet>
                                            <h:outputText value="#{ets['siAdjunto'].tipoArchivo}"/>
                                        </p:column -->
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Fecha"/>
                                            </f:facet>
                                            <h:outputText value="#{ets['siAdjunto'].fechaGenero}">
                                                <f:convertDateTime dateStyle="default" type="date"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputLabel value="Descripción"/>
                                            </f:facet>
                                            <h:outputText value="#{ets['siAdjunto'].descripcion}"/>
                                        </p:column>
                                        <p:column>
                                            <p:commandLink 
                                                               value="Modificar descripción"
                                                               title="Modificar descripción"
                                                               action="#{cargaEtsBean.actualizarEts(actionEvent)}"
                                                                styleClass="link"/>
                                        </p:column>
                                        <p:column>
                                            <h:outputLink target="_blank"  value="/Compras/AbrirArchivo?ZWZ2W=#{ets['siAdjunto'].id}&amp;ZWZ3W=#{ets['siAdjunto'].uuid}"
                                                           styleClass="link">
                                                <h:outputText value=" Abrir"/>
                                            </h:outputLink>
                                        </p:column>
                                        <p:column>
                                            <p:commandLink value="Eliminar" styleClass="link"
                                                             action="#{cargaEtsBean.eliminarEts(actionEvent)}"
                                                             onclick="if (!confirm('Está seguro de eliminar el archivo...? '))
                                                                         return false;">
                                            </p:commandLink>
                                        </p:column>
                                    </p:dataTable>
                                </div>
                            </div>
                        </div>
                    </div>
                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>

                                