<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"       
      xmlns:f="http://xmlns.jcp.org/jsf/core"

      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <body>
        <ui:composition template="./../../../WEB-INF/facelets/templates/templateGrupos.xhtml">
            <h:panelGroup  rendered="#{empty sesion.usuario}" styleClass="altura">
                <ui:include src="./../../../login.xhtml"/>
            </h:panelGroup>
            <ui:define name="contenido">
                <ui:include src="../menuAdministracion.xhtml" rendered="#{not empty sesion.usuario}" />
                <h:form id="frmCategoria">
                    <!--h:commandLink value="CAtegorias" actionListener="{categoriaBean.imprimirArticulosCategoria(e)}" class="btn btn-circle"/-->
                    <div class="row">
                        <div class="col-lg-8">
                            <h2 class="text-primary">Administración de categorías y artículos</h2>
                        </div>
                        <div class="col-lg-12" style="margin-bottom: 5px;">
                            <div class="col-lg-8" style="text-align: right;"></div>
                            <strong><h:outputText class="col-lg-1 control-label" value="Bloque:" /></strong>
                            <div class="col-lg-3">
                                <h:selectOneMenu id="bloqueSel1" value="#{categoriaBean.idBloque}" styleClass="form-control">
                                    <f:selectItems value="#{categoriaBean.listaCampo}" var="ccBloque" itemValue="#{ccBloque.idCampo}" itemLabel="#{ccBloque.campo}"/>                                    
                                    <f:ajax event="change" render="@all" listener="#{categoriaBean.seleccionarCategoriaCabecera}"/>  
                                </h:selectOneMenu>
                            </div>
                        </div>
                        <div class="col-lg-12 col-xs-12">
                            <div class="panel panel-heading">
                                <div class="form-group">
                                    <div class="col-lg-10">
                                        <ui:repeat value="#{categoriaBean.categoriasSeleccionadas}" var="data"
                                                   varStatus="indice">
                                            <p:commandLink  style="padding-left: 2%;"
                                                            actionListener="#{categoriaBean.seleccionarCategoriaCabecera(event)}"
                                                            styleClass="text text-primary">
                                                <i class="#{data.nombre eq 'Pricipales' ? 'fa fa-circle' : 'fa fa-arrow-right' }" ></i>
                                                #{data.nombre} 
                                                <f:param name="indiceCatSel" value="#{indice.index}"/>
                                            </p:commandLink>
                                        </ui:repeat>
                                    </div>
                                    <div class="col-lg-2">
                                        <h:commandLink styleClass="btn btn-success"						       
                                                       rendered="#{categoriaBean.mostrarArticulos}"
                                                       title="Agregar artículo"                                                       
                                                       actionListener="#{categoriaBean.abrirPopUpArticulo(event)}">
                                            <i class="fa fa-plus-square-o"></i>
                                        </h:commandLink>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 col-xs-12">	
                            <ui:fragment rendered="#{categoriaBean.listaArticulos.size() lt 1}">
                                <div class="col-lg-8 col-xs-8">
                                    <div class="panel panel-info">
                                        <div class="panel panel-heading">
                                            <div class="input-group col-lg-12">
                                                <div class="col-lg-10">
                                                    #{categoriaBean.categoriasSeleccionadas.size()  eq 1 ? 'Pricipales' : categoriaBean.categoriaVo.nombre}
                                                </div>
                                                <div class="col-lg-2">
                                                    <p:commandLink styleClass="btn btn-primary" 
                                                                   rendered="#{categoriaBean.categoriasSeleccionadas.size()  gt 1}"
                                                                   actionListener="#{categoriaBean.agregarCategoria(event)}"
                                                                   title="Enlazar categorías">
                                                        <i class="fa fa-link"></i>
                                                    </p:commandLink>
                                                    <p:commandLink styleClass="btn btn-primary" 
                                                                   rendered="#{categoriaBean.categoriasSeleccionadas.size()  eq 1}"
                                                                   onclick="$(registrarCategoria).modal('show');"
                                                                   title="Registrar categoría">
                                                        <i class="fa fa-plus-circle"></i>
                                                    </p:commandLink>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-body">
                                            <!--!--rowSelectListener="#{categoriaBean.seleccionarCategoria}"-->
                                            <p:dataTable value="#{categoriaBean.listaCatPrin}" var="data"
                                                         rowStyleClass="table table-bordered table-striped"
                                                         rows="10" paginator="true"  
                                                         paginatorPosition="bottom" 
                                                         style="text-align: left;"
                                                         selectionMode="single"
                                                         
                                                         rowIndexVar="indice">
                                                <p:column headerText="Nombre" style="text-align: left;">
                                                    <h:outputText value="#{data.nombre}"/>
                                                </p:column>
                                                <p:column headerText="Código">
                                                    <h:outputText value="#{data.codigo}"/>
                                                </p:column>
                                                <p:column rendered="#{categoriaBean.categoriasSeleccionadas.size() gt 1}">
                                                    <h:commandLink
                                                        actionListener="#{categoriaBean.eliminarCategoria(event)}"
                                                        onclick="return  confirmar('La operación va a eliminar la caregoría, ¿está seguro?');">
                                                        <i class="fa fa-trash text-danger"></i>
                                                        <f:param name="idCategoria" value="#{indice}"/>
                                                    </h:commandLink>
                                                </p:column>
                                            </p:dataTable>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group col-lg-12" style="margin-top: 10px; margin-bottom: 10px;" >
                                    <strong><h:outputText style="padding-top: 3px;" class="col-lg-1 control-label" value="Filtro:" /></strong>
                                    <div class="col-lg-9">                                            
                                        <!--textChangeListener="#{categoriaBean.traerArticulosItemsListener}"-->
                                        <p:autoComplete id="idBusquedaAvArticulos"                                                                 
                                                           value="#{categoriaBean.articuloTx}" 
                                                           styleClass="campoFiltro"                                                                                         
                                                           style="margin: 0px 0 0 0px; width: 100%; height: 25px; background-color: #d9edf7; border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset;">                                                                                                                                                                        
                                        </p:autoComplete> 
                                    </div>
                                    <div class="col-lg-2">                                                                                    
                                        <strong><h:outputText
                                                value="#{categoriaBean.articulosResultadoBqda.size()} Artículos"/>
                                        </strong>

                                    </div>
                                </div>  
                                <div class="form-group col-lg-12">
                                    <div class="col-lg-12" id="tablaResBusquedaAv">
                                        <!--rowSelectListener="#{categoriaBean.seleccionarResultadoBA}"-->
                                        <p:dataTable value="#{categoriaBean.articulosResultadoBqda}" var="dataRBA"
                                                     id="tablaResBusquedaAvTABLE"                                                                                   
                                                     rowStyleClass="table table-bordered table-striped"
                                                     rows="20" paginator="true"  
                                                     paginatorPosition="bottom" 
                                                     selectionMode="single"
                                                     >
                                            <p:column headerText="Código" style="width: 15%;" styleClass="resultadoBdaCodigo">
                                                <h:outputText value="#{dataRBA.value.numParte}"/>
                                            </p:column>
                                            <p:column headerText="Nombre" style="text-align: left; width: 85%" styleClass="resultadoBdaNombre">
                                                <h:outputText value="#{dataRBA.value.nombre}"/>
                                            </p:column> 
                                            <p:ajax event="page"  process="@this" oncomplete="marcarBusqueda();"></p:ajax>
                                        </p:dataTable>
                                    </div>                 
                                </div>
                            </ui:fragment>
                            <div class="col-lg-12">
                                <ui:fragment rendered="#{categoriaBean.adminCategoria}">
                                    <div class="col-lg-12 col-lg-12">
                                        <div class="panel panel-info">
                                            <div class="panel panel-heading">
                                                <div class="form-group" >
                                                    <div align="left" class="col-lg-8">
                                                        <h:outputText class="panel-title" value="Agregar categorías ( #{categoriaBean.categoriaVo.nombre} )"/>
                                                    </div>
                                                    <div align="right" class="col-lg-4">
                                                        <p:commandLink actionListener="#{categoriaBean.cancelarGuardarCategoria(event)}"
                                                                       styleClass="btn btn-default">
                                                            <i class="fa fa-remove text-danger"></i>
                                                        </p:commandLink>
                                                        <p:commandLink actionListener="#{categoriaBean.terminarGuardarCategoria(event)}"
                                                                       styleClass="btn btn-primary"
                                                                       style="margin-left: 20px;">
                                                            <i class="fa fa-floppy-o"></i>
                                                        </p:commandLink>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="panel panel-body">
                                                <div class="col-lg-6 col-xs-6">
                                                    <!--rowSelectListener="#{categoriaBean.seleccionarCategoriaAgregar}"-->
                                                    <p:dataTable value="#{categoriaBean.listaCategoría}" var="data"
                                                                 rowStyleClass="table table-bordered table-striped"
                                                                 rows="10" paginator="true"  
                                                                 paginatorPosition="bottom" 
                                                                 selectionMode="single"
                                                                 >
                                                        <p:column headerText="Nombre" filterBy="#{data.nombre}" filterMatchMode="contains">
                                                            <h:outputText value="#{data.nombre}"/>
                                                        </p:column>
                                                        <p:column headerText="Código" filterBy="#{data.codigo}" filterMatchMode="contains">
                                                            <h:outputText value="#{data.codigo}"/>
                                                        </p:column>
                                                    </p:dataTable>
                                                </div>
                                                <div class="col-lg-6 col-xs-6">					
                                                    <p:dataTable value="#{categoriaBean.listaCategoriaTemporal}" var="data"
                                                                 rowStyleClass="table table-bordered table-striped"
                                                                 rows="10" paginator="true" 
                                                                 paginatorPosition="bottom" 
                                                                 rowIndexVar="indice">
                                                        <f:facet name="header" >Categorías a guardar</f:facet>
                                                        <p:column headerText="Nombre">
                                                            <h:outputText value="#{data.nombre}"/>
                                                        </p:column>
                                                        <p:column headerText="Código">
                                                            <h:outputText value="#{data.codigo}"/>
                                                        </p:column>
                                                        <p:column>
                                                            <p:commandLink
                                                                actionListener="#{categoriaBean.eliminarCategoriaTemporal(event)}">
                                                                <i class="fa fa-trash text-danger"></i>
                                                                <f:param name="idCatTablaTemp" value="#{indice}"/>
                                                            </p:commandLink>
                                                        </p:column>
                                                    </p:dataTable>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ui:fragment>
                            </div>

                            <div class="col-lg-12">
                                <ui:fragment rendered="#{categoriaBean.mostrarArticulos and categoriaBean.listaArticulos.size() gt 0}">
                                    <div class="col-lg-12 col-lg-12">
                                        <div class="panel panel-info">
                                            <div class="panel panel-heading">
                                                <div class="form-group" >
                                                    <div align="left" class="col-lg-12">
                                                        <h:outputText class="panel-title" value="Articulos en la categoría ( #{categoriaBean.categoriaVo.nombre} )"/>
                                                    </div>					    
                                                </div>
                                            </div>
                                            <div class="panel panel-body">
                                                <div class="col-lg-12">
                                                    <h:commandLink onclick="validaCambiarArticulo('seleccion');"
                                                                   actionListener="#{categoriaBean.seleccinarArticulos(event)}"
                                                                   title="Cambiar artículos de categoría"
                                                                   class="btn btn-primary" rendered="#{categoriaBean.listaArticulos.size() gt 0}">
                                                        <i class="fa fa-exchange text-default"></i>
                                                    </h:commandLink>
                                                </div>
                                                <!--rowSelectListener="#{categoriaBean.seleccionarArticulo}"-->
                                                <p:dataTable value="#{categoriaBean.listaArticulos}" var="data"
                                                             rowStyleClass="table table-bordered table-striped"
                                                             rows="15" paginator="true"  
                                                             paginatorPosition="bottom" 
                                                             rowIndexVar="indice" selectionMode="single" 
                                                             >
                                                    <p:column>
                                                        <h:selectBooleanCheckbox value="#{data.selected}" class="seleccion"/>
                                                    </p:column>
                                                    <p:column style="text-align: left;" headerText="No Parte" >
                                                        <h:outputText value="#{data.numParte}"/>
                                                    </p:column>
                                                    <p:column style="text-align: left;" headerText="Articulo"> 
                                                        <h:outputText value="#{data.nombre}" rendered="#{data.editar eq false}"/>
                                                        <h:inputTextarea value="#{data.nombre}"
                                                                         rendered="#{data.editar}"/>
                                                    </p:column>
                                                    <p:column style="text-align: left;" headerText="Unidad"> 
                                                        #{data.unidadNombre}
                                                    </p:column>
                                                    <p:column> 
                                                        <p:commandLink actionListener="#{categoriaBean.inicioEditarArticulo(event)}"
                                                                       rendered="#{data.editar eq false}">	
                                                            <i class="fa fa-edit "></i>
                                                            <f:param name="articulo" value="#{indice}"/>
                                                        </p:commandLink>
                                                        <p:commandLink actionListener="#{categoriaBean.editarArticulo(event)}"
                                                                       rendered="#{data.editar eq true}">
                                                            <i class="fa fa-save text-primary"></i>
                                                            <f:param name="indexTbl" value="#{indice}"/>
                                                            <!--f:param name="articuloNombre" value="#{data.nombre}"/-->
                                                        </p:commandLink>
                                                    </p:column>
                                                    <p:column>
                                                        <p:commandLink actionListener="#{categoriaBean.eliminarArticulo(event)}">
                                                            <i class="fa fa-trash text-danger"></i>
                                                            <f:param name="eliArt" value="#{indice}"/>
                                                        </p:commandLink>
                                                    </p:column>
                                                </p:dataTable>
                                                <h:outputLabel value="No hay articulos registrados en la combinación de categorías seleccionada."
                                                               rendered="#{categoriaBean.listaArticulos.size() eq 0}"/>
                                            </div>
                                        </div>
                                    </div>
                                </ui:fragment>
                            </div>
                        </div>
                    </div>
                </h:form>
                <!-- Muestra los artículos de la categoría -->
                <div class="modal fade" id="dialogoCambiarArticulos" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog" style="width: 70%;">
                        <div class="modal-content">
                            <h:form id="frmCambiarArticulo">
                                <div class="modal-header">
                                    <h4 class="modal-title">Categoría donde se moverán los artículos</h4>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="panel panel-info">
                                                <div class="panel-heading">
                                                    Artículos seleccionados
                                                </div>
                                                <div class="panel-body">
                                                    Categoría actual
                                                    <div class="col-lg-12">
                                                        <ui:repeat value="#{categoriaBean.categoriasSeleccionadas}" 
                                                                   var="data">
                                                            <i class="#{data.nombre eq 'Pricipales' ? 'fa fa-circle' : 'fa fa-arrow-right' }" ></i>
                                                            #{data.nombre}
                                                        </ui:repeat>
                                                    </div>
                                                    <p:dataTable value="#{categoriaBean.listaCambiarArticulos}" var="data"
                                                                 rowStyleClass="table table-bordered table-striped"
                                                                 rows="5" paginator="true"  
                                                                 paginatorPosition="bottom" 
                                                                 rowIndexVar="indice">
                                                        <p:column style="text-align: left;">
                                                            #{data.nombre}
                                                        </p:column>
                                                        <p:column>
                                                            #{data.unidadNombre}
                                                        </p:column>
                                                    </p:dataTable>			
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="panel panel-info">
                                                <div class="panel-heading">
                                                    <ui:repeat value="#{categoriaBean.listaCambiarSeleccionada}" var="data"
                                                               varStatus="indice">
                                                        <p:commandLink  style="padding-left: 2%;"
                                                                        styleClass="text text-primary"
                                                                        actionListener="#{categoriaBean.seleccionarCambiarCategoriaCabecera(event)}">
                                                            <i class="#{data.nombre eq 'Pricipales' ? 'fa fa-circle' : 'fa fa-arrow-right' }" ></i>
                                                            #{data.nombre} 
                                                            <f:param name="indiceCatCamSel" value="#{indice.index}"/>
                                                            <f:param name="idCatCamSel" value="#{data.id}"/>
                                                        </p:commandLink>
                                                    </ui:repeat>
                                                </div>
                                                <div class="panel-body">
                                                    <!--rowSelectListener="#{categoriaBean.seleccionarCategoriaCambio}"-->
                                                    <p:dataTable value="#{categoriaBean.listaCategoriaCambiar}" var="data"
                                                                 rowStyleClass="table table-bordered table-striped"
                                                                 rows="5" paginator="true"  
                                                                 paginatorPosition="bottom" 
                                                                 rowIndexVar="indice" selectionMode="single"
                                                                 >
                                                        <p:column style="text-align: left;">
                                                            #{data.nombre}
                                                        </p:column>
                                                    </p:dataTable>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <p:commandLink value="Cerrar" styleClass="btn btn-default" 
                                                   actionListener="#{categoriaBean.cerrarVerArticulos(event)}"
                                                   onclick="$(dialogoCambiarArticulos).modal('hide');"/>
                                    <p:commandLink value="Guardar" styleClass="btn btn-primary" 
                                                   actionListener="#{categoriaBean.cambiarArticulo(event)}"/>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
                <!-- Registro de categoría -->
                <div class="modal fade" id="registrarCategoria" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Categoría</h4>
                            </div>
                            <h:form id="frmAgregarCategoria">
                                <div class="modal-body panel panel-body">				    
                                    <div class="input-group col-lg-12" >
                                        <div class="form-group col-lg-12">
                                            <div class="col-lg-2">
                                                <h:outputLabel value="Categoría: " styleClass="control-label"/>
                                            </div>					    
                                            <div class="col-lg-8">
                                                <p:inputText id="txtCategoria" value="#{categoriaBean.nombreCategoria}" styleClass="form-control"/>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-12">
                                            <div class="col-lg-2">
                                                <h:outputLabel value="Código:" styleClass="control-label"/>
                                            </div>
                                            <div class="col-lg-8">
                                                <p:inputText id="txtCodCat" value="#{categoriaBean.codigoCategoria}" styleClass="form-control"
                                                             maxlength="3"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <p:commandLink value="Cerrar" styleClass="btn btn-default" 
                                                   actionListener="#{categoriaBean.cerrarRegistrarCategori(event)}"
                                                   onclick="$(registrarCategoria).modal('hide');"/>
                                    <h:commandLink value="Guardar" styleClass="btn btn-primary" 
                                                   actionListener="#{categoriaBean.registrarCategoria(event)}"						     
                                                   onclick="return validaGuardarCategoria('frmAgregarCategoria\\:txtCategoria', 'frmAgregarCategoria\\:txtCodCat');"/>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
                <!-- Registro de categoría -->
                <div class="modal fade" id="registrarArticulo" data-backdrop="static" data-keyboard="false">                
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Registrar artículo</h4>
                            </div>
                            <h:form id="frmAgregarArticulo">
                                <div class="modal-body panel panel-body">
                                    <div class="col-lg-12">
                                        <ui:repeat value="#{categoriaBean.categoriasSeleccionadas}" var="data"
                                                   varStatus="indice">
                                            <h:outputLabel  styleClass="text text-primary" style="margin-left: 1%;">
                                                <i class="#{data.nombre eq 'Pricipales' ? 'fa fa-circle' : 'fa fa-arrow-right' }" ></i>
                                                #{data.nombre} 
                                            </h:outputLabel>
                                        </ui:repeat>
                                    </div>
                                    <div class="input-group col-lg-12">
                                        <div class="form-group col-lg-12">
                                            <div class="col-lg-2">
                                                Artículo:
                                            </div>
                                            <div class="col-lg-8">
                                                <h:inputTextarea id="txtArticulo" value="#{categoriaBean.articulo}" styleClass="form-control"/>                                                
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-12">
                                            <div class="col-lg-2">
                                                No. Parte:
                                            </div>
                                            <div class="col-lg-8">
                                                <p:inputText id="txtNoParte" value="#{categoriaBean.numParte}" styleClass="form-control"/>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-12">
                                            <div class="col-lg-2">
                                                Unidad:
                                            </div>
                                            <div class="col-lg-4">
                                                <p:selectOneMenu value="#{categoriaBean.idUnidad}" styleClass="form-control">
                                                    <f:selectItems value="#{categoriaBean.unidad}"/>
                                                </p:selectOneMenu>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-6">
                                        <h:dataTable value="#{categoriaBean.listaCampo}" var="data"
                                                     styleClass="table table-striped table-bordered">
                                            <f:facet name="header">Proyectos</f:facet>
                                            <h:column>
                                                <p:selectBooleanCheckbox value="#{data.selected}"
                                                                         styleClass="checkbox text-info"/>
                                            </h:column>
                                            <h:column>
                                                #{data.campo}					    						
                                            </h:column>
                                        </h:dataTable>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <p:commandLink value="Cerrar" 
                                                   styleClass="btn btn-default"
                                                   actionListener="#{categoriaBean.cerrarGuardarArticulo(event)}"
                                                   onclick="$(registrarArticulo).modal('hide');">

                                    </p:commandLink>
                                    <h:commandLink styleClass="btn btn-success" value="Guardar"
                                                   onclick="return validarAgregarArticulo('frmAgregarArticulo\\:txtArticulo')"                                                                                              
                                                   actionListener="#{categoriaBean.guardarArticulo(event)}">
                                    </h:commandLink>
                                    <div class="col-lg-12">
                                        <h:message  for="" style="display: block;" infoClass="alert alert-success" warnClass="alert alert-warning"
                                                    errorClass="alert alert-danger" fatalClass="alert alert-danger"  />
                                    </div>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>

                <div class="modal fade" id="dialogoNotificarNuevoItem" data-backdrop="static" data-keyboard="false" draggable="true">
                    <div class="modal-dialog" style="width: 80%;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Notificar registro de un nuevo artículo</h4>
                            </div>

                            <h:form id="frmNotificarNuevoItem">
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="panel panel-default col-lg-12" >                                    
                                                <div class="form-group col-lg-12" >
                                                    <div class="col-lg-12" style="margin-bottom: 0px;" > 
                                                        <div class="col-lg-12">
                                                            <h:message  for="" style="display: block;" infoClass="alert alert-success" warnClass="alert alert-warning"
                                                                        errorClass="alert alert-danger" fatalClass="alert alert-danger"  />
                                                        </div>
                                                        <div class="col-lg-12 col-xs-12">                                                        
                                                            <div class="visible-lg col-lg-1"></div>
                                                            <h:outputText value="Usuario " class="col-lg-2 col-xs-12 control-label" style="text-align: right;"/>
                                                            <div class="col-lg-6 col-xs-12">
                                                                <!--textChangeListener="#{categoriaBean.usuarioListener}"-->
                                                                <p:autoComplete  id="userSelect"
                                                                                 value="#{categoriaBean.usuarioNotificar}">
                                                                    <f:selectItems value="#{categoriaBean.listaUsuario}" />
                                                                </p:autoComplete>
                                                            </div>
                                                            <div class="visible-lg col-lg-3"></div>
                                                        </div>
                                                    </div>
                                                </div>                                                                        
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <h:commandButton value="Enviar"
                                                     styleClass="btn btn-info"  
                                                     onclick="return validarUsuarioNotificacion('frmNotificarNuevoItem\\:userSelect')"
                                                     actionListener="#{categoriaBean.enviarNotificacionAltaArticulo(actionEvent)}"
                                                     />
                                    <p:commandButton value="Cancelar"
                                                     styleClass="btn btn-default"                                                       
                                                     title="Cerrar ventana..." 
                                                     immediate="true"
                                                     onclick="$(dialogoNotificarNuevoItem).modal('hide');"/>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>

                <!-- Agregar articulo a campo -->
                <div class="modal fade" id="dialogoAgregarArticuloCampo" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog" style="width: 70%;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Datos del artículo</h4>
                            </div>
                            <h:form id="frmAgregarArticuloCampo">
                                <div class="modal-body">
                                    <div class="panel panel-body">
                                        <div class="panel panel-info">
                                            <div class="panel-heading">
                                                <ui:repeat value="#{categoriaBean.categoriasSeleccionadas}" var="data"
                                                           varStatus="indice">
                                                    <p:commandLink  style="padding-left: 2%;"
                                                                    styleClass="text text-primary"
                                                                    actionListener="#{categoriaBean.seleccionarCambiarCategoriaCabecera(event)}">
                                                        <i class="#{data.nombre eq 'Pricipales' ? 'fa fa-circle' : 'fa fa-arrow-right' }" ></i>
                                                        #{data.nombre} 
                                                        <f:param name="indiceCatCamSel" value="#{indice.index}"/>
                                                        <f:param name="idCatCamSel" value="#{data.id}"/>
                                                    </p:commandLink>
                                                </ui:repeat>
                                            </div>
                                        </div>
                                        <div class="panel panel-info">
                                            <div class="panel-heading">
                                                Artículo seleccionado
                                            </div>
                                            <div class="panel-body">
                                                <div class="input-group col-lg-12">
                                                    <div class="form-group">
                                                        <div class="form-group col-lg-12">
                                                            <p:dataTable value="#{categoriaBean.listaCampoPorArticulo}" var="data"
                                                                         rowIndexVar="indice">
                                                                <p:column headerText="Bloque" style="text-align: left;">
                                                                    <h:outputLabel value="#{data.nombre}"/>
                                                                </p:column>
                                                                <p:column>
                                                                    <h:commandLink actionListener="#{categoriaBean.quitarArticuloCampo(event)}">
                                                                        <i class="fa fa-trash-o text-danger"></i>									
                                                                        <f:param name="idRelCamArt" value="#{indice}"/>
                                                                    </h:commandLink>
                                                                </p:column>
                                                            </p:dataTable>
                                                        </div>
                                                        <div class="col-lg-12">

                                                            <div class="col-lg-12">
                                                                <strong>Artículo:</strong>
                                                            </div>
                                                            <div class="col-lg-12">
                                                                <h:outputText value="#{categoriaBean.articuloVO.nombre}" styleClass="control-label"/>                                                
                                                            </div>

                                                            <div class="col-lg-12">
                                                                <strong>No. Parte:</strong>
                                                            </div>
                                                            <div class="col-lg-12">
                                                                <h:outputText value="#{categoriaBean.articuloVO.numParte}" styleClass="control-label"/>
                                                            </div>

                                                            <div class="col-lg-12">
                                                                <strong>Unidad:</strong>
                                                            </div>
                                                            <div class="col-lg-12">
                                                                <h:outputText value="#{categoriaBean.articuloVO.unidadNombre}" styleClass="control-label"/>
                                                            </div>


                                                        </div>


                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-12">
                                            <div class="col-lg-12">
                                                Agregar el artículo a los bloques
                                            </div>
                                            <div class="col-lg-4">
                                                <p:dataTable value="#{categoriaBean.listaNoCampoPorArticulo}" var="data">
                                                    <p:column>
                                                        <h:selectBooleanCheckbox value="#{data.selected}"
                                                                                 class="seleccion"
                                                                                 styleClass="checkbox text-info"/>
                                                    </p:column>
                                                    <p:column>
                                                        <h:outputLabel value="#{data.nombre}"/>
                                                    </p:column>					    
                                                </p:dataTable>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <p:commandLink value="Cerrar" styleClass="btn btn-default" 
                                                   actionListener="#{categoriaBean.cerrarCambiarArticulos(event)}"
                                                   onclick="$(dialogoAgregarArticuloCampo).modal('hide');"/>
                                    <h:commandLink value="Guardar" styleClass="btn btn-primary" 
                                                   onclick="return validaAgregarArticuloCampo('seleccion');"
                                                   actionListener="#{categoriaBean.agregarArticuloCampo(event)}"/>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
            </ui:define>
        </ui:composition>
    </body>
</html>
