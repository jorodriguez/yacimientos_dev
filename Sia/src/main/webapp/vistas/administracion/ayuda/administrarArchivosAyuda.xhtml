<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:p="http://primefaces.org/ui"
      xmlns:my="http://www.mytags.com/schema/mytags"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:body>

        <ui:composition template="./../../../WEB-INF/facelets/templates/templateGrupos.xhtml">
	    <center><h:messages errorClass="errorMessage" infoClass="infoMessage"/></center>

	    <h:panelGroup  rendered="#{empty sesion.usuario}" styleClass="altura">
		<ui:include src="./../../../login.xhtml"/>
	    </h:panelGroup>
	    <ui:define name="contenido">
		<div id="page">
		    <div class="row">
			<ui:include src="menuAdministracion.xhtml" rendered="#{not empty usuarioBean.usuarioVO}"/>		
		    </div>
		    <div class="row">
			<h:form rendered="#{not empty sesion.usuario}" styleClass="textoIzquierda" >
			    <div class="col-lg-12">
				<h2 class="page-header">Administrando Archivos de la Ayuda #{ayudaBean.ayudaSeleccionada.nombre}</h2>
			    </div>
			    <p:panelGrid columns="1" >
				<p:commandLink type="submit" title="Regresar al Catálogo de Ayudas" action="#{ayudaBean.goToCatalogoAyudas()}" styleClass="btn btn-default">
				    <p:graphicImage url="resources/imagenes/regresar.png" alt="Regresar al Catálogo de Ayudas" styleClass="imagenSinBorde" />
				</p:commandLink>
				<p:commandLink value="Regresar al Catálogo de Ayudas" styleClass="linkPequenio" action="#{ayudaBean.goToCatalogoAyudas()}" />
			    </p:panelGrid>                            

			    <br /> <br />

			    <p:panelGrid rendered="#{ayudaBean.archivosAyudaDataModel.rowCount lt 2}">
				<h:outputText value="Subir PDF: "/>
				<p:panelGrid id="panelGridSubirArchivoAyudaPdf" columns="2">
                                    <p:fileUpload id="file-entry-pdf"          multiple="false" skinSimple="true" mode="advanced"
                                                   listener="#{ayudaBean.subirArchivoAyudaPDF}"
						   label="Subir archivo"
						    />
				    <h:commandButton type="submit" value="Subir Archivo" action="#{ayudaBean.uploadFile}">
					<input type="hidden" name="cid" 
					       value="#{javax.enterprise.context.conversation.id}" /> 
				    </h:commandButton>
				</p:panelGrid>
				<h:outputText value="Subir Archivos para Video: "/>
				<p:panelGrid id="panelGridSubirArchivoAyudaVideo" columns="2">
                                    <p:fileUpload id="file-entry-video" multiple="false" skinSimple="true" mode="advanced"
						   listener="#{ayudaBean.subirArchivoAyudaWMV}"
						   label="Subir archivo"
						    />
				    <h:commandButton type="submit" value="Subir Archivo" action="#{ayudaBean.uploadFile}">
					<input type="hidden" name="cid" 
					       value="#{javax.enterprise.context.conversation.id}" /> 
				    </h:commandButton>
				</p:panelGrid>
			    </p:panelGrid>

			    <br />

			    <b><h:outputText value="Archivos de la ayuda #{ayudaBean.ayudaSeleccionada.nombre}" /></b>                                

			    <my:dataGrid id="dataGridArchivosAyuda" rows="2"  value="#{ayudaBean.archivosAyudaDataModel}" showPaginator="true" textoResultado="Mostrando del " textoPagina="página" textoDe="de" >
				<my:column columnName="nombre" headerValue="Nombre"
					   itemValue="#{data.siAdjunto.nombre}" isColumSort="true"/>
				<p:column>
				    <f:facet name="header">
					<h:outputText value="Peso"/>
				    </f:facet>
				    <h:outputText value="#{data.siAdjunto.peso}" />
				</p:column>
				<p:column>
				    <p:commandLink value="Eliminar" actionListener="#{ayudaBean.eliminarArchivo()}" 
						     title="Eliminar" onclick="if (!confirm('Está seguro que desea eliminar este archivo?'))
								 return false;" styleClass="link" /> 
				</p:column>
				<p:column>
				    <p:panelGrid columns="2">
                                        <p:link value="/Sia/AbrirArchivo?ZWZ2W=#{data.siAdjunto.id}&amp:ZWZ3W=#{data.siAdjunto.uuid}" target="_blank" rendered="#{data.siAdjunto.tipoArchivo eq 'application/pdf'}" >
					    <p:graphicImage url="./resources/imagenes/icon_pdf.png" alt="Abrir Documento" title="Abrir Documento" styleClass="imagenSinBorde" width="16px" height="16px"/>
					</p:link>
					<p:link value="/Sia/AbrirArchivo?ZWZ2W=#{data.siAdjunto.id}&amp:ZWZ3W=#{data.siAdjunto.uuid}" target="_blank" rendered="#{data.siAdjunto.tipoArchivo eq 'application/pdf'}" >
					    <h:outputText value="Abrir Documento" title="Abrir Documento" styleClass="link" />
					</p:link>   
				    </p:panelGrid>
				    <p:panelGrid columns="2">
					<p:link value="/Sia/AbrirVideo?a=#{data.siAdjunto.id}" target="_blank" rendered="#{data.siAdjunto.tipoArchivo eq 'video/x-ms-wmv'}" >
					    <p:graphicImage url="./resources/imagenes/icon_video_wmv.png" alt="Abrir" title="Abrir" styleClass="imagenSinBorde" width="16px" height="16px"/>
					</p:link>
					<p:link value="/Sia/AbrirVideo?a=#{data.siAdjunto.id}" target="_blank" rendered="#{data.siAdjunto.tipoArchivo eq 'video/x-ms-wmv'}" >
					    <h:outputText value="Abrir Vídeo" title="Abrir Vídeo" styleClass="link" />
					</p:link>   
				    </p:panelGrid>
				</p:column>
			    </my:dataGrid>        
			</h:form>
		    </div>
		</div>
            </ui:define>

        </ui:composition>

    </h:body>
</html>
