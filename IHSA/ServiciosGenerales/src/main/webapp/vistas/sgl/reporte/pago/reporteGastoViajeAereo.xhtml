<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                >
    <h:messages style="color: maroon; font-size: 12px;"/>

    <script>
        $(function () {
            $("#tabTipoReporte").tabs();
        });
    </script>
    <div id="tabTipoReporte" class="row">
        <ul>
            <li><a  href="#viajes" onclick="ejecutarBoton('frmCostoViaje', 'btnLimpiar');" 
                    >Por fechas</a></li>
            <li><a href="#usuario" onclick="ejecutarBoton('frmCostoViaje', 'btnLimpiar');" >Por empleado</a></li>
        </ul>
        <div id="viajes" class="row-fluid">
            <h:panelGrid columns="4">
                <h:panelGrid columns="9" styleClass="bordePanelGrid">
                    <h:outputLabel value="Inicio"/>
                    <h:panelGrid  columns="2">
                        <script>
                            $(function () {
                                $("#frmCostoViaje\\:inicio").datepicker({
                                    showOn: "button",
                                    buttonImage: "../resources/img/cal_button.gif",
                                    buttonImageOnly: true,
                                    dateFormat: "dd/mm/yy",
                                    onSelect: function (date) {
                                        inicio = date;
                                    }
                                });
                            });
                        </script>
                        <h:inputText  value="#{consultaBean.inicio}" id="inicio" size="10" required="true" requiredMessage="Seleccione el inicio"/>
                    </h:panelGrid> 
                    <h:outputLabel value="Fin" />
                    <h:panelGrid columns="2" >
                        <script>
                            $(function () {
                                $("#frmCostoViaje\\:fin").datepicker({
                                    showOn: "button",
                                    buttonImage: "../resources/img/cal_button.gif",
                                    buttonImageOnly: true,
                                    dateFormat: "dd/mm/yy",
                                    onSelect: function (date) {
                                        fin = date;
                                    },
                                    onClose: function (selectedDate) {
                                        $("#frmCostoViaje\\:inicio").datepicker("option", "maxDate", selectedDate);
                                    }
                                });
                            });
                        </script>
                        <h:inputText  value="#{consultaBean.fin}" id="fin" size="10" required="true" requiredMessage="Seleccione el final"/>            
                    </h:panelGrid>
                </h:panelGrid>
                <h:outputLabel value="MÃ³neda"/>
                <p:selectOneMenu id="idComboMoneda" value="#{consultaBean.idMoneda}">
                    <f:selectItems value="#{consultaBean.listaMoneda}"/>
                </p:selectOneMenu>
                <p:commandLink value="#{msgs['sistema.buscar']}" 
                               actionListener="#{consultaBean.buscarGastoViaje(event)}"  styleClass="compartir"/>
            </h:panelGrid>
        </div>
        <div id="usuario">
            <div class="col-lg-12" >
                <h:panelGrid columns="5" >
                    <h:outputLabel value="Empleado" class="h5"/>
                    <h:inputText  id="autocomplete" class="form-control"/>
                    <h:inputHidden id="hidenDes" value="#{consultaBean.idUsuario}"/>
                    <!--ice:selectInputText id="userSelect" style="z-index: 10045;"
                                         immediate="true" 
                                         listVar="analista"
                                         listValue="#{consultaBean.listaUsuario}"
                                         valueChangeListener="#{consultaBean.usuarioListener}">
                            <f:facet name="selectInputText" >
                                <h:outputText id="autoCompleteUsurOp" value="#{analista.nombre}"  />
                            </f:facet>
                    </ice:selectInputText--> 
                    <p:commandLink value="#{msgs['sistema.buscar']}" 
                                   actionListener="#{consultaBean.buscarGastoViajePorEmpleado(event)}"  
                                   styleClass="btn btn-sm btn-info"/>

                </h:panelGrid>
            </div>
            <div class="col-lg-12" >
                Para: <h:outputLabel id="nombreUsuario" value="-"/>
            </div>
        </div>
    </div>
    <div class="row">
        <h:commandLink id="btnLimpiar" style="display: none" actionListener="#{consultaBean.limiarListaJon(event)}" 
                       styleClass="compartir"/>
        <div id="graficaCostoViaje" style="min-width: 700px; height: 400px; margin: 0 auto;" ></div>
        <br/>
        <h:inputHidden id="hidenServicio" value="#{consultaBean.servicioVehiculo}"/>
        <p:commandLink id="btnBuscarPorServicio" value="Buscar" actionListener="#{consultaBean.traerViajesPorGerencia(event)}"
                       style="display: none;"/>

        <p:dataTable id="dtViajeFactura" var="data" value="#{consultaBean.listaViajeFactura}"
                     rows="20" styleClass="dataPaginatorDataTable" 
                     paginator="true"  showGridlines="true" size="small"
                     paginatorPosition="bottom"  
                     rowStyleClass="h6">
            <f:facet name="header"> Viajes de  #{consultaBean.servicioVehiculo}</f:facet>
            <p:column headerText="Viajero" styleClass="h5">
                <h:outputText value="#{data.viajero}"/>
            </p:column>
            <p:column headerText="Tipo" styleClass="h5">
                <h:outputText value="#{data.tipo}"/>
            </p:column>
            <p:column headerText="Proveedor" styleClass="h5">
                <h:outputText value="#{data.proveedor}"/>
            </p:column>
            <p:column headerText="Folio" styleClass="h5">
                <h:outputText  value="#{data.folio}"/>
            </p:column>
            <p:column headerText="Concepto" styleClass="h5">
                <h:outputText value="#{data.concepto}"/>
            </p:column>
            <p:column headerText="Monto" styleClass="h5">
                <h:outputText value="#{data.monto}"/>
                <h:outputText value=" "/>
                <h:outputText value="#{data.moneda}"/>
            </p:column>
            <p:column headerText="Fecha" styleClass="h5">
                <h:outputText value="#{data.fechaEmision}">
                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                </h:outputText>
            </p:column>
            <p:column>
                <h:outputLink rendered="#{data.idAdjunto gt 0}" 
                              target="_blank" 
                              value="/Sia/AbrirArchivo?ZWZ2W=#{data.idAdjunto}&amp;ZWZ3W=#{data.uuId}"
                              title="#{msgs['sistema.abrir.archivo']}">
                    <center><h:graphicImage url="#{msgs['sgl.ruta.imagen']}icon_attach.gif" alt="#{msgs['sistema.abrir.archivo']}" /></center>
                </h:outputLink>
            </p:column>
        </p:dataTable>
        <h:panelGrid columns="2">
            <p:commandButton value="Exportar">
                <p:dataExporter fileName="viajeFactura" type="xls" target="dtViajeFactura" />
            </p:commandButton>
        </h:panelGrid>
    </div>
</ui:composition>