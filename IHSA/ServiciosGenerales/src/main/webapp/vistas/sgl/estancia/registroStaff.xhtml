<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      
      
     >

    <body>

        <ui:composition template="./../../../WEB-INF/facelets/templates/templateServiciosGenerales.xhtml">

            <ui:define name="contenido">

                <p class="tituloEncabezado">#{msgs['sgl.solicitudEstancia.titulo.asignarHabitacionStaff']}</p>
                <h:form  >
                    <h:panelGrid >
                        <p:commandLink action="#{estanciaBean.backToAsignarHabitacionFromRegistroHotel()}" title="#{msgs['sistema.regresar']} #{msgs['sistema.proposicion.a']} Asignar Habitación" styleClass="btn btn-default">
                            <h:graphicImage url="#{msgs['sgl.ruta.imagen']}button_back.png" title="#{msgs['sistema.regresar']} #{msgs['sistema.proposicion.a']} Asignar Habitación" alt="#{msgs['sistema.registrar']} #{msgs['sistema.proposicion.a']} Asignar Habitación" styleClass="imagenSinBorde" />
                        </p:commandLink>
                        <p:commandLink action="#{estanciaBean.backToAsignarHabitacionFromRegistroHotel()}" value="#{msgs['sistema.regresar']} #{msgs['sistema.proposicion.a']} Asignar Habitación" title="#{msgs['sistema.registrar']} #{msgs['sistema.proposicion.a']} Asignar Habitación" styleClass="linkPequenio" />
                    </h:panelGrid>  
                </h:form>
                <!-- Registro en Staff -->
                <h:form id="popupRegistroHuespedStaff"  >
                    <span id="mensajeErrorSeleccionTipoHuesped" class="textoRojo"></span>
                    <h:message for="mensajeErrorSeleccionTipoHuesped" infoClass="infoMessage" errorClass="errorMessage" />

                    <span id="mensajeErrorSeleccionFechaIngreso" class="textoRojo"></span>
                    <h:message for="mensajeErrorSeleccionFechaIngreso" infoClass="infoMessage" errorClass="errorMessage" />

                    <span id="mensajeErrorSeleccionFechaSalida" class="textoRojo"></span>
                    <h:message for="mensajeErrorSeleccionFechaSalida" infoClass="infoMessage" errorClass="errorMessage" />

                    <span id="mensajeErrorSeleccionFechaSalidaPropuesta" class="textoRojo"></span>
                    <h:message for="mensajeErrorSeleccionFechaSalidaPropuesta" infoClass="infoMessage" errorClass="errorMessage" />

                    <span id="mensajeErrorSeleccionStaff" class="textoRojo"></span>
                    <h:message for="mensajeErrorSeleccionStaff" infoClass="infoMessage" errorClass="errorMessage" />
                    <!--Valida fechas-->
                    <h:panelGrid columns="1" width="400px" styleClass="bordePanelGrid">
                        <h:panelGrid columns="1" >
                            <h:panelGrid columns="2"  styleClass="bordePanelGrid" >
                                <f:facet name="header"><h:outputText value="#{msgs['sgl.solicitudEstancia.datos']}" /></f:facet>
                                <h:panelGrid columns="2" >
                                    <h:outputLabel value="#{msgs['sgl.solicitudEstancia.solicito']}: " />
                                    <h:outputText id="gerenteSolicitante" value="#{estanciaBean.sgSolicitudEstanciaVo.nombre}" />
                                </h:panelGrid>
                                <h:panelGrid columns="2" >
                                    <h:outputLabel value="#{msgs['sgl.solicitudEstancia.gerenciaSolicitante']}: " />
                                    <h:outputText id="gerenciaSolicitante" value="#{estanciaBean.sgSolicitudEstanciaVo.nombreGerencia}" />
                                </h:panelGrid>                                
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="#{msgs['sgl.solicitudViaje.oficina.destino']}: " />
                                    <h:outputText id="nombreOficinaDestino" value="#{estanciaBean.sgSolicitudEstanciaVo.nombreSgOficina}" />
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="#{msgs['sgl.solicitudViaje.motivo']}: " />
                                    <h:outputText id="motivoEstancia" value="#{estanciaBean.sgSolicitudEstanciaVo.nombreSgMotivo}" />
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="#{msgs['sgl.staff.contrato.fechaInicio']}: " />
                                    <h:outputText id="fInicioEstancia" value="#{estanciaBean.sgSolicitudEstanciaVo.inicioEstancia}" >
                                        <f:convertDateTime pattern="dd/MM/yyyy" type="date" />
                                    </h:outputText>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="#{msgs['sgl.generales.fechas.fechaFin']}: " />
                                    <h:outputText id="fFinEstancia" value="#{estanciaBean.sgSolicitudEstanciaVo.finEstancia}" >
                                        <f:convertDateTime pattern="dd/MM/yyyy" type="date" />
                                    </h:outputText>
                                </h:panelGrid>
                            </h:panelGrid>                            

                            <h:panelGrid  styleClass="bordePanelGrid" >
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Huésped: " />
                                    <h:outputText value="#{estanciaBean.integranteSeleccionado.usuario}" rendered="#{estanciaBean.integranteSeleccionado.idInvitado == 0}" styleClass="fNegrita12" />
                                    <h:outputText value="#{estanciaBean.integranteSeleccionado.invitado}" rendered="#{estanciaBean.integranteSeleccionado.idInvitado gt 0}" styleClass="fNegrita12" />
                                </h:panelGrid>

                                <h:panelGrid columns="2"  >
                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="#{msgs['sgl.solicitudEstancia.tipoHuesped']}: " styleClass="fNegrita11"/>
                                        <h:outputText value="*" styleClass="textoRojo" />
                                    </h:panelGrid>
                                    <h:panelGrid>
                                        <p:selectOneMenu id="tipoHuesped" 
                                                           value="#{estanciaBean.idTipoEspecifico}" 
                                                            
                                                           valueChangeListener="#{estanciaBean.validateTipoHuesped}"
                                                           styleClass="form-control">
                                            <f:selectItem id="siTipoHuesped" itemLabel="#{msgs['sistema.seleccionar']} #{msgs['sgl.solicitudEstancia.tipoHuesped']}..." itemValue="-1"/>
                                            <f:selectItems value="#{estanciaBean.tiposHuespedes}"/>
                                        </p:selectOneMenu>
                                    </h:panelGrid>


                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="#{msgs['sgl.generales.fechas.fechaIngreso']}: " styleClass="fNegrita11"/>
                                        <h:outputText value="*" styleClass="textoRojo" />
                                    </h:panelGrid>
                                    <h:panelGrid>
					<p:datePicker value="#{estanciaBean.fechaIngresoHuesped}" id="fechaIngresoStaff"
							   disabled="#{estanciaBean.disabledAux}"   pattern="dd/MM/yyyy"
							   />
                                        <h:panelGrid columns="2"  >
                                            <h:message for="fechaIngresoStaff" infoClass="infoMessage" errorClass="errorMessage" />
                                        </h:panelGrid>
                                    </h:panelGrid>

                                    <h:panelGrid columns="2" rendered="#{!estanciaBean.flag}" >
                                        <h:outputLabel value="#{msgs['sgl.generales.fechas.fechaSalida']}:" styleClass="fNegrita11"/>
                                        <h:outputText value="*" styleClass="textoRojo" />
                                    </h:panelGrid>
                                    <h:panelGrid rendered="#{!estanciaBean.flag}" >
					<p:datePicker value="#{estanciaBean.fechaSalidaHuesped}" id="fechaSalidaHuespedStaff"
							    pattern="dd/MM/yyyy"
							   />
                                        <h:panelGrid columns="2"  >
                                            <h:message for="fechaSalidaHuespedStaff" infoClass="infoMessage" errorClass="errorMessage" />
                                        </h:panelGrid>
                                    </h:panelGrid>
                                </h:panelGrid>                                

                                <h:outputText value="#{msgs['sgl.solicitudEstancia.msg.fechaPropuestaPeriodoPrueba']} " styleClass="textoAzul" style="font-size: 11px" rendered="#{estanciaBean.flag}" />

                                <h:panelGrid columns="4" rendered="#{estanciaBean.flag}" >
                                    <h:outputLabel value="#{msgs['sgl.generales.fechas.salidaPropuesta']}:"/>
                                    <h:outputText value="*" styleClass="textoRojo" />
				    <p:datePicker value="#{estanciaBean.fechaSalidaPropuesta}" id="fechaSalidaHuespedStaffPropuesta"
						       disabled="#{estanciaBean.disabledAux}"  pattern="dd/MM/yyyyy"
						       />
                                    <h:panelGrid columns="2"  >
                                        <h:message for="fechaSalidaHuespedStaffPropuesta" infoClass="infoMessage" errorClass="errorMessage" />
                                    </h:panelGrid>
                                </h:panelGrid>

                                <h:panelGrid columns="2" >
                                    <h:panelGrid>
                                        <h:outputLabel value="#{msgs['sgl.solicitudEstancia.diasEstancia']}:" styleClass="fNegrita11"/>
                                    </h:panelGrid>
                                    <h:panelGrid>
                                        <h:outputText value="#{estanciaBean.calculoDiasEstancia}" rendered="#{estanciaBean.idTipoEspecifico ne 17}" />
                                        <h:outputText value="#{msgs['sgl.solicitudEstancia.msg.diasIlimitados']}" rendered="#{estanciaBean.idTipoEspecifico eq 17}" />
                                    </h:panelGrid>
                                </h:panelGrid>
                            </h:panelGrid>

                            <h:panelGrid  styleClass="bordePanelGrid" >
                                <h:panelGrid columns="3">
                                    <h:outputLabel value="Staff: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                    <p:selectOneMenu id="tipo" value="#{estanciaBean.idStaff}"  
                                                       valueChangeListener="#{estanciaBean.cargarHabitacionesInTableByStaff}" styleClass="form-control" >
                                        <f:selectItem itemLabel="#{msgs['sistema.seleccionar']} #{msgs['sgl.staff']}..." itemValue="-1" />
                                        <f:selectItems value="#{estanciaBean.staffSelectItem}" />
                                    </p:selectOneMenu>
                                </h:panelGrid>
                                <h:panelGrid columns="3" >
                                    <h:outputLabel value="#{msgs['sgl.solicitudEstancia.habitacionSeleccionada']}: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                    <h:outputText value="#{estanciaBean.habitacion.nombre} | #{estanciaBean.habitacion.numeroHabitacion}" style="font-size: 13px; font-weight: bold" />
                                </h:panelGrid>

                                <p:dataTable showGridlines="true" size="small"  id="dataGridHabitacionesStaff"
                                               value="#{estanciaBean.habitacionesStaffDataModel}"
                                               var="data"
                                               scrollable="true"
                                               scrollHeight="75px"
                                                >
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs['sgl.staff.habitacion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{data.nombre}" />
                                    </p:column>                                 
                                    <p:column style="text-align: center;">
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs['sgl.staff.habitacion.numeroHabitacion']}" />
                                        </f:facet>
                                        <h:outputText value="#{data.numeroHabitacion}" />
                                    </p:column>   
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs['sgl.solicitudEstancia.habitacion.asignar']}" />
                                        </f:facet>
                                        <p:commandLink value="#{msgs['sistema.seleccionar']} #{msgs['sgl.staff.habitacion']}" 
                                                         actionListener="#{estanciaBean.seleccionarHabitacion(actionEvent)}"
                                                         styleClass="link"/>
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs['sgl.solicitudEstancia.habitacion.ocupada']}" />
                                        </f:facet>
                                        <h:outputText value="#{data.ocupada eq 'True' ? msgs['sistema.si'] : msgs['sistema.no']}" />
                                    </p:column>                                     
                                </p:dataTable>                                
                            </h:panelGrid>                            
                        </h:panelGrid> 

                        <center>
                            <h:panelGrid columns="2">
                                <h:commandButton value="#{msgs['sistema.guardar']}" action="#{estanciaBean.registerHuespedInStaffHouse()}" 
                                                 onclick="return validaRegistroHuesped();" styleClass="btn btn-info"/>
                                <p:commandButton value="#{msgs['sistema.cancelar']}" action="#{estanciaBean.backToAsignarHabitacionFromRegistroStaff()}" immediate="true" styleClass="btn btn-default"/>
                            </h:panelGrid>                        
                        </center>                         
                    </h:panelGrid>
                </h:form>

                <!-- Habitación Ocupada -->
                <h:form  >
                    <p:dialog  header="#{msgs['sistema.confirmar']}">
                        <h:panelGrid columns="1" width="400px">

                            <h:outputText value="#{msgs['sgl.estancia.registroStaff.mensaje.info.habitacionOcupada1']}" />

                            <h:panelGrid styleClass="bordePanelGrid" >
                                <!--<f:facet name="header"><h:outputText value="Huéspedes" /></f:facet>-->
                                <p:dataTable id="dataGridHospedados" rows=""  value="#{estanciaBean.huespedesByHabitacionStaff}" 
                                             var="data">
                                    <p:column>
                                        <!--<f:facet name="header" >
                                            <h:outputText value="#{msgs['sgl.generales.nombre']}" />
                                        </f:facet>-->
                                        <h:outputText value="#{data.nombreHuesped}" />
                                    </p:column>                                     
                                </p:dataTable>
                            </h:panelGrid>

                            <h:outputText value="#{msgs['sgl.estancia.registroStaff.mensaje.info.habitacionOcupada2']} #{estanciaBean.integranteSeleccionado.idInvitado == 0 ? estanciaBean.integranteSeleccionado.usuario : estanciaBean.integranteSeleccionado.invitado} #{msgs['sgl.estancia.registroStaff.mensaje.info.habitacionOcupada3']}" />

                        </h:panelGrid>

                        <center>
                            <h:panelGrid columns="2">
                                <p:commandButton value="#{msgs['sistema.confirmar']}" actionListener="#{estanciaBean.confirmarSeleccionarHabitacion(actionEvent)}" styleClass="btn btn-info"/>        
                                <p:commandButton value="#{msgs['sistema.cancelar']}" actionListener="#{estanciaBean.closePopupSeleccionarHabitacion(actionEvent)}" styleClass="btn btn-default"/>        
                            </h:panelGrid>                        
                        </center>
                    </my:panelPopup>                    
                </h:form>

            </ui:define>

        </ui:composition>

    </body>
</html>