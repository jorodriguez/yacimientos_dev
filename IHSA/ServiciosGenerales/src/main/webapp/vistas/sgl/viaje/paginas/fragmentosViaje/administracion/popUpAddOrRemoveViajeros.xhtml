<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:h="http://java.sun.com/jsf/html"

                >
    <div class="modal fade" id="dialogoPopUpAddOrRemoveViajeros" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" >
                    <h4 class="modal-title" style="display: #{administrarViajeBean.estatusViaje == 510 ? 'none' : 'block'}">Administrar Viajeros</h4>
                    <h4 class="modal-title" style="display: #{administrarViajeBean.estatusViaje == 510 ? 'block' : 'none'}">Viajeros</h4>
                    <div style="margin-top: 10px;" class="col-lg-12 col-xs-12">
                        <h:message  for="" style="display: block;" infoClass="alert alert-success" warnClass="alert alert-warning"
                                    errorClass="alert alert-danger" fatalClass="alert alert-danger"  />
                    </div>
                </div>
                <h:form id="frmPnlAddorRemoveViajeros" >
                    <div class="modal-body">
                        <div class="row" style="display: #{administrarViajeBean.estatusViaje == 510 ? 'block' : 'none'}">
                            <label>Viajeros</label>
                            <hr/>
                        </div>
                        <div class="row" style="display: #{administrarViajeBean.estatusViaje == 505 ? 'block' : 'none'}">
                            <label>Agregar Viajeros Emergentes</label>
                            <hr/>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 col-xs-12">
                                <p:dataTable id="viajerosTerrestre" value="#{administrarViajeBean.listaViajeros}" var="via" 
                                             size="small" showGridlines="true">
                                    <p:column headerText="Viajero" id="viajero" >
                                        <h:outputText value="#{via.usuario}" rendered="#{via.usuario ne 'null'}"/>
                                        <h:outputText value="#{via.invitado}" rendered="#{via.invitado ne 'null'}"/>                                        
                                    </p:column>
                                    <p:column id="tipo" headerText="Tipo" >
                                        <h:outputText id="tipocell" value="#{via.esEmpleado ? 'Empleado' :'Invitado'}"/>
                                    </p:column>
                                    <p:column headerText="Solicitud">
                                        <h:outputText id="tipoViajero" value="#{via.codigoSolicitudViaje}"/>
                                    </p:column>
                                    <p:column style="display: #{administrarViajeBean.estatusViaje >= 510 ? 'none' : 'block'}" headerText="Fecha de regreso" >
                                        <h:outputText id="fregreso" value="#{via.fechaRegreso}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column id="eliminarViajero"  width="35">
                                        <p:commandLink actionListener="#{administrarViajeBean.removeViajeros(via.id,via.idUsuario,via.idInvitado)}"
                                                       style="display: #{administrarViajeBean.estatusViaje >= 510 ? 'none' : 'block'}"
                                                       title="Quitar viajero" process="@this" update="frmPnlAddorRemoveViajeros:viajerosTerrestre">
                                            <span class="fa fa-trash text-danger"/>
                                        </p:commandLink>
                                    </p:column>
                                </p:dataTable>
                            </div>
                        </div> <br/>
                        <div class="row" style="display: #{administrarViajeBean.estatusViaje >= 510 ? 'none' : 'block'}">
                            <p:tabView id="tbViajeros">
                                <p:tab title="Viajeros emergentes">
                                    <p:tabView>
                                        <p:tab title="Empleados">
                                            <p:autoComplete id="autoEmpleado" value="#{administrarViajeBean.empleadoEmergente}"
                                                            forceSelection="true" minQueryLength="4" size="35"
                                                            completeMethod="#{administrarViajeBean.usuarioListener}">
                                                <p:ajax listener="#{administrarViajeBean.agregarEmpleado}" update="@this frmPnlAddorRemoveViajeros:viajerosTerrestre"/>
                                            </p:autoComplete>
                                        </p:tab>
                                        <p:tab title="Invitados">
                                            <p:autoComplete id="autoInv" value="#{administrarViajeBean.invitadoEmergente}"
                                                            forceSelection="true" minQueryLength="4" size="35"
                                                            completeMethod="#{administrarViajeBean.invitadoListener}">
                                                <p:ajax listener="#{administrarViajeBean.agregarInvitado}" update="@this frmPnlAddorRemoveViajeros:viajerosTerrestre"/>
                                            </p:autoComplete>

                                        </p:tab>
                                    </p:tabView>
                                </p:tab>
                                <p:tab title="Viajeros con solicitud">
                                    <ui:repeat  value="#{administrarViajeBean.solicitudesViajeros}" var="pen">
                                        <div class="col-6">
                                            <p:commandLink action="#{administrarViajeBean.selecionarSolicitud(pen)}"
                                                           process="@this" update="frmPnlAddorRemoveViajeros:tbViajeros:dtViajeros">
                                                #{pen.codigo} #{pen.destino} 
                                            </p:commandLink>
                                        </div>
                                    </ui:repeat>
                                    <p:dataTable id="dtViajeros" value="#{administrarViajeBean.listaViajerosSolicitud}" var="data" 
                                                 size="small" showGridlines="true">
                                        <p:column headerText="Solicitud" width="80">
                                            <h:outputText value="#{data.codigoSolicitudViaje}"/>
                                        </p:column>
                                        <p:column headerText="Viajeros">
                                            <h:outputText value="#{data.usuarioTxt}"/>
                                        </p:column>
                                        <p:column width="60">
                                            <p:commandLink action="#{administrarViajeBean.addViajeroConSV(data.id)}"
                                                           process="@this" value="Agregar"
                                                           update="frmPnlAddorRemoveViajeros:viajerosTerrestre"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:tab>
                            </p:tabView>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <p:commandLink  action="#{administrarViajeBean.addAndOrRemoveViajeros()}" id="btnGuardar"
                                        value="Aceptar" process="@form" update="frmCrearViaje"/>
                        <button type="button" class="btn btn-default" onclick="$(dialogoPopUpAddOrRemoveViajeros).modal('hide');" id="exit">Cancelar</button>
                    </div>
                </h:form>
            </div>
        </div>
    </div>
</ui:composition>
