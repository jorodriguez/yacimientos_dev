<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html" 
     
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <body>

        <ui:composition template="./../../../../WEB-INF/facelets/templates/templateServiciosGenerales.xhtml">

            <ui:define name="contenido">

                <h:panelGroup rendered="#{empty sesion.usuario}" styleClass="altura"  >
                    <ui:include src="./../../../../login.xhtml"/>
                </h:panelGroup>

                <h:panelGroup  >
                    <p class="tituloEncabezado">#{msgs['sistema.modificar']} #{msgs['sgl.checklist.titulo']} del #{msgs['sgl.vehiculo']} #{vehiculoBean.vehiculo.marca} #{vehiculoBean.vehiculo.modelo}</p>

                </h:panelGroup>                

                <h:panelGroup  >
                    <h:form  >
                        <h:panelGrid columns="" >
                            <p:commandLink title="#{msgs['sistema.regresar']} a Administrar Vehiculo"  
                                             actionListener="#{vehiculoBean.clearVariables(actionEvent)}" action="/vistas/sgl/vehiculo/administrarVehiculo" styleClass="btn btn-default">
                                <h:graphicImage url="#{msgs['sgl.ruta.imagen']}button_back.png" alt="#{msgs['sistema.regresar']} a Administrar Vehículo" title="#{msgs['sistema.regresar']} a Administrar Vehículo" styleClass="imagenSinBorde"/>
                            </p:commandLink>
                            <p:commandLink value="#{msgs['sistema.regresar']} a Administrar Vehículo" action="/vistas/sgl/vehiculo/administrarVehiculo" styleClass="linkPequenio"/>
                        </h:panelGrid>
                    </h:form>
                </h:panelGroup>   

                <br/><br/>

                <!-- Actualizar Checklist Interior de Vehículo -->
                <h:panelGroup  >
                    <h:form >
                        <h:panelGrid  styleClass="bordePanelGrid">
                            <f:facet name="header">
                                <h:outputText value="Checklist Interior"/>
                            </f:facet>

                            <br/>

                            <h:panelGrid columns="6">
                                <h:outputLabel value="Kilometraje: " />
                                <h:outputText value="*" styleClass="textoRojo" />
                                <p:inputText id="kilometraje" value="#{vehiculoBean.vehiculoChecklist.sgKilometraje.kilometraje}" />
                                <h:outputLabel value="Km. " />
                                <h:outputText value="(último: #{vehiculoBean.kilometrajeActual != null ? vehiculoBean.kilometrajeActual.kilometraje : 0} Km.)" />
                                <p:commandLink value="#{msgs['sistema.reiniciar']}" title="#{msgs['sistema.reiniciar']}"
                                                 actionListener="#{vehiculoBean.openPopupRestartKilometraje(actionEvent)}" />
                            </h:panelGrid>                            

                            <br/>

                            <p:dataTable showGridlines="true" size="small"  value="#{vehiculoBean.checklistVehiculoVODataModelForUpdate}"
                                           var="data"
                                           scrollable="true"
                                           scrollHeight="400px"
                                            >
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Nombre"/>
                                    </f:facet>
                                    <h:outputText value="#{data.caracteristicaVo.nombre}" />
                                </p:column>                                 
                                <p:column style="text-align: center;" >
                                    <f:facet name="header">
                                        <h:outputText value="Correcto"/>
                                    </f:facet>
                                    <p:selectBooleanCheckbox value="#{data.estado}" rendered="#{data.caracteristicaVo.principal eq 'False'}" />
                                </p:column> 
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Observación" />
                                    </f:facet>
                                    <p:inputTextarea value="#{data.observacion}" rendered="#{data.caracteristicaVo.principal eq 'False'}" maxlength="1024" style="width: 510px" />
                                </p:column>                            
                            </p:dataTable>
                            <br/>
                            <p:commandButton value="#{msgs['sistema.actualizar']}" actionListener="#{vehiculoBean.updateChecklistVehiculo(actionEvent)}" styleClass="btn btn-info"/>

                        </h:panelGrid>
                    </h:form>         
                </h:panelGroup>
                <br/>
                <!-- Crear o eliminar ChecklistExterior de Vehículo -->
                <h:panelGroup  >
                    <h:form  >
                        <h:panelGrid  styleClass="bordePanelGrid" >
                            <f:facet name="header">
                                <h:outputText value="Checklist Externo"/>
                            </f:facet>

                            <h:panelGrid id="card GridSubirArchivoChecklistExterior" columns="2" rendered="#{vehiculoBean.checklistExtVehiculo == null}" >
                               
                                <p:fileUpload  id="fileEntryChecklistExteriorVehiculo"
                                               listener="#{vehiculoBean.uploadFileChecklistExteriorVehiculoNuevo}"
                                               label="Subir archivo"/>
                            </h:panelGrid>

                            <h:panelGrid rendered="#{vehiculoBean.checklistExtVehiculo != null}" >

                                <p:dataTable id="dataGridAdjuntoChecklistExterior" rows="2" 
                                             value="#{vehiculoBean.checklistExtVehiculo.siAdjunto}" var="data" >
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Peso"/>
                                        </f:facet>
                                        <h:outputText value="#{data.peso}" />
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Observación"/>
                                        </f:facet>
                                        <h:outputText value="#{data.descripcion}" />
                                    </p:column>                                            
                                    <p:column>
                                        <h:outputLink target="_blank"  value="/ServiciosGenerales/AbrirArchivo?ZWZ2W=#{data.id}&amp;ZWZ3W=#{data.uuid}">
                                            <center><h:graphicImage url="#{msgs['sgl.ruta.imagen']}icon_attach.gif"  alt="Abrir archivo" /></center>
                                        </h:outputLink>
                                    </p:column>
                                    <p:column>
                                        <p:commandLink value="Agregar Observación" actionListener="#{vehiculoBean.openPopupAddObservacionToChecklistExterior(actionEvent)}" rendered="#{vehiculoBean.checklistExtVehiculo.siAdjunto != null and empty vehiculoBean.checklistExtVehiculo.siAdjunto.descripcion}" styleClass="link" />
                                    </p:column>
                                    <p:column>
                                        <p:commandLink value="Modificar Observación" actionListener="#{vehiculoBean.openPopupUpdateObservacionToChecklistExterior(actionEvent)}" rendered="#{vehiculoBean.checklistExtVehiculo.siAdjunto != null and not empty vehiculoBean.checklistExtVehiculo.siAdjunto.descripcion}" styleClass="link" />
                                    </p:column>                                            
                                    <p:column>
                                        <p:commandLink value="#{msgs['sistema.eliminar']}" 
                                                         actionListener="#{vehiculoBean.deleteAdjuntoChecklistExterior(actionEvent)}"
                                                         title="Eliminar"
                                                         onclick="if (!confirm('Está seguro que desea eliminar este archivo?'))
                                                                     return false;" 
                                                         styleClass="link" /> 
                                    </p:column>
                                </p:dataTable>                                        

                            </h:panelGrid>
                        </h:panelGrid>
                    </h:form> 
                </h:panelGroup>               

                <br />

                <!-- Modificar Checklist de llantas -->
                <h:panelGroup  >
                    <h:form  rendered="#{vehiculoBean.checklistLlantas.id != null}">
                        <h:panelGrid  styleClass="bordePanelGrid">
                            <f:facet name="header">
                                <h:outputText value="Checklist Llantas"/>
                            </f:facet>

                            <h:outputLabel value="Condiciones de llantas (%)" />
                            <h:panelGrid columns="2">
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Delantera Izquierda: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="delanteraIzquierda" value="#{vehiculoBean.checklistLlantas.delanteraIzquierda}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="delanteraIzquierda" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Delantera Derecha: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="delanteraDerecha" value="#{vehiculoBean.checklistLlantas.delanteraDerecha}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="delanteraDerecha" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Trasera Izquierda: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="traseraIzquierda" value="#{vehiculoBean.checklistLlantas.traseraIzquierda}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="traseraIzquierda" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Trasera Derecha " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="traseraDerecha" value="#{vehiculoBean.checklistLlantas.traseraDerecha}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="traseraDerecha" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:outputLabel value="Refacción: " />
                                <h:panelGrid columns="3">
                                    <p:inputText id="refaccion" value="#{vehiculoBean.checklistLlantas.refaccion}" >
                                        <f:validateLongRange minimum="0" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="refaccion" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:outputLabel value="Estado general de llantas: " />
                                <p:selectBooleanCheckbox value="#{vehiculoBean.flag}"/>
                            </h:panelGrid>
                            <h:panelGrid columns="2">
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Comentarios: " />
                                    <p:inputTextarea value="#{vehiculoBean.checklistLlantas.observacion}" rows="5" cols="50" />
                                </h:panelGrid>
                            </h:panelGrid>                            

                            <p:commandButton value="#{msgs['sistema.actualizar']}" actionListener="#{vehiculoBean.updateChecklistLlantas(actionEvent)}" styleClass="btn btn-info"/>

                        </h:panelGrid>
                    </h:form>
                </h:panelGroup>

                <!-- Crear Checklist de llantas -->
                <h:panelGroup  >
                    <h:form  rendered="#{vehiculoBean.checklistLlantas.id == null}">
                        <h:panelGrid  styleClass="bordePanelGrid">
                            <f:facet name="header">
                                <h:outputText value="Checklist Llantas"/>
                            </f:facet>

                            <h:outputLabel value="Condiciones de llantas (%)" />
                            <h:panelGrid columns="2">
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Delantera Izquierda: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="delanteraIzquierda" value="#{vehiculoBean.checklistLlantas.delanteraIzquierda}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="delanteraIzquierda" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Delantera Derecha: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="delanteraDerecha" value="#{vehiculoBean.checklistLlantas.delanteraDerecha}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="delanteraDerecha" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Trasera Izquierda: " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="traseraIzquierda" value="#{vehiculoBean.checklistLlantas.traseraIzquierda}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="traseraIzquierda" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Trasera Derecha " />
                                    <h:outputText value="*" styleClass="textoRojo" />
                                </h:panelGrid>
                                <h:panelGrid columns="3">
                                    <p:inputText id="traseraDerecha" value="#{vehiculoBean.checklistLlantas.traseraDerecha}" required="true" requiredMessage="requerido" >
                                        <f:validateLongRange minimum="1" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="traseraDerecha" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:outputLabel value="Refacción: " />
                                <h:panelGrid columns="3">
                                    <p:inputText id="refaccion" value="#{vehiculoBean.checklistLlantas.refaccion}" >
                                        <f:validateLongRange minimum="0" maximum="100"></f:validateLongRange>
                                    </p:inputText>
                                    <h:outputText value="%" />
                                    <h:message for="refaccion" errorClass="errorMessage" infoClass="infoMessage"/>
                                </h:panelGrid>
                                <h:outputLabel value="Estado general de llantas: " />
                                <p:selectBooleanCheckbox value="#{vehiculoBean.flag}"/>
                                <h:outputLabel value="Comentarios: " />
                                <p:inputTextarea value="#{vehiculoBean.checklistLlantas.observacion}" rows="5" cols="50" />
                            </h:panelGrid>                            

                            <p:commandButton value="#{msgs['sistema.guardar']}" actionListener="#{vehiculoBean.createChecklistLlantas(actionEvent)}" styleClass="btn btn-info"/>

                        </h:panelGrid>
                    </h:form>
                </h:panelGroup>   

                <!-- Agregar Observación a Checklist de Exterior -->
                <h:form id="popupAgregarObservacion" >
                    <p:dialog  header="Agregar Observación" 
                               >
                        <h:panelGrid columns="2" styleClass="bordePanelGrid"  >
                            <h:panelGrid columns="2">
                                <h:outputLabel value="Observación: " />
                                <p:inputText id="observacion" value="#{vehiculoBean.checklistExtVehiculo.siAdjunto.descripcion}" style="width: 200px" styleClass="f11" maxlength="250" />
                            </h:panelGrid>                            
                        </h:panelGrid>
                        <center>
                            <h:panelGrid columns="2">
                                <p:commandButton value="#{msgs['sistema.guardar']}" actionListener="#{vehiculoBean.updateAdjunto(actionEvent)}" styleClass="btn btn-info"/>
                                <p:commandButton value="#{msgs['sistema.cancelar']}" actionListener="#{vehiculoBean.closePopupAddObservacionToChecklistExterior(actionEvent)}" immediate="true" styleClass="btn btn-default"/>        
                            </h:panelGrid>                        
                        </center>
                    </my:panelPopup>
                </h:form> 

                <!-- Modificar Observación a Checklist de Exterior -->
                <h:form id="popupModificarObservacion" >
                    <p:dialog  header="Modificar Observación" 
                               >
                        <h:panelGrid columns="2" styleClass="bordePanelGrid"  >
                            <h:panelGrid columns="2">
                                <h:outputLabel value="Observación: " />
                                <p:inputText id="observacion" value="#{vehiculoBean.checklistExtVehiculo.siAdjunto.descripcion}" style="width: 200px" styleClass="f11" maxlength="250" />
                            </h:panelGrid>                            
                        </h:panelGrid>
                        <center>
                            <h:panelGrid columns="2">
                                <p:commandButton value="#{msgs['sistema.guardar']}" actionListener="#{vehiculoBean.updateAdjunto(actionEvent)}" styleClass="btn btn-info"/>
                                <p:commandButton value="#{msgs['sistema.cancelar']}" actionListener="#{vehiculoBean.closePopupUpdateObservacionToChecklistExterior(actionEvent)}" immediate="true" styleClass="btn btn-default"/>        
                            </h:panelGrid>                        
                        </center>
                    </my:panelPopup>
                </h:form> 
                <!-- Reiniciar kilometraje -->
		<h:form id="popupRestartKilometraje"  >
		    <p:dialog  header="Reiniciar Kilometraje" 
                               >
			<h:panelGrid styleClass="bordePanelGrid"  >
			    <h:outputLabel value="Por favor especifique el motivo por el cual el kilometraje será reiniciado: " />
			    <p:inputTextarea id="kilometraje" value="#{vehiculoBean.mensaje}" rows="5" style="width: 400px"  />
			</h:panelGrid>
			<center>
			    <h:panelGrid columns="2">
				<p:commandButton value="#{msgs['sistema.reiniciar']}" actionListener="#{vehiculoBean.restartKilometrajeVehiculo(actionEvent)}" styleClass="btn btn-info"/>        
				<p:commandButton value="#{msgs['sistema.cancelar']}" actionListener="#{vehiculoBean.closePopupRestartKilometraje(actionEvent)}" styleClass="btn btn-default" immediate="true" />        
			    </h:panelGrid>                        
			</center>
		    </my:panelPopup>                    
		</h:form>

            </ui:define>

        </ui:composition>

    </body>
</html>
