<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"

                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/crud.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="tituloPagina">
        #{msg['sia.inventarios.reportes.movimientos.modulo']}
    </ui:define>
    <ui:define name="titulo">
        #{msg['sia.inventarios.reportes.movimientos.titulo']}
    </ui:define>

    <ui:define name="botones">
        <div class="clearfix">
            <div class="fleft">
                <button type="button" id="btnBuscar" data-icon="ui-icon-search">#{msg['sia.inventarios.comun.buscar']}</button>
            </div>
            <div class="fright">
                <h:commandLink value="#{msg['sia.inventarios.comun.imprimir']}" onclick="window.print();" styleClass="hbutton-imp">
                </h:commandLink>
                <p:commandButton value="Exportar">
                    <p:dataExporter id="dataExporter"  type="csv" target="tablaDatosImprimir" fileName="movimientos" encoding="ISO-8859-1" />          
                </p:commandButton>
            </div>
        </div>
    </ui:define>

    <ui:define name="filtros">
        <h:panelGrid columns="2" width="500px" id="panelFiltro">
            <h:outputText value="#{msg['sia.inventarios.reportes.rango.fecha']}:"/>
            <h:panelGroup styleClass="rango">
                <h:outputText value="#{msg['sia.inventarios.reportes.rango.fecha.entre']}" class="entre"/>
                <p:datePicker id="dtFechaInicio"
                              value="#{historialMovimientos.filtro.fechaInicio}"
                              pattern="dd/MM/yyyy"
                              validator="#{historialMovimientos.fechaValidador}"
                              styleClass="campo"/>
                <h:outputText value="#{msg['sia.inventarios.reportes.rango.fecha.y']}" class="separador"/>
                <p:datePicker id="dtFechaFin"
                              value="#{historialMovimientos.filtro.fechaFin}"
                              pattern="dd/MM/yyyy"
                              styleClass="campo"/>
            </h:panelGroup>
            <h:outputText value="#{msg['sia.inventarios.movimientos.almacenOrigen']}:"/>
            <h:selectOneMenu id="smFiltroAlmacen" value="#{historialMovimientos.filtro.almacenId}" styleClass="ui-widget ui-inputfield ui-state-default ui-state-optional">
                <f:selectItem itemLabel="#{msg['sia.inventarios.comun.seleccione']}" itemValue="#{null}" noSelectionOption="true" />
                <f:selectItems value="#{historialMovimientos.almacenes}" var="a" itemLabel="#{a.nombre}" itemValue="#{a.id}"/>
            </h:selectOneMenu>
            <h:outputText value="#{msg['sia.inventarios.movimientos.estatus']}:"/>
            <h:selectOneMenu id="smFiltroEstatus" value="#{historialMovimientos.filtro.status}" styleClass="ui-widget ui-inputfield ui-state-default ui-state-optional">
                <f:selectItem itemLabel="#{msg['sia.inventarios.comun.seleccione']}" itemValue="#{null}" noSelectionOption="true" />
                <f:selectItems value="#{estatusMovimiento.estatus}"/>
            </h:selectOneMenu>
            <h:outputText value="#{msg['sia.inventarios.comun.usuario']}:" />
            <h:selectOneMenu id="smFiltroGenero" value="#{historialMovimientos.filtro.generoId}" styleClass="ui-widget ui-inputfield ui-state-default ui-state-optional">
                <f:selectItem itemLabel="#{msg['sia.inventarios.comun.seleccione']}" itemValue="#{null}"/>
                <f:selectItems value="#{historialMovimientos.usuarios}" var="u" itemLabel="#{u.nombre}" itemValue="#{u.id}"/>
            </h:selectOneMenu>
            <h:outputText value="#{msg['sia.inventarios.movimientos.numeroRegistros']}:" />
            <h:selectOneMenu id="smFiltroNumeroRegistros" value="#{historialMovimientos.tamanioPagina}" styleClass="ui-widget ui-inputfield ui-state-default ui-state-optional">
                <f:selectItem itemLabel="50" itemValue="50" />
                <f:selectItem itemLabel="100" itemValue="100" />
                <f:selectItem itemLabel="200" itemValue="200" />
                <f:selectItem itemLabel="500" itemValue="500" />
            </h:selectOneMenu>
        </h:panelGrid>
        <div class="filtro-butones">
            <h:commandLink  value="#{msg['sia.inventarios.inventarios.buscar']}" actionListener="#{historialMovimientos.buscar}" styleClass="hbutton-bu">
                <f:ajax execute="panelFiltro" render="@all"/>
            </h:commandLink>
            <h:commandLink value="#{msg['sia.inventarios.comun.reestablecer']}" actionListener="#{historialMovimientos.reestablecer}" styleClass="hbutton-re">
                <f:ajax execute="panelFiltro" render="@all"/>
            </h:commandLink>
        </div>
    </ui:define>

    <ui:define name="tabla">        
        <p:dataTable id="tablaDatosImprimir"
                     value="#{historialMovimientos.listaImprimir}"
                     var="m"
                     style="width: 100%;">
            <p:column id="id" headerText="#{msg['sia.inventarios.movimientos.fechaMovimiento']}" sortBy="#{m.fecha}" style="width: 150px">
                <h:outputText value="#{m.fecha}">
                    <f:convertDateTime pattern="dd/MM/yyyy HH:mm a"/>
                </h:outputText>
            </p:column>
            <p:column id="fechaRegistro" headerText="#{msg['sia.inventarios.comun.fechaRegistro']}" sortBy="#{m.fecha}" style="width: 200px">
                <h:outputText value="#{m.fechaGenero}">
                    <f:convertDateTime pattern="dd/MM/yyyy HH:mm a"/>
                </h:outputText>
            </p:column>
            <p:column id="codigo" headerText="#{msg['sia.inventarios.movimientos.almacenOrigen']}" sortBy="#{m.almacenNombre}" style="width: 250px">
                <h:outputText value="#{m.almacenNombre}"/>
            </p:column>
            <p:column id="nombre" headerText="#{msg['sia.inventarios.movimientos.tipoMovimiento']}" sortBy="#{m.tipoMovimiento}" style="width: 200px">
                <h:outputText value="#{tipoMovimiento.getNombre(m.tipoMovimiento)}"/>
            </p:column>
            <p:column id="descripcion" headerText="#{msg['sia.inventarios.movimientos.observaciones']}" sortBy="#{m.notas}" style="width: 300px">
                <h:outputText value="#{m.notas}"/>
            </p:column>
            <p:column id="unidad" headerText="#{msg['sia.inventarios.movimientos.numeroArticulos']}" sortBy="#{m.numeroArticulos}" style="width: 100px">
                <h:outputText value="#{m.numeroArticulos}"/>
            </p:column>
            <p:column id="status" headerText="#{msg['sia.inventarios.movimientos.estatus']}" sortBy="#{m.status}" style="width: 100px">
                <h:outputText value="#{estatusMovimiento.getNombreEstatus(m.status)}"/>
            </p:column>
        </p:dataTable>
        <h:outputText id="txtMensaje" value="#{historialMovimientos.mensaje}" styleClass="mensajePaginacion"/>
    </ui:define>
</ui:composition>
