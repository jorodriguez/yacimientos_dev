<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                >
    <div class="row">
        <p:panel  >
            <h:outputText value="#{msgs['sistema.fecha.inicio']}"/>        
            <p:datePicker value="#{reporteBean.inicio}" pattern="dd/MM/yyyy"/>
            <h:outputText value="#{msgs['sistema.fecha.fin']}" />
            <p:datePicker value="#{reporteBean.fin}" pattern="dd/MM/yyyy"/>
        </p:panel>
        <p:panel >
            <h:selectOneRadio  value="#{reporteBean.conContrato}" >
                <f:selectItem itemValue="Si" itemLabel="Con contrato"/>
                <f:selectItem itemValue="No" itemLabel="Sin contrato"/>
            </h:selectOneRadio>
        </p:panel>
        <p:panel> 
            <h:selectOneRadio id="radioMoneda" value="#{reporteBean.idMoneda}" >
                <f:selectItems value="#{reporteBean.listaMoneda}"/>
            </h:selectOneRadio>            
        </p:panel>
        <p:commandLink value="#{msgs['sistema.buscar']}" 
                       action="#{reporteBean.traerOCSProveedorContrato}"
                       styleClass="btn btn-sm btn-primary"
                       process="frmRep:tbReportes" update="frmRep:tbReportes:dtCompraPorStatus:dtProveedorCont"/>
    </div>
    <p:dataTable size="small" stripedRows="true" showGridlines="true" id="dtProveedorCont" value="#{reporteBean.lista}" var="data"
                 rows="20" styleClass="dataPaginatorDataTable" 
                 paginator="true"  
                 paginatorPosition="bottom" 
                 style="font-size: 1em; width: 80%" >
        <p:column id="exp">
            <p:rowToggler/>
        </p:column>
        <p:column headerText="#{msgs['orden.proveedor']}" style="text-align: left;">
            <h:outputText value="#{data.proveedor}"/>
        </p:column>
        <p:column headerText="Ordenes">
            <h:outputText value="#{data.totalOrdenes}"/>
        </p:column>
        <p:column headerText="#{msgs['orden.subtotal']}" style="text-align: right; width: 13%;">
            <h:outputText value="#{data.subTotal}">
                <f:convertNumber pattern="$ #,##0.0000" locale="es-MX"/>
            </h:outputText>
        </p:column>
        <p:column headerText="IVA" style="text-align: right; width: 12%;">
            <h:outputText value="#{data.iva}">
                <f:convertNumber pattern="$ #,##0.00" locale="es-MX"/>
            </h:outputText>
        </p:column>
        <p:column headerText="Total" style="text-align: right; width: 13%;">
            <h:outputText value="#{data.total}">
                <f:convertNumber pattern="$ #,##0.0000" locale="es-MX"/>
            </h:outputText>
        </p:column>
        <p:column headerText="Moneda" style="text-align: right;">
            <h:outputText value="#{data.moneda}"/>
        </p:column> 
        <p:rowExpansion >
            <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{data.listaOrden}" var="lo">
                <h:column >
                    <f:facet name="header">Requisici√≥n</f:facet>
                    <h:outputText value="#{lo.requisicion}"/>
                </h:column>
                <h:column >
                    <f:facet name="header">Consecutivo</f:facet>
                    <h:outputText value="#{lo.consecutivo}"/>
                </h:column>
                <h:column >
                    <f:facet name="header">Comprador</f:facet>
                    <h:outputText value="#{lo.analista}"/>
                </h:column>
                <h:column >
                    <f:facet name="header">Referencia</f:facet>
                    <h:outputText value="#{lo.referencia}"/>
                </h:column>
                <h:column >
                    <f:facet name="header">Solicitada</f:facet>
                    <h:outputText value="#{lo.fechaSolicita}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </h:column>
                <h:column >
                    <f:facet name="header">Estado</f:facet>
                    <h:outputText value="#{lo.estatus}"/>
                </h:column>
                <h:column >
                    <f:facet name="header">SubTotal</f:facet>
                    <h:outputText value="#{lo.subTotal}">
                        <f:convertNumber maxFractionDigits="2"/>
                    </h:outputText>
                </h:column>
                <h:column >
                    <f:facet name="header">I.V.A.</f:facet>
                    <h:outputText value="#{lo.iva}">
                        <f:convertNumber maxFractionDigits="2"/>
                    </h:outputText>
                </h:column>
                <h:column >
                    <f:facet name="header">Total</f:facet>
                    <h:outputText value="#{lo.total}">
                        <f:convertNumber maxFractionDigits="2"/>
                    </h:outputText>
                </h:column>
            </p:dataTable>
        </p:rowExpansion>
    </p:dataTable>

    <p:commandButton value="Exportar" styleClass="p-mr-2 p-mb-2"> 
        <p:dataExporter fileName="Proveedor" type="xls" target="frmRep:tbReportes:dtProveedorCont" />
    </p:commandButton>
</ui:composition>
