<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                >
    <p:panel  id="pnlProvs">
        <h:panelGrid columns="2" >
            <h:panelGrid columns="4"  cellspacing="2" cellpadding="2">
                <h:outputText value="#{msgs['sistema.fecha.inicio']}"/>        
                <h:outputText value="#{msgs['sistema.fecha.fin']}" />
                <h:outputText value="Contrato" />
                <h:outputText value="Moneda" />
                <p:datePicker value="#{reporteBean.inicio}" pattern="dd/MM/yyyy"/>
                <p:datePicker value="#{reporteBean.fin}" pattern="dd/MM/yyyy"/>
                <h:selectOneRadio  value="#{reporteBean.conContrato}" >
                    <f:selectItem itemValue="Si" itemLabel="Si"/>
                    <f:selectItem itemValue="No" itemLabel="No"/>
                </h:selectOneRadio>
                <h:selectOneRadio id="radioMoneda" value="#{reporteBean.idMoneda}" >
                    <f:selectItems value="#{reporteBean.listaMoneda}"/>
                </h:selectOneRadio>  
            </h:panelGrid>
            <p:commandLink value="#{msgs['sistema.buscar']}" 
                           action="#{reporteBean.traerOCSProveedorContrato}"
                           styleClass="btn btn-sm btn-primary text-white"
                           process="@this frmRep:tbReportes:pnlProvs" update="frmRep:tbReportes:dtProveedorCont"/>          
        </h:panelGrid>
    </p:panel>
    <p:dataTable size="small" stripedRows="true" showGridlines="true" id="dtProveedorCont" value="#{reporteBean.lista}" var="data"
                 rows="20" 
                 paginator="true"  
                 paginatorPosition="bottom"  rowKey="#{data.idProveedor}">
        <p:column id="exp" width="25">
            <p:rowToggler/>
        </p:column>
        <p:column headerText="#{msgs['orden.proveedor']}" style="text-align: left;">
            <h:outputText value="#{data.proveedor}"/>
        </p:column>
        <p:column headerText="Ordenes" width="40" > 
            <h:outputText value="#{data.totalOrdenes}"/>
        </p:column>
        <p:column headerText="#{msgs['orden.subtotal']}" style="text-align: right; width: 13%;">
            <h:outputText value="#{data.subTotal}">
                <f:convertNumber pattern="$ #,##0.0000" locale="es-MX"/>
            </h:outputText>
        </p:column>
        <p:column headerText="IVA" style="text-align: right; width: 12%;">
            <h:outputText value="#{data.iva}">
                <f:convertNumber pattern="$ #,##0.00" locale="es-MX"/>
            </h:outputText>
        </p:column>
        <p:column headerText="Total" style="text-align: right; width: 13%;">
            <h:outputText value="#{data.total}">
                <f:convertNumber pattern="$ #,##0.0000" locale="es-MX"/>
            </h:outputText>
        </p:column>
        <p:column headerText="Moneda" style="text-align: right;">
            <h:outputText value="#{data.moneda}"/>
        </p:column> 
        <p:rowExpansion >
            <p:dataTable size="small" stripedRows="true" showGridlines="true"  value="#{data.listaOrden}" var="lo"
                         >
                <p:column >
                    <f:facet name="header">Requisici√≥n</f:facet>
                    <h:outputText value="#{lo.requisicion}"/>
                </p:column>
                <p:column >
                    <f:facet name="header">Consecutivo</f:facet>
                    <h:outputText value="#{lo.consecutivo}"/>
                </p:column>
                <p:column >
                    <f:facet name="header">Comprador</f:facet>
                    <h:outputText value="#{lo.analista}"/>
                </p:column>
                <p:column >
                    <f:facet name="header">Referencia</f:facet>
                    <h:outputText value="#{lo.referencia}"/>
                </p:column>
                <p:column >
                    <f:facet name="header">Solicitada</f:facet>
                    <h:outputText value="#{lo.fechaSolicita}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>
                <p:column >
                    <f:facet name="header">Estado</f:facet>
                    <h:outputText value="#{lo.estatus}"/>
                </p:column>
                <p:column >
                    <f:facet name="header">SubTotal</f:facet>
                    <h:outputText value="#{lo.subTotal}">
                        <f:convertNumber maxFractionDigits="2"/>
                    </h:outputText>
                </p:column>
                <p:column >
                    <f:facet name="header">I.V.A.</f:facet>
                    <h:outputText value="#{lo.iva}">
                        <f:convertNumber maxFractionDigits="2"/>
                    </h:outputText>
                </p:column>
                <p:column >
                    <f:facet name="header">Total</f:facet>
                    <h:outputText value="#{lo.total}">
                        <f:convertNumber maxFractionDigits="2"/>
                    </h:outputText>
                </p:column>
            </p:dataTable>
        </p:rowExpansion>
    </p:dataTable>

    <p:commandButton value="Exportar" styleClass="p-mr-2 p-mb-2" process="@this frmRep:tbReportes:dtProveedorCont"> 
        <p:dataExporter fileName="Proveedor" type="xls" target="frmRep:tbReportes:dtProveedorCont" />
    </p:commandButton>
</ui:composition>
