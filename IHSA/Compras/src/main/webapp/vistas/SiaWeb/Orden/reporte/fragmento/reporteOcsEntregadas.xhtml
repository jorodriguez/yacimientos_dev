<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                >    
    <p:panel id="pnlRec">
        <p:selectOneRadio value="#{reporteBean.opcioSeleccionada}">
            <f:selectItem itemLabel="En proceso de aprobación" itemValue="1"/>
            <f:selectItem itemLabel="Enviada a proveedor" itemValue="2"/>
        </p:selectOneRadio>
        <p:datePicker value="#{reporteBean.inicio}" pattern="dd/MM/yyyy"/>
        <p:commandLink value="Buscar" action="#{reporteBean.buscarOcsEntregadas}" styleClass="btn btn-primary btn-sm text-white"
                       process="@this frmRep:tbReportes:pnlRec"
                       update="frmRep:tbReportes:dtCompraEnt"/>
    </p:panel>
    <div class="row">
        <p:dataTable size="small" stripedRows="true" showGridlines="true" id="dtCompraEnt" value="#{reporteBean.lista}" var="data"
                     rows="10"  paginator="true"  
                     paginatorPosition="bottom"  >
            <f:facet name="header"><h5>Oc/s pendientes de recibir</h5></f:facet>            
            <p:column headerText="Req." style="text-align: left;">
                <h:outputText value="#{data.requisicion}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }"/>
            </p:column>            
            <p:column headerText="OC/S" style="text-align: left;">
                <h:outputText value="#{data.consecutivo}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }"/>
            </p:column>            
            <p:column headerText="Analista" style="text-align: left;">
                <h:outputText value="#{data.analista}" 
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }"/>
            </p:column>
            <p:column headerText="#{msgs['orden.gerencia.nombre']}" style="text-align: left;"
                      >
                <h:outputText value="#{data.gerencia}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }"/>
            </p:column>
            <p:column headerText="#{msgs['requisicion.referencia']}" style="text-align: left;">
                <h:outputText value="#{data.referencia}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }"/>
            </p:column>
            <p:column headerText="#{msgs['orden.proveedor']}" style="text-align: left;">
                <h:outputText value="#{data.proveedor}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }"/>
            </p:column>
            <p:column headerText="#{msgs['requisicion.solicito']}" style="text-align: left;">
                <h:outputText value="#{data.fechaSolicita}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }">
                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                </h:outputText>
            </p:column>
            <p:column headerText="Autorizada" style="text-align: left;">
                <h:outputText value="#{data.fechaAutoriza}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }">
                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                </h:outputText>
            </p:column>
            <p:column headerText="Entrega estimada" style="text-align: left;">
                <h:outputText value="#{data.fechaEntrega}" 
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }">
                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                </h:outputText>
            </p:column>                   
            <p:column headerText="Recibido" style="text-align: left;">
                <h:outputText value="#{data.totalRecibidos}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }">
                    <f:convertNumber maxFractionDigits="2"/>
                </h:outputText>/
                <h:outputText value="#{data.totalItems}"
                              style="color: #{((data.totalRecibidos lt data.totalItems) and data.totalRecibidos gt 0) ? 'orange' : '' }">
                    <f:convertNumber maxFractionDigits="2"/>
                </h:outputText>
            </p:column>                         
            <p:column headerText="Días" style="text-align: left;">
                <h:outputText value="#{data.diasEntrega}"
                              style="color: #{data.diasEntrega lt 0 ? 'red' : '' }">
                </h:outputText>
            </p:column>
        </p:dataTable>

        <p:commandButton value="Exportar" styleClass="p-mr-2 p-mb-2" process="@this frmRep:tbReportes:dtCompraEnt"> 
            <p:dataExporter fileName="OcsEntregada" type="xls" target="dtCompraEnt" />
        </p:commandButton>
    </div>
    <div class="row">
        <font style="color: orange">* Recepción parcial</font>
    </div>
</ui:composition>