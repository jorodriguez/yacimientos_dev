<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:ice="http://www.icesoft.com/icefaces/component"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui">
    <h:form id="frmMensaje">
        <div class="modal fade" data-backdrop="static" id="dialogoMensaje" data-keyboard="false" style="overflow-y: scroll;">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Bienvenido </h4>
                    </div>
                    <div class="modal-body">
                        <div class="panel panel-default">
                            <div class="row-fluid">
                                <b>Seleccione la compañia</b>
                            </div>
                            <div class="row-fluid">
                                <h:selectOneMenu value="#{sesion.rfcCompania}" class="form-control">
                                    <f:selectItems value="#{sesion.empresas}"/> 
                                    <f:ajax listener="#{sesion.seleccionarEmpresa}" render="@this lblReq"/>
                                </h:selectOneMenu>
                            </div>
                        </div>
                        <div >
                            <div class="panel panel-primary">
                                <div class="panel-heading">                                    
                                    Recepción de facturas
                                </div>
                                <div class="panel-body">
                                    <h:outputLabel id="lblReq" value="#{sesion.companiaVoSesion.requisitoFactura}"
                                                   escape="false"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group col-lg-12">
                                    <div class="col-lg-1">
                                        <h:selectBooleanCheckbox id="checkAcepto"  class="form-control" 
                                                                 onclick="entendido(this, 'divEntendido');">
                                            <f:ajax render="@this btnEntendido"/>
                                        </h:selectBooleanCheckbox>
                                    </div>
                                    <div class="col-lg-10">
                                        <label for="checkAcepto">He leido y acepto las condiciones de recepción de facturas mostradas en está ventana y en la Orden de Compra.</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div id="divEntendido" style="display: none;">
                            <h:commandLink id="btnEntendido" class="btn btn-primary" value="Entendido" 
                                           action="#{sesion.irPrincipalFactura()}"></h:commandLink>
                        </div>
                    </div>
                </div>
            </div>
        </div>        
    </h:form>
    <h:form id="frmMensajePrincipal">
        <div class="modal fade" data-backdrop="static" id="dialogoMensajePrincipal" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Cambio de empresa </h4>
                    </div>
                    <div class="modal-body">                        
                        <div >
                            <div class="panel panel-primary">
                                <div class="panel-heading">                                    
                                    <b>#{sesion.companiaVoSesion.nombre}</b>
                                </div>
                                <div class="panel-body">
                                    <h:outputLabel id="lblReqPrin" value="#{sesion.companiaVoSesion.requisitoFactura}"
                                                   escape="false"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-group col-lg-12">
                                    <div class="col-lg-1">
                                        <h:selectBooleanCheckbox id="checkAceptoPrin"  class="form-control" 
                                                                 onclick="entendido(this, 'divEntendidoPrin');">
                                            <f:ajax render="@this btnEntendidoPrin"/>
                                        </h:selectBooleanCheckbox>
                                    </div>
                                    <div class="col-lg-10">
                                        <label for="checkAcepto">He leido y acepto las condiciones de recepción de facturas mostradas en está ventana y en la Orden de Compra.</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div id="divEntendidoPrin" style="display: none;">
                            <h:commandLink id="btnEntendidoPrin" class="btn btn-primary" value="Entendido" 
                                           action="#{proveedorBean.refrescarPrincipalFactura()}">
                            </h:commandLink>
                        </div>
                    </div>
                </div>
            </div>
        </div>        
    </h:form>

    <div class="modal fade" data-backdrop="static" id="dialogoMensajeArchivo" data-keyboard="false">
        <h:form id="frmMensajeArchivos">        
            <div class="modal-dialog" style="width: 90%; height: 90%">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Carga de archivos requeridos </h4>
                    </div>
                    <div class="modal-body">                        
                        <div >
                            <div class="panel panel-primary">
                                <div class="panel-heading">                                    
                                    <b>Proveedor #{sesion.proveedorVo.nombre}</b>
                                </div>
                                <div class="panel-body">

                                    <div class="col-lg-12 col-xs-12">
                                        <div class="input-group col-lg-12 col-xs-12">                                

                                            <p align="right" style="margin-left: -0.5cm; margin-bottom: 0cm">
                                                <span lang="es-ES">21 de Junio de 2021</span></p>
                                            <p align="center" style="margin-left: -0.5cm; margin-bottom: 0cm"><font size="4" style="font-size: 14pt"><span lang="es-ES"><b>CIRCULAR
                                                            GRUPO COBRA</b></span></font></p>
                                            <p lang="es-ES" style="margin-left: -0.5cm; margin-bottom: 0cm"><br/>

                                            </p>
                                            <p align="right" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">Referencia:
                                                    Decreto en materia de Subcontratación (DOF de 23/04/2021)</span></p>
                                            <p style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">Estimado
                                                    colaborador: </span>
                                            </p>
                                            <p align="justify" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">En
                                                    relación con el contrato o contratos que tengan celebrado con
                                                    nosotros y/o cualquier sociedad del [Grupo Cobra], por medio del
                                                    presente me permito informarle que, derivado de la publicación el
                                                    pasado 23 de abril en el Diario Oficial de la Federación del Decreto
                                                    en materia de Subcontratación Laboral<a class="sdfootnoteanc" name="sdfootnote1anc" href="#sdfootnote1sym"><sup>1</sup></a>,
                                                    será necesario efectuar diversas modificaciones contractuales con el
                                                    objetivo de adaptarse a esta normativa. </span>
                                            </p>
                                            <p align="justify" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">En
                                                    este sentido, les rogamos que en el </span><span lang="es-ES"><b>plazo
                                                        improrrogable de los próximos 5 días</b></span><span lang="es-ES">
                                                    nos haga llegar </span>
                                            </p>
                                            <ul>
                                                <li><p align="justify" style="margin-bottom: 0.28cm"><span lang="es-ES">Los
                                                        </span><span lang="es-ES"><u>estatutos sociales vigentes</u></span><span lang="es-ES">
                                                            en los que conste su objeto social actual. </span>
                                                    </p>
                                                </li>
                                                <li><p align="justify" style="margin-bottom: 0.28cm"><span lang="es-ES">Su
                                                        </span><span lang="es-ES"><u>actividad preponderante.</u></span></p>
                                                </li>
                                                <li><p align="justify" style="margin-bottom: 0.28cm"><span lang="es-ES">Documentación
                                                            justificativa en caso de contar con la</span><span lang="es-ES"><u>
                                                                acreditación de Servicio Especializado</u></span></p>
                                                </li>
                                            </ul>
                                            <p align="justify" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">El
                                                    envío de dicha documentación se efectuará del modo siguiente en el
                                                    PORTAL DEL PROVEEDOR que está habilitado. Los archivos deberán ser
                                                    nombrados de la siguiente manera: </span>
                                            </p>
                                            <p align="center" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">RFCProveedor-Código
                                                    documento (dependiendo del documento que se esté incluyendo como se
                                                    describe a continuación): </span>
                                            </p>
                                            <ul>
                                                <ul>
                                                    <li><p align="justify" style="margin-bottom: 0.28cm"><span lang="es-ES">ESV-->
                                                            </span><span lang="es-ES"><u>Los estatutos sociales vigentes</u></span></p>
                                                    </li>
                                                    <li><p align="justify" style="margin-bottom: 0.28cm"><span lang="es-ES">AP -->
                                                            </span><span lang="es-ES"><u>Actividad preponderante (documento
                                                                    libre)</u></span></p>
                                                    </li>
                                                    <li><p align="justify" style="margin-bottom: 0.28cm"><span lang="es-ES">SE -->
                                                            </span><span lang="es-ES">
                                                                Servicio Especializado (en caso de registro)</span></p>
                                                    </li>
                                                </ul>
                                            </ul>
                                            <p align="justify" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">La
                                                    aportación de dicha documentación en el plazo indicado se enmarca
                                                    en los análisis que Grupo Cobra y sus subsidiarias efectúa para
                                                    la adaptación de la Ley de Subcontratación y las adaptaciones a la
                                                    documentación contractual que tengan con cualquiera de las
                                                    sociedades de nuestro Grupo.</span></p>
                                            <p align="justify" style="margin-left: -0.5cm; margin-bottom: 0cm"><span lang="es-ES">La
                                                    falta de aportación de la documentación solicitada determinará la
                                                </span><span lang="es-ES"><b>suspensión de cualquier pago</b></span><span lang="es-ES">.
                                                    Idéntica consecuencia procederá en los casos en los que, antes del
                                                    01 de agosto de 2021, no se nos haya notificado debidamente el </span><span lang="es-ES"><b>Número
                                                        de registro como prestador de servicios especializados u obras
                                                        especializadas (REPSE)</b></span><span lang="es-ES">, cuando fuera de
                                                    aplicación.</span></p>
                                            <p lang="es-ES" align="justify" style="margin-left: -0.5cm; margin-bottom: 0cm">
                                                <br/>

                                            </p>
                                            <p style="margin-bottom: 0cm"><span lang="es-ES">Atentamente,</span></p>
                                            <p style="margin-bottom: 0cm; margin-left: 50px;"><span lang="es-ES"><b>          Grupo Cobra</b></span></p>
                                            <p lang="es-ES" style="margin-bottom: 0cm"><br/>
                                            </p>                                            
                                            <div id="sdfootnote1"><p class="sdfootnote"><a class="sdfootnotesym" name="sdfootnote1sym" href="#sdfootnote1anc">1</a>
                                                    <font color="#2f2f2f"><font face="Arial, serif"><font size="1" style="font-size: 8pt"><b><span style="background: #ffffff">Artículo
                                                                        13 de la Ley Federal del Trabajo: </span></b></font></font></font><font size="1" style="font-size: 8pt"><span lang="es-ES">“</span></font><font size="1" style="font-size: 8pt"><span lang="es-ES"><i>Se
                                                                permite la subcontratación de servicios especializados o de
                                                                ejecución de obras especializadas que no formen parte del
                                                                objeto social ni de la actividad económica preponderante de
                                                                la beneficiaria de estos, siempre que el contratista esté
                                                                registrado en el padrón público a que se refiere el artículo
                                                                15 de esta Ley</i></span></font><font size="1" style="font-size: 8pt"><span lang="es-ES">.”</span></font></p>
                                            </div> 


                                        </div>
                                    </div>

                                    <div class="col-lg-12 col-xs-12">
                                        <div class="input-group col-lg-12 col-xs-12">                                
                                            <div class="table table-responsive" style="margin-bottom: 0px;">
                                                <ice:dataTable rows="10" 
                                                               value="#{sesion.proveedorVo.lstDocsPortal}" var="currentRow" styleClass="table table-striped"
                                                               style="font-size:12px; color: black;">
                                                    <ice:column style="width: 5%">
                                                        <button type="button" class="btn btn-info"
                                                                title="#{currentRow.ayuda}">
                                                            <i class="glyphicon glyphicon-question-sign"></i>
                                                        </button>                                                        
                                                    </ice:column>
                                                    <ice:column style="width: 45%">                                                        
                                                        <ice:outputText value="#{currentRow.documento}"/>
                                                        <f:facet name="header">
                                                            <ice:outputText value="Archivo"/>
                                                        </f:facet>
                                                    </ice:column>
                                                    <ice:column style="width: 30%">
                                                        <ice:outputText rendered="#{currentRow.id gt 0}" value="Ya fue cargado el archivo"/>
                                                        <ice:outputText rendered="#{currentRow.id lt 1 and currentRow.obligatoria}" value="*El archivo es requerido"/>                                            
                                                        <ice:outputText rendered="#{currentRow.id lt 1 and !currentRow.obligatoria}" value="Favor de cargar el archivo"/>                                            
                                                    </ice:column> 
                                                    <ice:column style="width: 20%">
                                                        <ice:commandLink 
                                                            rendered="#{currentRow.id gt 0}"
                                                            styleClass="btn btn-danger btn-sm"  
                                                            actionListener="#{proveedorBean.borrarArchivoPortal(event)}"
                                                            title="Click aquí para eliminar archivo..." >
                                                            <i class="glyphicon glyphicon-trash"></i>                                                
                                                            <f:param name="idDoc" value="#{currentRow.id}"/>                                                            
                                                            <f:param name="tipoUUID" value="#{currentRow.adjuntoVO.uuid}"/>
                                                        </ice:commandLink>                                                        
                                                        <ice:commandLink 
                                                            rendered="#{currentRow.id lt 1}"
                                                            styleClass="btn btn-info btn-sm"  
                                                            actionListener="#{proveedorBean.agregarArchivoPortal(event)}"
                                                            title="Click aquí para cargar archivo..." >
                                                            <i class="glyphicon glyphicon-open"></i>                                                
                                                            <f:param name="idDoc" value="#{currentRow.idDocumento}"/>
                                                            <f:param name="tipoDoc" value="#{currentRow.adjuntoVO.tipoArchivo}"/>
                                                        </ice:commandLink>                                                        
                                                    </ice:column>					
                                                </ice:dataTable>

                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="modal-footer">
                        <div id="divLogOutArchivos">
                            <h:commandLink title="Salir del portal de proveedores" 
                                           action="/principal"
                                           id="linkLogout"
                                           value="Salir del portal de proveedores"
                                           actionListener="#{sesion.cerrarSesion(event)}">                                            
                            </h:commandLink>
                        </div>
                    </div>
                </div>
            </div>                
        </h:form>
    </div>

    <!-- Modal Panel Popup agergar archivos -->
    <div class="modal fade" id="adjuntarArchivoPortal" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Agregar archivo</h4>
                </div>
                <h:form id="frmArchivo">
                    <div class="modal-body panel-body">
                        <div class="input-group">
                            <div class="form-group col-lg-12">
                                <p:fileUpload  styleClass="form-control"
                                                id="fileEntryDoc22"                                                
                                                label="Archivo "
                                                listener="#{proveedorBean.subirArchivoPortal}"
                                                /> 
                                <h:message for="fileEntryDoc22" infoStyle="display:none" />

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <h:commandButton value="Cargar archivo" 
                                         styleClass="col-lg-3 col-xs-12 btn btn-info"
                                         onclick="$(adjuntarArchivo).modal('hide');"/>
                        <h:commandButton id="btnCerrar" value="Cancelar" class="btn btn-default"
                                         onclick="$(adjuntarArchivoPortal).modal('hide');"/>                        
                    </div>
                </h:form>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function entendido(chkAcepto, divEntendido) {
            if ($(chkAcepto).is(':checked')) {
                //
                $("#" + divEntendido).css({"display": "block"});
            } else {
                $("#" + divEntendido).css({"display": "none"});
            }
        }
    </script>
</ui:composition>
