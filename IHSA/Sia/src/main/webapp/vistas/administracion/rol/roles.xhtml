<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"    
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"  

      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:my="http://www.mytags.com/schema/mytags">

    <body>

        <ui:composition template="./../../../WEB-INF/facelets/templates/templateGrupos.xhtml">
            <ui:define name="tituloPagina" >
                Administración de roles
            </ui:define>
            <ui:define name="contenido" >
                <h:form  id="frmUser"  >
                    <p:dataTable id="dtUser" size="small" showGridlines="true"
                                 rows="10" value="#{usuarioBean.listaRoles}" 
                                 paginator="true">

                        <f:facet name="header"><h:outputText value="Lista de Roles"/></f:facet>
                        <p:column>
                            <f:facet name="header"><h:outputText value="Nombre"/></f:facet>
                            <h:outputText value="#{data.nombre}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header"><h:outputText value="Modulo"/></f:facet>
                            <h:outputText value="#{data.modulo}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header"><h:outputText value="Opciones"/></f:facet>
                            <h:outputText value="#{data.opciones}"/>
                        </p:column>
                        <p:column width="50">
                            <p:commandLink value="#{msgs['sistema.agregar.roles']}" 
                                           title="#{msgs['sistema.agregar.roles']}"                       
                                           action="#{usuarioBean.openAgregarRoles}"                                                              
                                           styleClass="link">            
                                <f:param name="id" value="#{data.id}"/>
                            </p:commandLink>
                        </p:column>
                        <p:column width="80">
                            <p:commandLink value="#{msgs['sistema.agregar.opcion']}" 
                                           title="#{msgs['sistema.agregar.opcion']}"                       
                                           action="#{usuarioBean.openPopupAgregarOpcionesRol}"                                                              
                                           styleClass="link">            
                                <f:param name="id" value="#{data.id}"/>
                            </p:commandLink>
                        </p:column>
                    </p:dataTable>
                </h:form>

                <h:form id="popupOpcionesRoles"  >
                    <p:dialog widgetVar="dlgOpciones">
                        <p:dataTable  id="dtRolesOpciones"
                                      rows="10" value="#{usuarioBean.listaOpciones}" 
                                      paginator="true">
                            <f:facet name="header"><h:outputText value="Lista de Opciones"/></f:facet>
                            <p:column>
                                <f:facet name="header"><h:outputText value="Opción Padre"/></f:facet>
                                <h:outputText value="#{data.padre}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header"><h:outputText value="Opción"/></f:facet>
                                <h:outputText value="#{data.nombre}"/>
                            </p:column>
                            <p:column width="80">
                                <p:commandLink 
                                    value="#{msgs['presupuesto.nuevos.eliminar']}" 
                                    title="#{msgs['presupuesto.nuevos.eliminar']}"
                                    action="#{usuarioBean.quitarOpcionRol}">
                                </p:commandLink>
                            </p:column>
                        </p:dataTable>
                        <f:facet name="footer">
                            <p:commandLink value="#{msgs['sistema.cancelar']}" 
                                           onclick="PF('dlgOpciones').hide()"
                                           styleClass="btn btn-default" immediate="true" />        
                        </f:facet>
                    </p:dialog>
                </h:form>  

                <h:form id="popupAgregarOpcionesRoles"  >
                    <p:dialog widgetVar="dlgListaOpciones" header="Opciones">
                        <p:dataTable id="dtRolesOpciones"
                                     rows="10" value="#{usuarioBean.listaOpciones}" 
                                     paginator="true">

                            <f:facet name="header"><h:outputText value="Lista de Opciones"/></f:facet>
                            <p:column>
                                <f:facet name="header"><h:outputText value="Opción Padre"/></f:facet>
                                <h:outputText value="#{data.padre}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header"><h:outputText value="Opción"/></f:facet>
                                <h:outputText value="#{data.nombre}"/>
                            </p:column>
                            <p:column>
                                <p:commandLink 
                                    value="#{msgs['sia.agregar']}" 
                                    title="#{msgs['sia.agregar']}"
                                    action="#{usuarioBean.agregarOpcionRol}">

                                </p:commandLink> 
                            </p:column>
                        </p:dataTable>
                        <f:facet name="footer">
                            <p:commandLink value="#{msgs['sistema.cancelar']}"
                                           onclick="PF('dlgListaOpciones').hide()"
                                           styleClass="btn btn-default" immediate="true" />        
                        </f:facet>
                    </p:dialog>
                </h:form>  
            </ui:define>

        </ui:composition>

    </body>
</html>
