<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"    
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"  
      
      xmlns:my="http://www.mytags.com/schema/mytags"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <body>

        <ui:composition template="./../../../WEB-INF/facelets/templates/templateGrupos.xhtml">
	    <ui:define name="contenido">
		<div id="page">
		    <div class="row"> 
			<h:form   id="frmUserCampo">
			    <div class="col-lg-12">
				<div class="col-lg-4"></div>
				<div class="col-lg-6">
				    <h2 class="page-header">#{msgs['usuario.agregar.bloque']}</h2>
				</div>
			    </div>
			    <div class="col-lg-12 col-xs-12">
				<p:commandLink title="#{msgs['usuario.agregar.bloque']}" styleClass="btn btn-default" 
					       onclick="mostrarDialogoBloqueUsuario('dialogoBloqueUsuario', 'frmPopCampoUsuario', 'btnCerrar', 'btnGuardar', 'autocompleteUsuario', 'autocompletePuesto', 'cmbBloque');"
					       immediate="true" action="#{usuarioBean.agregarCampoUsuario}">
				    <p:graphicImage url="./resources/imagenes/agregar.png" styleClass="imagenSinBorde" />
				</p:commandLink>
				<p:commandLink  styleClass="linkPequenio" immediate="true"  
                                                onclick="mostrarDialogoBloqueUsuario('dialogoBloqueUsuario', 'frmPopCampoUsuario', 'btnCerrar', 'btnGuardar', 'autocompleteUsuario', 'autocompletePuesto', 'cmbBloque');"
						value="#{msgs['usuario.agregar.bloque']}" title="#{msgs['usuario.agregar.bloque']}" 
                                                action="#{usuarioBean.agregarCampoUsuario}"
                                                />   
			    </div>
			    <div class="col-lg-12 col-xs-12">
				<f:facet name="header"><h:panelGroup><h:outputText value="#{msgs['sistema.filtro']}"/></h:panelGroup></f:facet>
				<p:selectOneRadio value="#{usuarioBean.idCampo}" 
						    valueChangeListener="#{usuarioBean.cambiarSeleccionCampo}"
						     layout="lineDirection" >
				    <f:selectItems value="#{usuarioBean.listaCampoPorUsuario}"/>
				</p:selectOneRadio>
			    </div>
			    <div class="col-lg-12 col-xs-12">
				<p:dataTable size="small" stripedRows="true" showGridlines="true" id="dtCampoUser" rows="20"
					       value="#{usuarioBean.traerCampoUsuario}" 
					       var="data"
					       paginator="true"  
					       paginatorPosition="bottom" 
					       style="width: 80%"  
					       styleClass="table table-striped">

				    <p:column headerText="Nombre">
					<h:outputText value="#{data.usuario}"/>
				    </p:column>
				    <p:column headerText="#{msgs['sia.puesto.nombre']}">
					<h:outputText value="#{data.puesto}"/>
				    </p:column>
				    <p:column headerText="">
					<p:commandLink value="#{msgs['sistema.eliminar']}"  action="#{usuarioBean.eliminarRelacion}"
							 rendered="#{usuarioBean.usuarioVOAlta.idCampo ne data.idCampo}"
							 styleClass="link"  
							 style="color:  blue;"
							 onclick="if (!confirm('La operación va a eliminar el registro, ¿está seguro?  '))
								     return false;"/>
				    </p:column>
				</p:dataTable>
			    </div>
			</h:form>
			<!---->
			<div id="dialogoBloqueUsuario" style="display: none;" 
			     title="#{usuarioBean.accion eq 0 ? msgs['sia.campo.agregar.campo.usuario'] : msgs['sia.campo.actualizar.campo.usuario']}">
			    <h:form id="frmPopCampoUsuario" >
				<h:panelGroup>                           
				    <br/>
				    <p:panelGrid columns="1">
					<c:if test="#{usuarioBean.accion eq 1}">
					    <p:panelGrid columns="2">
						<h:outputText value="Usuario: "/>
						<p:inputText value="#{usuarioBean.campoUsuarioPuestoVo.usuario}" disabled="true" size="55"/>
					    </p:panelGrid>
					</c:if>
					<c:if test="#{usuarioBean.accion eq 0}">
					    <p:panelGrid columns="3">
						<h:outputText value="Usuario" />   
						<p:panelGrid columns="2">
						    <h:inputText id="autocompleteUsuario" size="40"
								   onclick="autocompletarUsuario(this, 'hidenDesUsuario', 'frmPopCampoUsuario');"/>
						    <h:inputHidden id="hidenDesUsuario" value="#{usuarioBean.u}"/>
						</p:panelGrid>  
					    </p:panelGrid>
					</c:if>
					<p:panelGrid columns="2">
					    <h:outputText value="#{msgs['sia.bloque.nombre']} "/>
					    <p:selectOneMenu  value="#{usuarioBean.idCampo}" id="cmbBloque"  rendered="#{usuarioBean.accion eq 0}"
								valueChangeListener="#{usuarioBean.cambiaValorPuesto}" >
						<f:selectItem itemLabel="#{msgs['sistema.seleccione']}" itemValue="-1"/>
						<f:selectItems value="#{usuarioBean.listaCampo}"/>
					    </p:selectOneMenu>
					    <h:outputText value="Gerencia"/>
					    <p:selectOneMenu  value="#{usuarioBean.idGerencia}" id="cmbBloqueGerencia" >
						<f:selectItem itemLabel="#{msgs['sistema.seleccione']}" itemValue="-1"/>
						<f:selectItems value="#{usuarioBean.listaGerenciasItems}"/>
					    </p:selectOneMenu>

					    <p:inputText value="#{usuarioBean.campoUsuarioPuestoVo.campo}" disabled="true" size="55" 
							   rendered="#{usuarioBean.accion eq 1}"/>
					    <h:outputText value="#{msgs['sia.puesto.nombre']}"/>
					    <p:panelGrid columns="2">
						<p:inputText id="autocompletePuesto" size="40" 
							       onclick="autocompletarPuesto(this, 'hidenDesPuesto', 'frmPopCampoUsuario');"/>
						<h:inputHidden id="hidenDesPuesto" value="#{usuarioBean.rhPuestoVo.id}"/>
					    </p:panelGrid>   
					</p:panelGrid>
				    </p:panelGrid>
				    <!--p:panelGrid columns="1" rendered="#{usuarioBean.accion eq 0}"-->
				    <p:panelGrid columns="1" rendered="#{usuarioBean.accion eq 0}" >
					<h:outputText value="Responsable de gerencia: "/>
					<p:selectOneRadio value="#{usuarioBean.c}" >
					    <f:selectItem itemValue="si" itemLabel="Si"/>
					    <f:selectItem itemValue="no" itemLabel="No"/>
					</p:selectOneRadio>
                                        <!--p:panelStack selectedPanel="#{usuarioBean.c}">
					<p:panelStack selectedPanel="#{usuarioBean.c}">
					    <h:panelGroup id="si">
						<p:panelGrid columns="2">
						    <h:outputText value="Gerencias"/>
						    <p:selectOneMenu value="#{usuarioBean.idGerencia}">
							<f:selectItem itemValue="-1" itemLabel="Seleccione . . . "/>
							<f:selectItems value="#{usuarioBean.listaGerencia}"/>
						    </p:selectOneMenu>
						</p:panelGrid>
					    </h:panelGroup>
					    <h:panelGroup id="no"></h:panelGroup>
					</p:panelStack-->                                    
				    </p:panelGrid>
				    <br/>
				    <center>
					<p:panelGrid columns="2" >
					    <p:commandLink id="btnGuardar" value="#{msgs['sistema.aceptar']}" 
							   action="#{usuarioBean.guardarUsuarioCampo}" 
							   styleClass="btn btn-info" style="display: none;"/>
					    <p:commandLink id="btnCerrar" value="#{msgs['sistema.cancelar']}" 
							   action="#{usuarioBean.cancelarUsuarioCampo}" style="display: none;"  />
					</p:panelGrid>
				    </center>
				</h:panelGroup>
			    </h:form>
			</div>
			<div id="dialogOK" style="display: none;" title="#{msgs['sia.mensaje.titulo.operacion.realizada']}">
			    <h:outputText value="#{msgs['sia.mensaje.operacion.realizada']}"
					  styleClass="textoNegrita10" style="color: blue;"/><br/><br/>
			</div>
		    </div>
		</div>

	    </ui:define>

        </ui:composition>

    </body>
</html>
