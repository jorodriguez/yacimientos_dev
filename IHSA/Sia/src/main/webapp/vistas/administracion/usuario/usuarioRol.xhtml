<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      
      xmlns:my="http://www.mytags.com/schema/mytags"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <body>

        <ui:composition template="./../../../WEB-INF/facelets/templates/templateGrupos.xhtml">
            <ui:define name="contenido">
		<div id="Pa">
		    <div class="row"> 
                        <h:form id="frmRolContrato"  		  
				  >
			    <div class="col-lg-12">
				<div class="col-lg-4"></div>
				<div class="col-lg-6">
				    <h2 class="page-header">Administrar roles</h2>
				</div>
			    </div>
			    <div class="col-lg-12 col-xs-12">
				<h:outputText value="Esta opción solo agrega y muestra los roles por módulo con las opciones de agregarlos y quitarlos. "
					      style="color: red; font-weight:  bold; float: right;"/>
			    </div>
			    <div class="col-lg-12 col-xs-12">
                                <!-- tabChangeListener="#{rolBean.limpiarRol}"-->
				<p:tabView >
				    <p:tab title="Roles Modulos"  >
					<p:panelGrid styleClass="bordePanelGrid">
					    <f:facet name="header"><h:panelGroup><h:outputText value="#{msgs['sistema.filtro']}"/></h:panelGroup></f:facet>
					    <p:selectOneRadio value="#{rolBean.idCampo}" 
								valueChangeListener="#{rolBean.cambiarSeleccionCampo}"
								 layout="lineDirection" >
						<f:selectItems value="#{rolBean.listaCampoPorUsuario}"/>
					    </p:selectOneRadio>
					</p:panelGrid>
					<p:panelGrid columns="2">
					    <h:outputLabel value="Módulo"/>
					    <p:selectOneMenu value="#{rolBean.idModulo}" >
						<f:selectItem itemLabel="Seleccione . . . " itemValue="-1"/>
						<f:selectItems value="#{rolBean.listaModulo}"/>
					    </p:selectOneMenu>

					    <h:outputLabel value="Rol"/>
					    <p:selectOneMenu value="#{rolBean.idRol}">
						<f:selectItem itemLabel="Seleccione . . . " itemValue="-1"/>
						<f:selectItems value="#{rolBean.listaRol}"/>
					    </p:selectOneMenu>

					    <h:outputLabel value="Usuario"/>
                                            <!--textChangeListener="#{rolBean.usuarioListener}"-->
                                            <p:autoComplete id="userSelect"
								 value="#{rolBean.nombreUsuario}">
						<f:selectItems value="#{rolBean.listaUsuario}" />
					    </p:autoComplete>
					    <h:outputLabel value="Rol principal"/>
					    <p:selectBooleanCheckbox value="#{rolBean.principal}"/>
					</p:panelGrid>
					<p:panelGrid>
					    <p:commandLink value="Guardar" styleClass="btn btn-primary" 
							     action="#{rolBean.guardarUsuarioRol}"/>
					</p:panelGrid>
					<center><h:messages errorClass="errorMessage" infoClass="infoMessage" styleClass="textoMensajeError"/></center>
					<hr/>
				    </p:tab>
				    <p:tab title="Consulta">
					<p:panelGrid styleClass="bordePanelGrid">
					    <f:facet name="header"><h:panelGroup><h:outputText 
							value="#{msgs['sistema.filtro']}"/></h:panelGroup></f:facet>
					    <p:selectOneRadio value="#{rolBean.idCampo}" 
								valueChangeListener="#{rolBean.cambiarSeleccionCampo}"
								 layout="lineDirection" >
						<f:selectItems value="#{rolBean.listaCampoPorUsuario}"/>
					    </p:selectOneRadio>
					</p:panelGrid>
					<p:panelGrid columns="2">
					    <h:outputLabel value="Módulo"/>
					    <p:selectOneMenu value="#{rolBean.idModulo}" >
						<f:selectItem itemLabel="Seleccione . . . " itemValue="-1"/>
						<f:selectItems value="#{rolBean.listaModulo}"/>
					    </p:selectOneMenu>
					    <h:outputLabel value="Rol"/>
					    <p:selectOneMenu value="#{rolBean.idRol}">
						<f:selectItem itemLabel="Seleccione . . . " itemValue="-1"/>
						<f:selectItems value="#{rolBean.listaRol}"/>
					    </p:selectOneMenu>
					    <h:outputLabel value="Rol principal"/>
					    <p:selectBooleanCheckbox value="#{rolBean.principal}"/>
					    <h:outputText/>
					    <p:commandLink value="Buscar" styleClass="btn btn-primary" action="#{rolBean.buscarRol}"/>
					</p:panelGrid>

					<hr/>
					<center>
					    <p:dataTable size="small" stripedRows="true" showGridlines="true" id="dtRolUser" value="#{rolBean.lista}" var="lr" rows="20"
							   styleClass="table table-bordered table-striped">
						<p:column>
						    <f:facet name="header">
							<h:outputLabel value="Usuario"/>
						    </f:facet>
						    <h:outputText value="#{lr.usuario}"/>
						</p:column>
						<p:column>
						    <p:commandLink value="Eliminar" action="#{rolBean.eliminarUsuarioRol}" 
								     styleClass="link" style="color:  blue;">
							<f:param name="idUsuarioRol" value="#{lr.idUsuarioRol}"/>
						    </p:commandLink>
						</p:column>
					    </p:dataTable>
					    
					</center>
				    </p:tab>
				</p:tabView>
				<p:dialog widgetVar="dialogoAgregado"
					    modal="true"
					    showEffect="header"
					    showHeader="true"
					    closable="true">
				    <p:panelGrid>
					<h:outputLabel value="Se agregó el rol, para consultarlo seleccione la pestaña de consultas." style="color:  blue;"/>
				    </p:panelGrid>
				    <br/>
				</p:dialog>
			    </div>
			</h:form>
		    </div>
		</div>
            </ui:define>
        </ui:composition>

    </body>
</html>
