<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"                
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                >    
    <h:form id="frmEvaProveedor#{contr.id}" rendered="#{not empty sesion.usuarioSesion}" >

        <div class="row form-group ">                                                       
            <h:outputText class="col-lg-1 control-label" value="Proveedor: "/>
            <div class="col-lg-5">
                <h:outputLabel value="#{contr.proveedorVo.nombre}"/>
            </div>                        
            <h:outputText class="col-lg-1 control-label" value="RFC: "/>
            <div class="col-lg-5">
                <h:outputLabel value="#{contr.proveedorVo.rfc}"/>
            </div>                                    
        </div>      

        <div class="card card-primary">
            <div class="card-heading">
                <h1 class="card-title">Evaluaciones</h1>
            </div>
            <div class="card-body">               
                <div class="col-lg-12 col-xs-12">
                    <div class="input-group col-lg-12 col-xs-12">
                        <ui:fragment rendered="#{contratoBean.editarEvals}">
                            <div style="text-align: right;" class="col-lg-12 col-xs-12">                                                     
                                <p:commandLink  action="#{evaluacionBean.nuevaEvaluacion(contr.id)}"                                                               
                                                styleClass="btn btn-primary"
                                                process="@this" update="frmDialogDBEvals">
                                    <i class="fa fa-plus"/>
                                </p:commandLink>   
                            </div>
                        </ui:fragment>
                        <div class="table table-responsive" style="margin-bottom: 0px;">                                    
                            <p:dataTable id="evals#{contr.id}" rows="5" 
                                         value="#{contr.listaConvenioEvals}" var="currentRow" styleClass="table table-striped"
                                         style="font-size:12px; color: black;">                                                                                  
                                <p:column style="width: 40%">
                                    <h:outputText value="#{currentRow.nombreTemplate}"/>
                                    <f:facet name="header">
                                        <h:outputText value="Formato"/>
                                    </f:facet>
                                </p:column>
                                <p:column style="width: 5%">
                                    <h:outputText value="#{currentRow.nombreTipo}"/>
                                    <f:facet name="header">
                                        <h:outputText value="Tipo"/>
                                    </f:facet>
                                </p:column>
                                <p:column style="width: 10%">
                                    <h:outputText value="#{currentRow.nombreGerencia}"/>
                                    <f:facet name="header">
                                        <h:outputText value="Gerencia"/>
                                    </f:facet>
                                </p:column>
                                <p:column style="width: 30%">
                                    <h:outputText value="#{currentRow.nombreUsuario}"/>
                                    <f:facet name="header">
                                        <h:outputText value="Evaluador"/>
                                    </f:facet>
                                </p:column>
                                <p:column style="width: 5%" rendered="#{contratoBean.editarEvals}">
                                    <p:commandLink 
                                        styleClass="btn btn-info btn-sm"          
                                        action="#{evaluacionBean.editarEvaluacion(actionEvent)}"
                                        title="Click aquí para editar la evaluación..." >
                                        <i class="fa fa-pencil"></i>
                                        <f:param name="idContrato" value="#{contr.id}"/>
                                        <f:param name="idContratoEva" value="#{currentRow.id}"/>
                                    </p:commandLink>                                                        
                                </p:column>
                                <p:column style="width: 5%" rendered="#{contratoBean.editarEvals}">
                                    <p:commandLink 
                                        styleClass="btn btn-info btn-sm"          
                                        action="#{evaluacionBean.borrarEvaluacion(actionEvent)}"                                                            
                                        onclick="if (!confirm('La operación eliminará la evalucación seleccionada. ¿Está seguro?'))
                                                    return false;"
                                        title="Click aquí para borrar la evaluación..." >
                                        <i class="fa fa-remove"></i>
                                        <f:param name="idContrato" value="#{contr.id}"/>
                                        <f:param name="idContratoEva" value="#{currentRow.id}"/>
                                    </p:commandLink>                                                        
                                </p:column>
                                <p:column style="width: 5%" rendered="#{contratoBean.editarEvals}">
                                    <p:commandLink 
                                        styleClass="btn btn-info btn-sm"          
                                        action="#{evaluacionBean.soliciatarEvaluacion(contr.id, currentRow.id)}"
                                        title="Click aquí para solicitar la evaluación..." 
                                        process="@this" update="@form">
                                        <i class="fa fa-list-alt"></i>
                                    </p:commandLink>                                                        
                                </p:column>
                            </p:dataTable>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card card-primary">
            <div class="card-heading">
                <h1 class="card-title">Evaluaciones solicitadas</h1>
            </div>
            <div class="card-body">               
                <p:dataTable id="evalsPens#{contr.id}" rows="5" 
                             value="#{contr.listaEvalsPendientes}" var="currentRow" styleClass="table table-striped"
                             style="font-size:12px; color: black;">                                                                                  
                    <p:column style="width: 45%">
                        <h:outputText value="#{currentRow.templateNombre}"/>
                        <f:facet name="header">
                            <h:outputText value="Formato"/>
                        </f:facet>
                    </p:column>
                    <p:column style="width: 10%">
                        <h:outputText value="#{currentRow.nombreClasificacion}"/>
                        <f:facet name="header">
                            <h:outputText value="Tipo"/>
                        </f:facet>
                    </p:column>
                    <p:column style="width: 15%">
                        <h:outputText value="#{currentRow.nombreGerencia}"/>
                        <f:facet name="header">
                            <h:outputText value="Gerencia"/>
                        </f:facet>
                    </p:column>
                    <p:column style="width: 20%">
                        <h:outputText value="#{currentRow.nombreResponsable}"/>
                        <f:facet name="header">
                            <h:outputText value="Evaluador"/>
                        </f:facet>
                    </p:column>
                    <p:column style="width: 10%">                                                                                        
                        <h:outputText value="#{currentRow.fechaSolicitada}">
                            <f:convertDateTime dateStyle="default" type="date"/>
                        </h:outputText>
                        <f:facet name="header">
                            <h:outputText value="Fecha Sol."/>
                        </f:facet>
                    </p:column>
                </p:dataTable>

            </div>
        </div>
    </h:form>
</ui:composition>