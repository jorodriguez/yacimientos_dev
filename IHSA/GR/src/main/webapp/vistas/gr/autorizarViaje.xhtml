<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      >    
    <h:body>
        <ui:composition template="/vistas/template/template.xhtml">            
            <ui:define name="content">                 
                <style >
                    .row{
                        margin-top:40px;
                        padding: 0 10px;
                    }

                    .clickable{
                        cursor: pointer;   
                    }

                    .card-header span {
                        margin-top: -20px;
                        font-size: 15px;
                    }                    
                </style>
                <div class="container">
                    <div class="row">
                        <h:form id="frmAutVia">
                            <div class="card card-primary">
                                <div class="card-header">
                                    <h3 class="card-title">Viajes en espera de autorización</h3>
                                    <span class="pull-right clickable"><i class="fa fa-chevron-up"  id="ivpaAV"></i></span>
                                    <input type="hidden" class="hiddenID" value="vpaAV"></input>
                                </div>
                                <div class="card-body"  id="pbvpaAV">
                                    <c:forEach items="#{sesion.rutasPausaGerente}" var="ruta">
                                        <div class="col-lg-12">
                                            <div class="card card-primary">
                                                <div class="card-header">
                                                    <h3 class="card-title">Ruta: #{ruta.nombre}  (Tiempo:#{ruta.tiempoViaje} hrs.)  (Viajes:#{ruta.viajes.size()})</h3>
                                                    <span class="pull-right clickable"><i class="fa fa-chevron-up"  id="ivpaRAV#{ruta.id}"></i></span>
                                                    <input type="hidden" class="hiddenID" value="vpaR#{ruta.id}"></input>
                                                </div>
                                                <div class="card-body" id="pbvpaRAV#{ruta.id}">                                                                    
                                                    <c:forEach items="#{ruta.viajes}" var="viaje">
                                                        <div class="card card-default">
                                                            <div class="card-header">
                                                                <h3 class="card-title">                                                                                                                                                                        
                                                                    <strong>#{viaje.codigo} (#{viaje.responsable} / #{viaje.responsableTel}) (#{viaje.vehiculo}/#{viaje.vehiculoPlaca}) (Salida: #{viaje.horaSalidaTxt})</strong>
                                                                </h3>
                                                                <span class="pull-right clickable"><i class="fa fa-chevron-up"  id="ivpaRVAV#{viaje.id}"></i></span>
                                                                <input type="hidden" class="hiddenID" value="vpaRV#{viaje.id}"></input>
                                                            </div>
                                                            <div class="card-body" id="pbvpaRVAV#{viaje.id}">                                                                 
                                                                <div class="col-lg-12" style="margin-bottom: 15px;">
                                                                    <p:dataTable rows="10" 
                                                                                   value="#{viaje.listaViajeros}" var="viajero" styleClass="table table-striped"
                                                                                   style="font-size:12px; color: black;">                                                                                           
                                                                        <p:column>
                                                                            <h:outputText value="#{viajero.idInvitado eq 0 ? viajero.usuario : viajero.invitado}"/>
                                                                            <f:facet name="header">
                                                                                <h:outputText value="Viajero"/>
                                                                            </f:facet>
                                                                        </p:column>
                                                                        <p:column>
                                                                            <h:outputText value="#{viajero.telefono}"/>
                                                                            <f:facet name="header">
                                                                                <h:outputText value="Telefono"/>
                                                                            </f:facet>
                                                                        </p:column>
                                                                        <p:column>
                                                                            <h:outputText value="#{viajero.gerenciaResponsable}"/>
                                                                            <f:facet name="header">
                                                                                <h:outputText value="Gerencia"/>
                                                                            </f:facet>
                                                                        </p:column>
                                                                        <p:column>
                                                                            <h:outputText value="#{viajero.responsableDeGerencia}"/>
                                                                            <f:facet name="header">
                                                                                <h:outputText value="Gerente"/>
                                                                            </f:facet>
                                                                        </p:column>                                                                        
                                                                    </p:dataTable>                                                                                                                                  
                                                                </div>

                                                                <div class="col-lg-12 card card-info card-header" style="margin-bottom: 15px;">
                                                                    <div class="card-header">
                                                                        <h3 class="card-title">                                                                                                                                                                        
                                                                            <strong>Comentarios</strong>
                                                                        </h3>
                                                                        <span class="pull-right clickable"><i class="fa fa-chevron-up"  id="ivpaRVC#{viaje.id}"></i></span>
                                                                        <input type="hidden" class="hiddenID" value="vpaRVC#{viaje.id}"></input>
                                                                    </div>
                                                                    <div class="card-body" id="pbvpaRVCAV#{viaje.id}"> 
                                                                        <div class="col-lg-12" style="margin-bottom: 15px;">                                                                                                        
                                                                            <div class="col-lg-9"></div>                                                                                    
                                                                            <p:commandLink 
                                                                                value="Agregar Comentario"
                                                                                styleClass="col-lg-3 btn btn-info btn-sm"                                                                                                             
                                                                                action="#{sesion.goAddComentario(viaje.id)}"
                                                                                title="Click aquí para agregar un comentario..." 
                                                                                process="@this" update="frmPnlAddCom">
                                                                            </p:commandLink>
                                                                        </div>
                                                                        <c:forEach items="#{viaje.noticia.listaComentario}" var="comentario">
                                                                            <div class="col-lg-12 input-group card card-default" style="border: white; border-style: none; border-width: 1px; margin-bottom: 0px;">
                                                                                <div class="form-group col-lg-12 col-xs-12" style="border: white; border-bottom: #eee; border-top: white;  border-style: solid; border-width: 2px;">                                                            
                                                                                    <div class="row" style="margin-top: 5px;">
                                                                                        <h:outputLabel styleClass="control-label" value="#{comentario.usuarioNombre}"/>
                                                                                        <h:outputText styleClass="control-label" value=" - "/>  
                                                                                        <h:outputText styleClass="control-label" value="#{comentario.fechaGenero}">
                                                                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                                                        </h:outputText>
                                                                                        <h:outputText styleClass="control-label" value=" - "/>  
                                                                                        <h:outputText styleClass="control-label" value="#{comentario.horaGenero}">
                                                                                            <f:convertDateTime pattern="h:mm a" timeStyle="default" type="time"/>
                                                                                        </h:outputText>
                                                                                    </div>
                                                                                    <div class="row" style="margin-top: 5px;">
                                                                                        <strong><h:outputText styleClass="control-label" value="Comentario: "/></strong>
                                                                                        <h:outputText styleClass="control-label" value="#{comentario.mensaje}"/>
                                                                                    </div>                                                                                                                                                                        
                                                                                </div>    
                                                                            </div>                                            
                                                                        </c:forEach>    
                                                                    </div>                                       
                                                                </div>

                                                            </div>

                                                        </div>
                                                    </c:forEach>
                                                </div>
                                            </div>
                                        </div>

                                    </c:forEach>      
                                </div>
                            </div>
                        </h:form>
                    </div>
                </div>                

                <script>
                    $(document).ready(function () {                        
                        startDate();
                    });
                </script>

            </ui:define>            
        </ui:composition>
    </h:body>
</html>