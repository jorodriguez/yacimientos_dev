<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <div class="modal fade" id="dialogoPopUpCrearViaje" data-backdrop="static" data-keyboard="false" style="color: black;">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">                    
                    <h4 class="modal-title">Crear Viaje Emergente</h4>
                </div>

                <h:form id="frmPnlViajeEmer" styleClass="textoIzquierda">
                    <div class="modal-body">             
                        <div style="margin-top: 10px;" class="col-12">
                            <h:message  for="" style="display: block;" infoClass="alert alert-success" warnClass="alert alert-warning"
                                        errorClass="alert alert-danger" fatalClass="alert alert-danger"  />
                        </div>                                                                                              
                        <div class="col-12">                                                        
                            <strong><h:outputText class="col-12 control-label" value="1. Fecha de salida"/></strong>
                            <div class="row" style="margin-top: 5px;">                                                                                                                    
                                <h:outputText class="col-2 control-label" value="Fecha Salida: "/>
                                <div class="col-3">                                            
                                    <p:datePicker  pattern="dd/MM/yyyy" 
                                                   value="#{grViaje.fechaProgramada}"
                                                   required="true" requiredMessage="Es necesario seleccionar una fecha. "/>
                                </div>
                                <h:outputText class="col-2 control-label" value="Hora Salida: "/>
                                <div class="col-2">                                            
                                    <p:selectOneMenu id="horaSalida" 
                                                     value="#{grViaje.horaSalida}"
                                                     styleClass="form-control"
                                                     >
                                        <f:selectItems value="#{grViaje.listaHoras}" />
                                    </p:selectOneMenu>
                                </div>
                                <div class="col-2">
                                    <p:selectOneMenu id="minutoSalida" 
                                                     styleClass="form-control"
                                                     value="#{grViaje.minutoSalida}"
                                                     >
                                        <f:selectItems value="#{grViaje.listaMinutos}" />
                                    </p:selectOneMenu>                                    
                                </div>
                                <h:outputText class="col-1 control-label" value="mins."/>
                            </div>
                            <strong><h:outputText class="col-12 control-label" value="2. Datos del vehículo"/></strong>
                            <div class="row" style="margin-top: 5px;">
                                <div class="col-1"></div>
                                <h:outputText value="Oficina:" class="col-2 control-label" style="text-align: right;"/>
                                <div class="col-6">                                            
                                    <p:selectOneMenu  id="selectOneMenuOficinaVehiculos" value="#{grViaje.idOficinaVehiculo}"   
                                                      >
                                        <f:selectItem itemLabel="Seleccionar..." itemValue="-1"/>
                                        <f:selectItems value="#{grViaje.listaOficinaVehiculo}"/>
                                        <p:ajax listener="#{grViaje.traerListaVehiculo}" update="frmPnlViajeEmer:selectOneMenuVehiculo"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="col-3"></div>
                            </div>
                            <div class="row" style="margin-top: 5px;">
                                <div class="col-1"></div>
                                <h:outputText value="Vehículo:" class="col-2 control-label" style="text-align: right;"/>
                                <div class="col-6">
                                    <p:selectOneMenu value="#{grViaje.idVehiculo}"
                                                     id="selectOneMenuVehiculo">
                                        <f:selectItem itemLabel="Seleccionar Vehículo" 
                                                      itemValue="-1"/>
                                        <f:selectItems value="#{grViaje.listaVehiculos}"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="col-3"></div>
                            </div>
                            <strong><h:outputText class="col-12 control-label" value="3. Responsable del viaje"/></strong>

                            <div class="row" style="margin-top: 5px;">                                                        
                                <div class="col-1"></div>
                                <h:outputText value="Empleado: " class="col-2 control-label" style="text-align: right;"/>
                                <div class="col-6">
                                    <p:autoComplete id="userSelect"                                                                 
                                                    value="#{grViaje.responsable}"
                                                    multiple="false" selectLimit="1"
                                                    scrollHeight="250" size="35" forceSelection="true"
                                                    completeMethod="#{grViaje.usuarioListener}"
                                                    >                                        
                                    </p:autoComplete>

                                </div>
                                <div class="col-3"></div>
                            </div>
                            <!-- h:outputText id="nombreUsuario"  style="padding-left: 15%; color: maroon; font-weight: bold; font-size: 14px;"/ -->
                            <strong><h:outputText class="col-12 control-label" value="4. Ruta"/></strong>
                            <div class="row" style="margin-top: 5px;">
                                <div class="col-1"></div>
                                <h:outputText value="Oficina:" class="col-2 control-label" style="text-align: right;"/>
                                <div class="col-6">                                            
                                    <p:selectOneMenu  id="selectOneMenuOficinaRuta" value="#{grViaje.idOficinaRuta}">
                                        <f:selectItem itemLabel="Seleccione..." itemValue="-1"/>
                                        <f:selectItems value="#{grViaje.listaOficinaRuta}"/>
                                        <p:ajax listener="#{grViaje.traerListaRutas}"  update="frmPnlViajeEmer:rutaViaje"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="col-3"></div>
                            </div>
                            <div class="row"  style="margin-top: 5px;">
                                <div class="col-3"></div>
                                <div class="col-6">                                                        
                                    <p:selectOneRadio value="#{grViaje.idSiOperacion}">
                                        <f:selectItem itemLabel="Oficina" itemValue="21"/>
                                        <f:selectItem itemLabel="Ciudad" itemValue="22"/>
                                        <p:ajax listener="#{grViaje.cabiarDestino}"  update="frmPnlViajeEmer:rutaViaje"/>
                                    </p:selectOneRadio>
                                </div>
                                <div class="col-3"></div>
                            </div>
                            <div class="row" style="margin-top: 5px;">
                                <div class="col-3"></div>
                                <div class="col-6">                                                        
                                    <p:selectOneMenu value="#{grViaje.idRuta}" id="rutaViaje"  
                                                     styleClass="form-control">
                                        <f:selectItem itemLabel="Seleccionar Ruta" 
                                                      itemValue="-1"/>
                                        <f:selectItems value="#{grViaje.listaRuta}"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="col-3"></div>
                            </div>
                            <strong><h:outputText class="col-12control-label" value="5. Autorizo viaje emergente"/></strong>
                            <div id="busquedaAutorizo" class="row" style="margin-top: 5px;">
                                <div class="col-1"></div>
                                <h:outputText value="Autorizo: " class="col-2 control-label" style="text-align: right;"/>
                                <div class="col-6">
                                    <p:autoComplete id="userSelectAutorizo"                                                                 
                                                    value="#{grViaje.autorizo}"      
                                                    multiple="false" selectLimit="1"
                                                    scrollHeight="250" size="35" forceSelection="true"
                                                    completeMethod="#{grViaje.usuarioListener}">
                                    </p:autoComplete>


                                </div>
                                <div class="col-1"></div>                                
                            </div>
                            <strong><h:outputText class="col-12 control-label" value="6. Viajeros"/></strong>
                            <div  class="row" style="margin-top: 5px;">
                                <p:tabView>
                                    <p:tab title="Empleados">
                                        <p:autoComplete id="userSelectEmpleado"                                                                 
                                                        value="#{grViaje.empleado}"                                                                                              
                                                        multiple="false" selectLimit="1"
                                                        scrollHeight="250" size="35" forceSelection="true"
                                                        completeMethod="#{grViaje.usuarioListener}">
                                            <p:ajax listener="#{grViaje.agregarEmpleado()}" update="@this frmPnlViajeEmer:viajerosLST"/>
                                        </p:autoComplete>
                                    </p:tab>
                                    <p:tab title="Invitados">
                                        <p:autoComplete id="userSelectInvitado"                                                                 
                                                        value="#{grViaje.invitado}"                                                                                 
                                                        multiple="false" selectLimit="1"
                                                        scrollHeight="250" size="35" forceSelection="true"
                                                        completeMethod="#{grViaje.invitadoListener}"                                                                                            
                                                        >
                                            <p:ajax listener="#{grViaje.agregarInvitado()}" update="@this frmPnlViajeEmer:viajerosLST"/>                                                        
                                        </p:autoComplete>
                                    </p:tab>
                                </p:tabView>
                            </div>
                            <div class="col-12">
                                <p:dataTable id="viajerosLST" rows="10" 
                                             value="#{grViaje.listaViajeros}" var="currentRow" 
                                             size="small" showGridlines="true" paginator="true"> 
                                    <p:column>
                                        <h:outputText value="#{currentRow.esEmpleado ? currentRow.usuario : currentRow.invitado}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Nombre"/>
                                        </f:facet>
                                    </p:column>                                            
                                    <p:column width="50">
                                        <p:commandLink 
                                            action="#{grViaje.eliminarViajero(currentRow)}"
                                            title="Click aquí para eliminar el viajero..." 
                                            process="@this" update="frmPnlViajeEmer:viajerosLST">
                                            <i class="fa fa-trash text-danger"></i>
                                        </p:commandLink>                                                        
                                    </p:column>
                                </p:dataTable>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="border-top: white;">
                        <p:commandButton id="saveSemaforo"
                                         value="Aceptar"
                                         styleClass="btn btn-info" 
                                         action="#{grViaje.completarCrearViajeEmergencia(event)}"                                         
                                         process="@form" update="@(frmViajesPen)"/>
                        <p:commandButton 
                            value="Cancelar" immediate="true"
                            styleClass="btn btn-default"
                            style="margin-left: 5px;"
                            onclick="$(dialogoPopUpCrearViaje).modal('hide');"
                            title="Cerrar ventana..." 
                            />
                    </div>                            
                </h:form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="dialogoPopUpCrearViajeExito" data-backdrop="static" data-keyboard="false" style="color: black;">
        <div class="modal-dialog" style="max-width: 80%;">
            <div class="modal-content">
                <div class="modal-header">                    
                    <h4 class="modal-title">Crear Viaje Emergente</h4>
                </div>

                <div class="modal-body">                                                                                                        
                    <div class="col-12 xs:col-12 alert alert-success">                                                        
                        <strong><h:outputText class="col-12 xs:col-12 control-label " value="#{grViaje.msgExitoCrearViaje}"/></strong>                            
                    </div>
                </div>
                <div class="modal-footer" style="border-top: white;">
                    <p:commandButton
                        value="Cerrar"
                        styleClass="btn btn-default"
                        onclick="$(dialogoPopUpCrearViajeExito).modal('hide');"
                        title="Cerrar ventana..." 
                        />
                </div>                                           
            </div>
        </div>
    </div>

    <div class="modal fade" id="dialogoPopUpRutasSectores" data-backdrop="static" data-keyboard="false" style="color: black;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">                    
                    <h4 class="modal-title">Detalle de la ruta</h4>
                </div>

                <div class="modal-body">
                    <h:form id="frmRutaDet">
                        <c:forEach items="#{grViaje.zonas}" var="zona">
                            <div class="input-group" style="border: white; border-bottom: #eee; border-top: white;  border-style: solid; border-width: 2px;">
                                <div class="col-11" style="margin-top: 5px;">
                                    <strong><h:outputText styleClass="col-11 control-label" value="#{zona.zona.nombre}" title="#{zona.zona.descripcion}" /></strong>                                     
                                </div>    
                                <div class="col-1" style="max-height: 20px; max-width: 20px; border-radius: 50%; background-color: #{zona.zona.colorSemaforo};"></div>
                            </div>
                        </c:forEach>
                    </h:form>
                </div>
                <div class="modal-footer" style="border-top: white;">
                    <p:commandButton immediate="true"
                                     value="Cerrar"
                                     styleClass="btn btn-default"
                                     onclick="$(dialogoPopUpRutasSectores).modal('hide');"
                                     title="Cerrar ventana..." 
                                     />
                </div>                                           
            </div>
        </div>
    </div>

</ui:composition>